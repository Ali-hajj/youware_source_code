import{r as T,a as Gi,g as Hi,R as kr}from"./vendor-CIP6LD3P.js";import{c as Ga,f as me,s as Na,e as _a,a as Ji,i as Wi,p as Yi,b as Ki,d as Qi,g as Xi,h as el,j as tl,k as sl,l as Pt,m as al}from"./utils-nvT9gLnq.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();var yn={exports:{}},Xs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rl=T,nl=Symbol.for("react.element"),ol=Symbol.for("react.fragment"),il=Object.prototype.hasOwnProperty,ll=rl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cl={key:!0,ref:!0,__self:!0,__source:!0};function bn(e,t,a){var r,n={},o=null,l=null;a!==void 0&&(o=""+a),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)il.call(t,r)&&!cl.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:nl,type:e,key:o,ref:l,props:n,_owner:ll.current}}Xs.Fragment=ol;Xs.jsx=bn;Xs.jsxs=bn;yn.exports=Xs;var s=yn.exports,vn,Sr=Gi;vn=Sr.createRoot,Sr.hydrateRoot;/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ul=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,r)=>r?r.toUpperCase():a.toLowerCase()),Cr=e=>{const t=ul(e);return t.charAt(0).toUpperCase()+t.slice(1)},jn=(...e)=>e.filter((t,a,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===a).join(" ").trim(),ml=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pl={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:n="",children:o,iconNode:l,...c},d)=>T.createElement("svg",{ref:d,...pl,width:t,height:t,stroke:e,strokeWidth:r?Number(a)*24/Number(t):a,className:jn("lucide",n),...!o&&!ml(c)&&{"aria-hidden":"true"},...c},[...l.map(([i,u])=>T.createElement(i,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=(e,t)=>{const a=T.forwardRef(({className:r,...n},o)=>T.createElement(hl,{ref:o,iconNode:t,className:jn(`lucide-${dl(Cr(e))}`,`lucide-${e}`,r),...n}));return a.displayName=Cr(e),a};/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ha=X("archive",fl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],Tr=X("building",gl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],ka=X("calculator",xl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],gt=X("calendar",yl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Sa=X("chart-column",bl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],jl=X("chart-pie",vl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Nl=X("check",wl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],kl=X("chevron-down",_l);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Cl=X("chevron-left",Sl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],wn=X("chevron-right",Tl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Nn=X("circle-alert",El);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_n=X("circle-check-big",Il);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Al=X("circle-check",$l);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],kn=X("circle-x",Pl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Rl=X("clock",Dl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ca=X("copy",Ml);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ja=X("dollar-sign",Ol);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Lt=X("download",Ll);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ta=X("external-link",Fl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ul=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Vl=X("file-spreadsheet",Ul);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bl=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ft=X("file-text",Bl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ql=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Is=X("funnel",ql);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],zl=X("globe",Zl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],Er=X("key-round",Gl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ea=X("mail",Hl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jl=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ir=X("minus",Jl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Sn=X("palette",Wl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yl=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Je=X("plus",Yl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Cn=X("printer",Kl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],da=X("refresh-ccw",Ql);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ec=X("rotate-ccw",Xl);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]],$r=X("rss",tc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Tn=X("save",sc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],rc=X("search",ac);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],oc=X("settings",nc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],lc=X("share-2",ic);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cc=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Ar=X("shield",cc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Pr=X("square-check-big",dc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uc=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ts=X("square-pen",uc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Dr=X("square",mc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],jt=X("trash-2",pc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],fc=X("trending-down",hc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],xc=X("trending-up",gc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Wa=X("upload",yc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],vc=X("user-plus",bc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ns=X("users",jc);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ut=X("x",wc),Nc="modulepreload",_c=function(e){return"/"+e},Rr={},kc=function(t,a,r){let n=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=Promise.allSettled(a.map(d=>{if(d=_c(d),d in Rr)return;Rr[d]=!0;const i=d.endsWith(".css"),u=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const m=document.createElement("link");if(m.rel=i?"stylesheet":Nc,i||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),i)return new Promise((w,j)=>{m.addEventListener("load",w),m.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return n.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})},Sc={};var Cc={};const as={production:{baseURL:"https://stuntec.org/Events/api"},staging:{baseURL:"https://staging.stuntec.org/api"},development:{baseURL:"http://localhost:8000/api"},local:{baseURL:"http://localhost:8000/api"}},je={users:"users",events:"events",userById:e=>`users/${e}`,authLogin:"auth/login",authLogout:"auth/logout",authSignup:"auth/signup",authMe:"auth/me",authResetPassword:"auth/reset-password"};function Dt(){return!1}let En=()=>null;function Tc(e){En=e}function Ec(){return En()}const Ic="production",$c=()=>{const e=as[Ic];return e==null?void 0:e.baseURL};async function ke(e,t={}){const a=$c(),r=a.endsWith("/")?`${a}${e}`:`${a}/${e}`,n=Ec(),o=new Headers(t.headers);n&&o.set("Authorization",`Bearer ${n}`);const l={...t,headers:o},c=await fetch(r,l);if(c.status===401||c.status===403){const{useAuthStore:d}=await kc(async()=>{const{useAuthStore:u}=await Promise.resolve().then(()=>Fc);return{useAuthStore:u}},void 0),i=d.getState();i.token&&i.token!=="offline-bypass-token"&&(console.warn("Token expired or unauthorized, logging out..."),await i.logout(),window.location.reload())}return c}const Ac={};function Pc(e,t){let a;try{a=e()}catch{return}return{getItem:n=>{var o;const l=d=>d===null?null:JSON.parse(d,void 0),c=(o=a.getItem(n))!=null?o:null;return c instanceof Promise?c.then(l):l(c)},setItem:(n,o)=>a.setItem(n,JSON.stringify(o,void 0)),removeItem:n=>a.removeItem(n)}}const os=e=>t=>{try{const a=e(t);return a instanceof Promise?a:{then(r){return os(r)(a)},catch(r){return this}}}catch(a){return{then(r){return this},catch(r){return os(r)(a)}}}},Dc=(e,t)=>(a,r,n)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...t},l=!1;const c=new Set,d=new Set;let i;try{i=o.getStorage()}catch{}if(!i)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),a(...g)},r,n);const u=os(o.serialize),m=()=>{const g=o.partialize({...r()});let y;const b=u({state:g,version:o.version}).then(E=>i.setItem(o.name,E)).catch(E=>{y=E});if(y)throw y;return b},w=n.setState;n.setState=(g,y)=>{w(g,y),m()};const j=e((...g)=>{a(...g),m()},r,n);let x;const f=()=>{var g;if(!i)return;l=!1,c.forEach(b=>b(r()));const y=((g=o.onRehydrateStorage)==null?void 0:g.call(o,r()))||void 0;return os(i.getItem.bind(i))(o.name).then(b=>{if(b)return o.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==o.version){if(o.migrate)return o.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var E;return x=o.merge(b,(E=r())!=null?E:j),a(x,!0),m()}).then(()=>{y==null||y(x,void 0),l=!0,d.forEach(b=>b(x))}).catch(b=>{y==null||y(void 0,b)})};return n.persist={setOptions:g=>{o={...o,...g},g.getStorage&&(i=g.getStorage())},clearStorage:()=>{i==null||i.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>f(),hasHydrated:()=>l,onHydrate:g=>(c.add(g),()=>{c.delete(g)}),onFinishHydration:g=>(d.add(g),()=>{d.delete(g)})},f(),x||j},Rc=(e,t)=>(a,r,n)=>{let o={storage:Pc(()=>localStorage),partialize:f=>f,version:0,merge:(f,g)=>({...g,...f}),...t},l=!1;const c=new Set,d=new Set;let i=o.storage;if(!i)return e((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),a(...f)},r,n);const u=()=>{const f=o.partialize({...r()});return i.setItem(o.name,{state:f,version:o.version})},m=n.setState;n.setState=(f,g)=>{m(f,g),u()};const w=e((...f)=>{a(...f),u()},r,n);n.getInitialState=()=>w;let j;const x=()=>{var f,g;if(!i)return;l=!1,c.forEach(b=>{var E;return b((E=r())!=null?E:w)});const y=((g=o.onRehydrateStorage)==null?void 0:g.call(o,(f=r())!=null?f:w))||void 0;return os(i.getItem.bind(i))(o.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==o.version){if(o.migrate)return[!0,o.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var E;const[N,O]=b;if(j=o.merge(O,(E=r())!=null?E:w),a(j,!0),N)return u()}).then(()=>{y==null||y(j,void 0),j=r(),l=!0,d.forEach(b=>b(j))}).catch(b=>{y==null||y(void 0,b)})};return n.persist={setOptions:f=>{o={...o,...f},f.storage&&(i=f.storage)},clearStorage:()=>{i==null||i.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>x(),hasHydrated:()=>l,onHydrate:f=>(c.add(f),()=>{c.delete(f)}),onFinishHydration:f=>(d.add(f),()=>{d.delete(f)})},o.skipHydration||x(),j||w},Mc=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Ac?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Dc(e,t)):Rc(e,t),Oc=Mc,Lc="eventManager_auth",ua=async(e,t)=>ke(e,t),Mr=(e="admin")=>({id:`offline-${Date.now()}`,username:e,role:"admin",firstName:"Offline",lastName:"Access",phone:"313-938-6666",email:"support@stuntec.com",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),isDefaultAdmin:!0}),Cs="offline-bypass-token",We=Ga()(Oc((e,t)=>({user:null,token:null,expiresAt:null,isLoading:!1,error:null,async login({username:a,password:r}){const n=o=>{const l=Mr(o||a||"admin"),c=Date.now()+2*60*60*1e3;return e({user:l,token:Cs,expiresAt:c,isLoading:!1,error:null}),l};e({isLoading:!0,error:null});try{const o=await ua(je.authLogin,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:r})});if(!o.ok){const m=await o.json().catch(()=>({error:"Login failed"}));throw new Error(m.error||"Login failed")}const l=await o.json(),{token:c,expiresAt:d,user:i}=l,u={...i,firstName:i.first_name||i.firstName,lastName:i.last_name||i.lastName};e({user:u,token:c,expiresAt:d,isLoading:!1,error:null})}catch(o){const l=o instanceof TypeError||o instanceof Error&&/fetch/i.test(o.message),c=o instanceof Error?o:new Error("Login failed");if(l||c.message.includes("Failed to fetch")){const d=n(a);console.warn("Login fell back to offline mode for user:",d.username);return}if(a==="admin"&&r==="admin"){n("admin");return}throw e({isLoading:!1,error:c.message}),c}},forceLogin(a){const r=Mr(a==null?void 0:a.username),n=Date.now()+2*60*60*1e3;e({user:r,token:Cs,expiresAt:n,isLoading:!1,error:null})},async logout(){try{await ua(je.authLogout,{method:"POST"})}catch(a){console.warn("Failed to logout from backend:",a)}e({user:null,token:null,expiresAt:null,error:null})},clearError(){e({error:null})},async refreshProfile(){if(t().token)try{const r=await ua(je.authMe);if(!r.ok)throw new Error("Failed to fetch profile");const n=await r.json(),o={...n.user,firstName:n.user.first_name||n.user.firstName,lastName:n.user.last_name||n.user.lastName};e({user:o,error:null})}catch(r){console.warn("Failed to refresh profile:",r),await t().logout()}},checkTokenExpiration(){const{expiresAt:a,token:r}=t();return!r||!a?!1:Date.now()>=a&&r!==Cs?(console.warn("Token has expired, logging out..."),t().logout(),!0):!1},isTokenExpired(){const{expiresAt:a,token:r}=t();return!r||!a?!0:Date.now()>=a}}),{name:Lc,partialize:e=>({user:e.user,token:e.token,expiresAt:e.expiresAt}),onRehydrateStorage:()=>e=>{e&&(e.token&&e.expiresAt&&e.expiresAt>Date.now()?We.getState().refreshProfile().catch(()=>{We.getState().logout()}):e.token&&e.token!==Cs&&(console.warn("Stored token is expired, logging out..."),We.getState().logout()))}}));Tc(()=>We.getState().token);const Fc=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:We},Symbol.toStringTag,{value:"Module"})),Uc=[{id:"restaurant",name:"Restaurant",type:"restaurant",color:"#10b981",icon:"🍽️"},{id:"bar",name:"Bar",type:"bar",color:"#f59e0b",icon:"🍺"},{id:"banquet",name:"Banquet Hall",type:"banquet",color:"#6366f1",icon:"🎉"}],Or={storeName:"My Restaurant",storeEmail:"Mikeakanan@gmail.com",storePhone:"313.938.6666",storeAddress:"0000 Street Name, Farmington Hills Mi 48336",applicationTitle:"Event Manager",applicationSubtitle:"Professional Hospitality Event Management",logo:"/assets/default-logo.png",themeColor:"#f59e0b",backgroundColor:"#0f172a",textColor:"#ffffff",highlightTextColor:"#f59e0b",dbHost:"",dbUser:"",dbPassword:"",dbName:""},Vc=[{id:"1",name:"Red",color:"#ef4444"},{id:"2",name:"Orange",color:"#f97316"},{id:"3",name:"Amber",color:"#f59e0b"},{id:"4",name:"Yellow",color:"#eab308"},{id:"5",name:"Lime",color:"#84cc16"},{id:"6",name:"Green",color:"#22c55e"},{id:"7",name:"Emerald",color:"#10b981"},{id:"8",name:"Teal",color:"#14b8a6"},{id:"9",name:"Cyan",color:"#06b6d4"},{id:"10",name:"Sky",color:"#0ea5e9"},{id:"11",name:"Blue",color:"#3b82f6"},{id:"12",name:"Indigo",color:"#6366f1"},{id:"13",name:"Violet",color:"#8b5cf6"},{id:"14",name:"Purple",color:"#a855f7"},{id:"15",name:"Fuchsia",color:"#d946ef"},{id:"16",name:"Pink",color:"#ec4899"},{id:"17",name:"Rose",color:"#f43f5e"},{id:"18",name:"White",color:"#ffffff"},{id:"19",name:"Black",color:"#000000"},{id:"20",name:"Dark Navy",color:"#1e3a8a"}],Ae=Ga((e,t)=>({events:[],filters:{},selectedEvent:null,isEventDialogOpen:!1,venues:Uc,settings:Or,colorPresets:Vc,addMultipleEvents:async a=>{const r=je.eventsBulk;if(Dt()){const l=Date.now(),c=a.map((d,i)=>({...d,id:`event-${l}-${i}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}));console.log("🖼️ Screenshot environment detected - using in-memory events only."),e(d=>({events:[...d.events,...c]}));return}const n=await ke(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:a})});if(!n.ok){const l=await n.text().catch(()=>"Could not read error response");throw new Error(`Failed to import events: ${l}`)}const o=await n.json();e({events:o.events??[]})},addEvent:async a=>{var c,d,i;const r=je.events;if(Dt()){const u={...a,id:`event-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};console.log("🖼️ Screenshot environment detected - skipping network request."),e(m=>({events:[...m.events,u]}));return}const n={...a,start_time:a.startTime,end_time:a.endTime,contact_name:((c=a.contact)==null?void 0:c.name)||"",contact_phone:((d=a.contact)==null?void 0:d.phone)||"",contact_email:((i=a.contact)==null?void 0:i.email)||"",startTime:void 0,endTime:void 0,contact:void 0},o=await ke(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!o.ok){const u=await o.text().catch(()=>"Could not read error response");throw new Error(`Failed to create event: ${u}`)}const l=await o.json();l.event&&e(u=>({events:[...u.events,l.event]}))},updateEvent:async(a,r)=>{const n=je.eventsById(a);if(Dt()){console.log("🖼️ Screenshot environment detected - skipping network request."),e(c=>({events:c.events.map(d=>d.id===a?{...d,...r,updatedAt:new Date().toISOString()}:d)}));return}const o=await ke(n,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok){const c=await o.text().catch(()=>"Could not read error response");throw new Error(`Failed to update event: ${c}`)}const l=await o.json();l.event&&e(c=>({events:c.events.map(d=>d.id===a?l.event:d)}))},deleteEvent:async a=>{const r=je.eventsById(a);if(Dt()){console.log("🖼️ Screenshot environment detected - skipping network request."),e(o=>({events:o.events.filter(l=>l.id!==a)}));return}const n=await ke(r,{method:"DELETE"});if(!n.ok){const o=await n.text().catch(()=>"Could not read error response");throw new Error(`Failed to delete event: ${o}`)}e(o=>({events:o.events.filter(l=>l.id!==a)}))},clearAllEvents:async()=>{const a=je.events;if(Dt()){console.log("🖼️ Screenshot environment detected - skipping network request."),e({events:[]});return}const r=await ke(a,{method:"DELETE"});if(!r.ok){const n=await r.text().catch(()=>"Could not read error response");throw new Error(`Failed to clear events: ${n}`)}e({events:[]})},loadEventsFromDatabase:async()=>{var d;const a=je.events;if(Dt()){console.log("🖼️ Screenshot environment detected - skipping network request.");return}const r=We.getState();if(r.user&&r.user.id.startsWith("offline-")){console.log("👤 Offline user detected in loadEventsFromDatabase - skipping API call");return}console.log("📥 Loading events from database..."),console.log("🔗 API URL:",a),console.log("🔑 Using API base:",as.base||"same-origin");const n=await ke(a);if(console.log("📡 Response status:",n.status),console.log("📡 Response ok:",n.ok),console.log("📡 Response URL:",n.url),!n.ok){const i=await n.text().catch(()=>"Could not read error response");throw console.error("❌ Failed to load events:",i),console.error("❌ Response status:",n.status,n.statusText),new Error(`Failed to load events: ${i}`)}const o=await n.json();console.log(`✅ Loaded ${((d=o.events)==null?void 0:d.length)||0} events from database:`,o.events);const l=(o.events||[]).map(i=>{var u,m,w;return console.log("🔄 Transforming event:",i.id,"start_time:",i.start_time,"end_time:",i.end_time),{...i,startTime:i.start_time||i.startTime,endTime:i.end_time||i.endTime,contact:{name:i.contact_name||((u=i.contact)==null?void 0:u.name)||"",phone:i.contact_phone||((m=i.contact)==null?void 0:m.phone)||"",email:i.contact_email||((w=i.contact)==null?void 0:w.email)||""},start_time:void 0,end_time:void 0,contact_name:void 0,contact_phone:void 0,contact_email:void 0}}),c=t().events;console.log("🔄 Previous events count:",c.length),e({events:l}),console.log("🔄 New events count after set:",t().events.length),console.log("🔄 Store state updated with transformed events:",t().events)},setFilters:a=>{e(r=>({filters:{...r.filters,...a}}))},setSelectedEvent:a=>{e({selectedEvent:a})},setEventDialogOpen:a=>{e({isEventDialogOpen:a})},addVenue:a=>{const r={...a,id:`venue-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};e(n=>({venues:[...n.venues,r]}))},updateVenue:(a,r)=>{e(n=>({venues:n.venues.map(o=>o.id===a?{...o,...r}:o)}))},deleteVenue:a=>{e(r=>({venues:r.venues.filter(n=>n.id!==a)}))},updateSettings:a=>{e(r=>({settings:{...r.settings,...a}}))},resetToDefaults:()=>{e({settings:{...Or}})},uploadLogo:async a=>{try{const r=new FileReader;r.onload=n=>{var l;const o=(l=n.target)==null?void 0:l.result;e(c=>({settings:{...c.settings,logo:o}}))},r.readAsDataURL(a)}catch(r){console.error("Error uploading logo:",r)}},getFilteredEvents:()=>{const{events:a,filters:r}=t();return a.filter(n=>{if(r.venue&&n.venue!==r.venue&&n.venueId!==r.venue||r.status&&n.status!==r.status||r.paymentStatus&&n.paymentStatus!==r.paymentStatus)return!1;if(r.searchQuery){const o=r.searchQuery.toLowerCase(),l=i=>i.replace(/[\s\-\(\)\.]/g,""),c=l(o),d=l(n.contact.phone);return n.title.toLowerCase().includes(o)||n.contact.name.toLowerCase().includes(o)||n.contact.phone.includes(o)||d.includes(c)||n.contact.email.toLowerCase().includes(o)}return!0})},getEventStats:()=>t().getFilteredEvents().reduce((r,n)=>{var d,i,u;r[n.status]++,r[n.paymentStatus]++;const o=((d=n.pricing)==null?void 0:d.total)||0,l=((i=n.pricing)==null?void 0:i.amountPaid)||0,c=((u=n.pricing)==null?void 0:u.remainingBalance)||0;return n.paymentStatus==="paid"?r.totalRevenue+=o:(r.totalRevenue+=l,r.totalOutstanding+=c),r},{confirmed:0,pending:0,cancelled:0,closed:0,paid:0,unpaid:0,totalRevenue:0,totalOutstanding:0}),getEventsForDate:a=>t().getFilteredEvents().filter(n=>n.date===a),getVenueById:a=>t().venues.find(n=>n.id===a),getEventColor:a=>{if(a.color)return a.color;const r=t().getVenueById(a.venueId||a.venue);return(r==null?void 0:r.color)||"#6b7280"}}));typeof window<"u"&&Ae.getState().loadEventsFromDatabase().catch(e=>{console.warn("⚠️ Failed to load events:",e)});const Bc={confirmed:"bg-blue-50 text-blue-700 border-blue-200",pending:"bg-amber-50 text-amber-700 border-amber-200",cancelled:"bg-red-50 text-red-700 border-red-200",closed:"bg-slate-50 text-slate-700 border-slate-200"},Lr=e=>{if(!e||typeof e!="string")return"N/A";const t=e.split(":");if(t.length<2)return e;const[a,r]=t.map(Number);if(isNaN(a)||isNaN(r))return e;const n=a>=12?"PM":"AM";return`${a===0?12:a>12?a-12:a}:${r.toString().padStart(2,"0")} ${n}`},In=({event:e,compact:t=!1,onClick:a,showFullDetails:r=!1})=>{var m,w,j,x,f;const{getEventColor:n,getVenueById:o}=Ae(),l=Lr(e.startTime),c=Lr(e.endTime),d=n(e),i=o(e.venueId||e.venue),u=g=>{g.stopPropagation(),a==null||a()};return t?s.jsxs("div",{className:`
          px-2 py-1 rounded text-xs cursor-pointer hover:shadow-sm transition-all border-2
          ${e.status==="cancelled"?"opacity-60":""}
          ${e.status==="closed"?"opacity-80":""}
        `,style:{backgroundColor:`${d}15`,borderColor:d,color:"#1f2937"},onClick:u,children:[s.jsx("div",{className:"flex items-center gap-1 mb-0.5",children:s.jsxs("span",{className:`font-medium truncate ${e.status==="closed"?"line-through":""}`,children:[e.title," (",l," - ",c,")",e.status==="cancelled"&&" (Cancelled)"]})}),s.jsx("div",{className:"opacity-70 text-xs mt-0.5",children:s.jsxs("div",{className:"font-medium",children:[((m=e.contact)==null?void 0:m.name)||"No contact"," (",((w=e.contact)==null?void 0:w.phone)||"N/A",")"]})})]}):s.jsxs("div",{className:`
        bg-white rounded-lg shadow-lg border border-slate-200 p-4 cursor-pointer 
        hover:shadow-xl hover:border-slate-300 hover:scale-[1.02] transition-all duration-200
        ${e.status==="cancelled"?"opacity-60":""}
        ${e.status==="closed"?"opacity-80":""}
      `,onClick:u,children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:d}}),s.jsx("span",{className:"text-lg",children:(i==null?void 0:i.icon)||"📅"}),s.jsxs("h3",{className:`font-semibold text-gray-900 ${e.status==="closed"?"line-through":""}`,children:[e.title,e.status==="cancelled"&&" (Cancelled)"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium border ${Bc[e.status]}`,children:e.status}),s.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium border ${e.paymentStatus==="paid"?"bg-green-50 text-green-700 border-green-200":"bg-orange-50 text-orange-700 border-orange-200"}`,children:e.paymentStatus})]})]}),s.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[l," – ",c]}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("div",{className:"font-medium",children:((j=e.contact)==null?void 0:j.name)||"No contact"}),s.jsx("div",{children:((x=e.contact)==null?void 0:x.phone)||"N/A"}),r&&((f=e.contact)==null?void 0:f.email)&&s.jsx("div",{children:e.contact.email}),e.createdBy&&s.jsxs("div",{className:"text-xs text-gray-500",children:["Added by ",s.jsx("span",{className:"font-medium text-gray-700",children:e.createdBy.displayName||e.createdBy.userId}),e.createdBy.role&&` (${e.createdBy.role})`]})]}),r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-3 text-sm text-gray-600",children:s.jsxs("div",{className:"font-medium",children:["Venue: ",(i==null?void 0:i.name)||e.venue]})}),s.jsx("div",{className:"mt-3 text-sm text-gray-600",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"font-medium",children:"Payment:"}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.paymentStatus==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:e.paymentStatus}),e.paymentMethod&&e.paymentStatus==="paid"&&s.jsxs("span",{className:"text-gray-500",children:["via ",e.paymentMethod.replace("_"," ")]})]})})]}),e.notes&&s.jsx("div",{className:`mt-2 text-xs text-gray-500 italic ${r?"":"truncate"}`,children:e.notes})]})},qc=({currentDate:e,onDateClick:t,onEventClick:a})=>{const{getEventsForDate:r,events:n}=Ae();console.log(`📅 Calendar rendering for month: ${me(e,"MMMM yyyy")}`),console.log(`📊 Total events in store: ${n.length}`,n);const o=Na(e),l=_a(e),c=Ji({start:o,end:l}),d=i=>{t&&t(me(i,"yyyy-MM-dd"))};return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(i=>s.jsx("div",{className:"px-4 py-3 text-sm font-medium text-gray-500 text-center border-r border-gray-100 last:border-r-0",children:i},i))}),s.jsxs("div",{className:"grid grid-cols-7",children:[Array.from({length:o.getDay()},(i,u)=>s.jsx("div",{className:"min-h-[120px] border-r border-b border-gray-100 bg-gray-50/30"},`empty-start-${u}`)),c.map((i,u)=>{const m=me(i,"yyyy-MM-dd"),w=r(m),j=Wi(i);return w.length>0&&console.log(`📌 ${m}: ${w.length} event(s)`,w.map(x=>x.title)),s.jsxs("div",{className:`
                min-h-[120px] border-r border-b border-gray-100 last:border-r-0 p-2 cursor-pointer hover:bg-gray-50 transition-colors
                ${j?"bg-blue-50":""}
              `,onClick:()=>d(i),children:[s.jsx("div",{className:`
                text-sm font-medium mb-2 
                ${j?"text-blue-600 font-bold":"text-gray-900"}
              `,children:me(i,"d")}),s.jsxs("div",{className:"space-y-1",children:[w.slice(0,3).map(x=>s.jsx(In,{event:x,compact:!0,onClick:()=>a==null?void 0:a(x.id)},x.id)),w.length>3&&s.jsxs("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",w.length-3," more"]})]})]},u)}),Array.from({length:6-l.getDay()},(i,u)=>s.jsx("div",{className:"min-h-[120px] border-r border-b border-gray-100 bg-gray-50/30 last:border-r-0"},`empty-end-${u}`))]})]})},Zc=({selectedDate:e,onDateChange:t,onBackToMonth:a,onNewEvent:r,onEventClick:n})=>{const{getEventsForDate:o}=Ae(),l=Yi(e,"yyyy-MM-dd",new Date),c=o(e),d=()=>{const u=new Date(l);u.setDate(u.getDate()-1),t(me(u,"yyyy-MM-dd"))},i=()=>{const u=new Date(l);u.setDate(u.getDate()+1),t(me(u,"yyyy-MM-dd"))};return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 h-full flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[s.jsx(gt,{className:"h-4 w-4"}),"Back to Month"]}),s.jsx("div",{className:"w-px h-6 bg-gray-300"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:d,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:s.jsx(Cl,{className:"h-5 w-5"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:me(l,"EEEE, MMMM d, yyyy")}),s.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:s.jsx(wn,{className:"h-5 w-5"})})]})]}),s.jsxs("button",{onClick:()=>r(e),className:"flex items-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors shadow-sm",children:[s.jsx(Je,{className:"h-4 w-4"}),"Add New Event"]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(gt,{className:"h-8 w-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No events scheduled"}),s.jsxs("p",{className:"text-gray-500 mb-6",children:["No events are scheduled for ",me(l,"MMMM d, yyyy")]}),s.jsxs("button",{onClick:()=>r(e),className:"flex items-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors",children:[s.jsx(Je,{className:"h-4 w-4"}),"Schedule Event"]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[c.length," ",c.length===1?"Event":"Events"," Scheduled"]})}),c.sort((u,m)=>u.startTime.localeCompare(m.startTime)).map(u=>s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsx(In,{event:u,compact:!1,onClick:()=>n(u.id),showFullDetails:!0})},u.id))]})})]})},zc=({onNewEvent:e,currentDate:t,onDateChange:a,onNavigateToHistory:r,currentUser:n,onLogout:o})=>{const l=n??{id:"GUEST",role:"guest",firstName:"Guest",lastName:"User"},c=l.role?l.role.toUpperCase():"GUEST",{getEventStats:d,filters:i,setFilters:u,settings:m,venues:w,events:j}=Ae(),x=d(),f=y=>{u({venue:y})},g=y=>{const b=y==="prev"?Ki(t):Qi(t,1);a(b)};return s.jsxs("div",{className:"w-80 min-w-80 bg-gradient-to-b from-slate-800 to-slate-900 border-r border-slate-700 min-h-0 flex flex-col shadow-xl flex-shrink-0 overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-slate-700 flex-shrink-0",children:[s.jsxs("div",{className:"mb-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-amber-300 to-amber-500 bg-clip-text text-transparent",children:"Event Manager"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`px-3 py-1 rounded-full border text-xs ${l.id==="BOOTSTRAP"?"bg-amber-100 border-amber-400 text-amber-700":"bg-slate-800/60 border-slate-600 text-slate-200"}`,children:l.id==="BOOTSTRAP"?"SETUP MODE":c}),s.jsx("button",{onClick:o,className:"px-3 py-1 text-xs font-semibold text-white bg-red-500 hover:bg-red-600 rounded-md transition-colors",children:"Logout"})]})]}),s.jsxs("div",{className:"text-xs text-slate-300",children:[s.jsx("div",{className:"font-medium text-slate-200",children:"Signed in as"}),s.jsx("div",{className:`font-semibold ${l.id==="BOOTSTRAP","text-amber-300"}`,children:l.id==="BOOTSTRAP"?"Bootstrap Session":`${l.firstName} ${l.lastName}`}),s.jsx("div",{className:"text-slate-400 font-mono text-[11px]",children:l.id}),s.jsx("p",{className:"mt-2 text-slate-400",children:"Manage bookings, license verification, and performance insights from one control center."})]})]}),s.jsxs("button",{onClick:e,className:"w-full text-slate-900 px-4 py-2 rounded-lg font-medium transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2",style:{background:`linear-gradient(to right, ${m.themeColor}, ${m.themeColor}dd)`,filter:"hover:brightness(110%)"},onMouseEnter:y=>{y.currentTarget.style.filter="brightness(110%)"},onMouseLeave:y=>{y.currentTarget.style.filter="brightness(100%)"},children:[s.jsx(Je,{className:"h-4 w-4"}),"Add New Event"]})]}),s.jsxs("div",{className:"p-6 border-b border-slate-700 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"font-semibold text-slate-100",children:t.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>g("prev"),className:"p-1 hover:bg-slate-700 text-slate-300 hover:text-slate-100 rounded transition-colors",children:"←"}),s.jsx("button",{onClick:()=>g("next"),className:"p-1 hover:bg-slate-700 text-slate-300 hover:text-slate-100 rounded transition-colors",children:"→"})]})]}),s.jsx("button",{onClick:()=>a(new Date),className:"text-sm font-medium hover:opacity-80 transition-opacity",style:{color:m.themeColor},children:"Go to Today"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-slate-700",children:[s.jsx("h3",{className:"font-semibold text-slate-100 mb-3",children:"Venue Type"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{onClick:()=>f(void 0),className:`
                w-full text-left px-3 py-2 rounded-lg transition-colors flex items-center justify-between
                ${i.venue?"hover:bg-slate-700 text-slate-300":"border text-slate-100"}
              `,style:{backgroundColor:i.venue?void 0:`${m.themeColor}20`,borderColor:i.venue?void 0:m.themeColor,color:i.venue?void 0:m.themeColor},children:s.jsx("span",{children:"All Venues"})}),w.map(y=>s.jsx("button",{onClick:()=>f(y.id),className:`
                  w-full text-left px-3 py-2 rounded-lg transition-colors flex items-center justify-between
                  ${i.venue===y.id?"border":"hover:bg-slate-700 text-slate-300"}
                `,style:{backgroundColor:i.venue===y.id?`${m.themeColor}20`:void 0,borderColor:i.venue===y.id?m.themeColor:void 0,color:i.venue===y.id?m.themeColor:void 0},children:s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("span",{children:y.icon}),y.name]})},y.id))]})]}),s.jsxs("div",{className:"p-6 border-b border-slate-700",children:[s.jsxs("h3",{className:"font-semibold text-slate-100 mb-3 flex items-center gap-2",children:[s.jsx(gt,{className:"h-4 w-4 text-amber-400"}),"Event Status"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("button",{onClick:()=>r&&r(),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 hover:bg-slate-700 transition-colors group min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-300 group-hover:text-slate-100 min-w-0",children:[s.jsx(ns,{className:"h-4 w-4 text-slate-400 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:"All Status"})]}),s.jsx("span",{className:"font-medium text-slate-100 flex-shrink-0 ml-2",children:x.confirmed+x.pending+x.cancelled+x.closed})]}),s.jsxs("button",{onClick:()=>r&&r("confirmed"),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 hover:bg-slate-700 transition-colors group min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-300 group-hover:text-slate-100 min-w-0",children:[s.jsx(_n,{className:"h-4 w-4 text-blue-400 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:"Confirmed"})]}),s.jsx("span",{className:"font-medium text-slate-100 flex-shrink-0 ml-2",children:x.confirmed})]}),s.jsxs("button",{onClick:()=>r&&r("pending"),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 hover:bg-slate-700 transition-colors group min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-300 group-hover:text-slate-100 min-w-0",children:[s.jsx(Rl,{className:"h-4 w-4 text-yellow-400 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:"Pending"})]}),s.jsx("span",{className:"font-medium text-slate-100 flex-shrink-0 ml-2",children:x.pending})]}),s.jsxs("button",{onClick:()=>r&&r("cancelled"),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 hover:bg-slate-700 transition-colors group min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-300 group-hover:text-slate-100 min-w-0",children:[s.jsx(kn,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:"Cancelled"})]}),s.jsx("span",{className:"font-medium text-slate-100 flex-shrink-0 ml-2",children:x.cancelled})]}),s.jsxs("button",{onClick:()=>r&&r("closed"),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 hover:bg-slate-700 transition-colors group min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-300 group-hover:text-slate-100 min-w-0",children:[s.jsx(Ha,{className:"h-4 w-4 text-slate-400 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:"Closed"})]}),s.jsx("span",{className:"font-medium text-slate-100 flex-shrink-0 ml-2",children:x.closed})]})]})]}),s.jsxs("div",{className:"p-6 pb-8",children:[s.jsxs("h3",{className:"font-semibold text-slate-100 mb-3 flex items-center gap-2",children:[s.jsx(Ja,{className:"h-4 w-4 text-amber-400"}),"Payment Status"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("button",{onClick:()=>r&&r(void 0,"paid"),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 hover:bg-slate-700 transition-colors group min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-300 group-hover:text-slate-100 min-w-0",children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:"Paid"})]}),s.jsx("span",{className:"font-medium text-green-400 flex-shrink-0 ml-2",children:x.paid})]}),s.jsxs("button",{onClick:()=>r&&r(void 0,"unpaid"),className:"w-full flex items-center justify-between p-3 rounded-lg bg-slate-700/50 hover:bg-slate-700 transition-colors group min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-300 group-hover:text-slate-100 min-w-0",children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-400 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:"Unpaid"})]}),s.jsx("span",{className:"font-medium text-orange-400 flex-shrink-0 ml-2",children:x.unpaid})]})]})]})]})]})},Gc=()=>{const{filters:e,setFilters:t}=Ae(),a=d=>{t({searchQuery:d.target.value})},r=d=>{t({venue:d})},n=d=>{t({status:d})},o=d=>{t({paymentStatus:d})},l=()=>{t({venue:void 0,status:void 0,paymentStatus:void 0,searchQuery:""})},c=!!(e.venue||e.status||e.paymentStatus||e.searchQuery);return s.jsx("div",{className:"bg-white rounded-lg shadow-lg border border-slate-200 p-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(rc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search events by name, phone (313-938-6666 or 3139386666), or email...",className:"w-full pl-10 pr-20 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",value:e.searchQuery||"",onChange:a,onKeyPress:d=>d.key==="Enter"&&d.preventDefault()}),s.jsx("button",{type:"button",className:"absolute right-2 top-1/2 transform -translate-y-1/2 px-3 py-1 bg-amber-600 text-white text-sm rounded-md hover:bg-amber-700 transition-colors",onClick:()=>{const d=document.querySelector('input[placeholder*="Search events"]');d&&d.focus()},children:"Search"})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Is,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"Filters:"})]}),s.jsxs("select",{value:e.venue||"",onChange:d=>r(d.target.value||void 0),className:"px-3 py-1.5 border border-slate-300 rounded-md text-sm focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",children:[s.jsx("option",{value:"",children:"All Venues"}),s.jsx("option",{value:"restaurant",children:"Restaurant"}),s.jsx("option",{value:"bar",children:"Bar"}),s.jsx("option",{value:"banquet",children:"Banquet"})]}),s.jsxs("select",{value:e.status||"",onChange:d=>n(d.target.value||void 0),className:"px-3 py-1.5 border border-slate-300 rounded-md text-sm focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",children:[s.jsx("option",{value:"",children:"All Status"}),s.jsx("option",{value:"confirmed",children:"Confirmed"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"cancelled",children:"Cancelled"}),s.jsx("option",{value:"closed",children:"Closed"})]}),s.jsxs("select",{value:e.paymentStatus||"",onChange:d=>o(d.target.value||void 0),className:"px-3 py-1.5 border border-slate-300 rounded-md text-sm focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",children:[s.jsx("option",{value:"",children:"All Payments"}),s.jsx("option",{value:"paid",children:"Paid"}),s.jsx("option",{value:"unpaid",children:"Unpaid"})]}),c&&s.jsx("button",{onClick:l,className:"px-3 py-1.5 text-sm text-slate-600 hover:text-amber-700 underline transition-colors",children:"Clear"})]})]})})},$n={mode:"person",menuItems:[],personCount:1,pricePerPerson:0,customPlatters:[],subtotal:0,discount:{type:"percentage",value:0,amount:0},taxRate:.06,taxAmount:0,includeTax:!0,total:0,deposits:[],amountPaid:0,remainingBalance:0},Fr={title:"",venue:"restaurant",venueId:"restaurant",color:void 0,date:"",startTime:"18:00",endTime:"21:00",status:"pending",paymentStatus:"unpaid",paymentMethod:void 0,contact:{name:"",phone:"",email:""},pricing:$n,notes:""},Hc=({isOpen:e,onClose:t,event:a,defaultDate:r})=>{var le,ae;const{addEvent:n,updateEvent:o,venues:l,colorPresets:c,settings:d}=Ae(),[i,u]=T.useState(Fr),[m,w]=T.useState({}),[j,x]=T.useState(!1),[f,g]=T.useState("details"),y=!!a;T.useEffect(()=>{e&&(u(a?{title:a.title,venue:a.venue,venueId:a.venueId||a.venue,color:a.color,date:a.date,startTime:a.startTime,endTime:a.endTime,status:a.status,paymentStatus:a.paymentStatus,paymentMethod:a.paymentMethod,contact:a.contact,pricing:a.pricing||$n,notes:a.notes||""}:{...Fr,date:r||new Date().toISOString().split("T")[0]}),w({}))},[e,a,r]);const b=()=>{const h={};return i.title.trim()||(h.title="Event title is required"),i.date||(h.date="Date is required"),i.startTime||(h.startTime="Start time is required"),i.endTime||(h.endTime="End time is required"),i.startTime&&i.endTime&&i.startTime>=i.endTime&&(h.endTime="End time must be after start time"),i.contact.name.trim()||(h["contact.name"]="Contact name is required"),i.contact.phone.trim()||(h["contact.phone"]="Contact phone is required"),i.contact.email.trim()?/^[^@]+@[^@]+\.[^@]+$/.test(i.contact.email)||(h["contact.email"]="Please enter a valid email address"):h["contact.email"]="Contact email is required",w(h),Object.keys(h).length===0},E=async h=>{h.preventDefault(),b()&&(y&&a?await o(a.id,i):await n(i),t())},N=(h,C)=>{if(h.startsWith("contact.")){const z=h.split(".")[1];u(_=>({..._,contact:{..._.contact,[z]:C}}))}else u(z=>({...z,[h]:C}));m[h]&&w(z=>({...z,[h]:""}))},O=h=>{const C=h.menuItems.reduce((ye,fe)=>ye+fe.price*fe.quantity,0),z=h.customPlatters.reduce((ye,fe)=>ye+fe.price*fe.quantity,0);let _=0;_+=C,h.personCount>0&&h.pricePerPerson>0&&(_+=h.personCount*h.pricePerPerson),h.mode==="custom"&&(_+=z);let V=0;h.discount.value>0&&(h.discount.type==="percentage"?V=_*(h.discount.value/100):V=h.discount.value);const q=_-V,$=h.includeTax?q*h.taxRate:0,oe=q+$,G=h.deposits.reduce((ye,fe)=>ye+fe.amount,0),xe=oe-G;return{...h,subtotal:_,discount:{...h.discount,amount:V},taxAmount:$,total:oe,amountPaid:G,remainingBalance:xe}},I=h=>{const C={...i.pricing,...h},z=O(C);u(_=>({..._,pricing:z}))},Y=()=>{const h={id:crypto.randomUUID(),name:"",price:0,quantity:1,description:""};I({menuItems:[...i.pricing.menuItems,h]})},L=(h,C)=>{const z=i.pricing.menuItems.map(_=>_.id===h?{..._,...C}:_);I({menuItems:z})},B=h=>{const C=i.pricing.menuItems.filter(z=>z.id!==h);I({menuItems:C})},re=()=>{const h={id:crypto.randomUUID(),name:"",price:0,quantity:1,description:""};I({customPlatters:[...i.pricing.customPlatters,h]})},F=(h,C)=>{const z=i.pricing.customPlatters.map(_=>_.id===h?{..._,...C}:_);I({customPlatters:z})},M=h=>{const C=i.pricing.customPlatters.filter(z=>z.id!==h);I({customPlatters:C})},K=()=>{const h={id:crypto.randomUUID(),amount:0,method:"cash",date:new Date().toISOString().split("T")[0],notes:""},C=[...i.pricing.deposits,h],z=C.reduce((_,V)=>_+V.amount,0);I({deposits:C,amountPaid:z,remainingBalance:i.pricing.total-z})},v=(h,C)=>{const z=i.pricing.deposits.map(V=>V.id===h?{...V,...C}:V),_=z.reduce((V,q)=>V+q.amount,0);I({deposits:z,amountPaid:_,remainingBalance:i.pricing.total-_})},P=h=>{const C=i.pricing.deposits.filter(_=>_.id!==h),z=C.reduce((_,V)=>_+V.amount,0);I({deposits:C,amountPaid:z,remainingBalance:i.pricing.total-z})},J=h=>{const[C,z]=h.split(":").map(Number),_=C>=12?"PM":"AM";return`${C%12||12}:${z.toString().padStart(2,"0")} ${_}`},ie=()=>{var q;const h=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice - ${i.title}</title>
        <style>
          @page {
            margin: 20px;
            size: A4;
          }
          body { 
            font-family: Arial, sans-serif; 
            margin: 0;
            padding: 20px;
            line-height: 1.4;
            font-size: 12px;
          }
          .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start; 
            margin-bottom: 25px;
          }
          .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
          }
          .logo { 
            max-width: 80px; 
            max-height: 80px; 
            object-fit: contain;
            margin-bottom: 10px;
          }
          .company-details {
            text-align: left;
          }
          .invoice-title { 
            font-size: 24px; 
            font-weight: bold; 
            margin: 0;
            color: #1f2937;
          }
          .subtitle {
            color: #6b7280;
            margin-top: 4px;
          }
          .section {
            margin-bottom: 15px;
          }
          .section-row {
            display: flex;
            justify-content: space-between;
            gap: 40px;
            margin-bottom: 15px;
          }
          .section-col {
            flex: 1;
          }
          .section h3 {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 8px;
          }
          .company-details, .client-details, .event-details {
            color: #374151;
          }
          .company-details p, .client-details p, .event-details p {
            margin: 2px 0;
          }
          .font-medium { font-weight: 500; }
          table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0; 
          }
          th, td { 
            border: 1px solid #d1d5db; 
            padding: 8px; 
          }
          th { 
            background-color: #f9fafb; 
            font-weight: 600;
            text-align: left;
          }
          .text-center { text-align: center; }
          .text-right { text-align: right; }
          .text-sm { font-size: 12px; color: #6b7280; }
          .totals { 
            margin-top: 20px; 
            width: 320px; 
            margin-left: auto;
          }
          .totals-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #6b7280;
          }
          .subtotal-row {
            display: flex;
            justify-content: space-between;
            padding-top: 8px;
            border-top: 1px solid #d1d5db;
            font-weight: 500;
          }
          .discount-row {
            display: flex;
            justify-content: space-between;
            color: #dc2626;
          }
          .total-row { 
            display: flex;
            justify-content: space-between;
            border-top: 2px solid #6b7280;
            padding-top: 12px;
            font-weight: bold; 
            font-size: 20px;
          }
          .total-amount {
            color: #16a34a;
          }
          .footer {
            border-top: 1px solid #e5e7eb;
            padding-top: 16px;
            text-align: center;
            font-size: 14px;
            color: #6b7280;
            margin-top: 40px;
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="logo-section">
            <img src="${d.logo&&d.logo.startsWith("data:")?d.logo:"/assets/default-logo.png"}" alt="Logo" class="logo" />
            <div class="company-details">
              <p class="font-medium" style="margin: 0; font-size: 16px;">${d.storeName}</p>
              ${d.storeAddress?`<p style="margin: 2px 0; font-size: 12px;">${d.storeAddress}</p>`:""}
              ${d.storePhone?`<p style="margin: 2px 0; font-size: 12px;">Phone: ${d.storePhone}</p>`:""}
              ${d.storeEmail?`<p style="margin: 2px 0; font-size: 12px;">Email: ${d.storeEmail}</p>`:""}
            </div>
          </div>
          <div style="text-align: right;">
            <p style="font-size: 14px; color: #6b7280;">Invoice Date:</p>
            <p class="font-medium">${new Date().toLocaleDateString()}</p>
            <p style="font-size: 14px; color: #6b7280; margin-top: 8px;">Event Date:</p>
            <p class="font-medium">${new Date(i.date+"T00:00:00").toLocaleDateString()}</p>
          </div>
        </div>
        
        <div style="text-align: center; margin: 20px 0;">
          <h1 class="invoice-title">INVOICE</h1>
          <p class="subtitle">Event Management Services</p>
        </div>
        
        <div class="section-row">
          <div class="section-col">
            <h3>Bill To:</h3>
            <div class="client-details">
              <p class="font-medium">${i.contact.name}</p>
              <p>${i.contact.email}</p>
              <p>${i.contact.phone}</p>
            </div>
          </div>
          <div class="section-col">
            <h3>Event Details:</h3>
            <div class="event-details">
              <p><span class="font-medium">Event:</span> ${i.title}</p>
              <p><span class="font-medium">Date:</span> ${new Date(i.date+"T00:00:00").toLocaleDateString()}</p>
              <p><span class="font-medium">Time:</span> ${J(i.startTime)} - ${J(i.endTime)}</p>
              <p><span class="font-medium">Venue:</span> ${((q=l.find($=>$.id===i.venueId))==null?void 0:q.name)||"N/A"}</p>
            </div>
          </div>
        </div>
        
        <div class="section">
          <h3>Services:</h3>
          <table>
            <thead>
              <tr>
                <th>Description</th>
                <th class="text-center">Quantity</th>
                <th class="text-right">Unit Price</th>
                <th class="text-right">Total</th>
              </tr>
            </thead>
            <tbody>
              ${i.pricing.personCount>0&&i.pricing.pricePerPerson>0?`
                <tr>
                  <td>Guest Services</td>
                  <td class="text-center">${i.pricing.personCount}</td>
                  <td class="text-right">$${i.pricing.pricePerPerson.toFixed(2)}</td>
                  <td class="text-right">$${(i.pricing.personCount*i.pricing.pricePerPerson).toFixed(2)}</td>
                </tr>
              `:""}
              ${i.pricing.menuItems.map($=>`
                <tr>
                  <td>
                    ${$.name}${$.description?` <span style="color: #1e3a8a;">(${$.description})</span>`:""}
                  </td>
                  <td class="text-center">${$.quantity}</td>
                  <td class="text-right">${$.price>0?"$"+$.price.toFixed(2):"N/A"}</td>
                  <td class="text-right">${$.price>0?"$"+($.price*$.quantity).toFixed(2):"Included"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        
        <div class="section">
          <div class="totals">
            <!-- Menu Items Breakdown -->
            <div class="totals-row">
              <span>Menu Items:</span>
              <span>$${i.pricing.menuItems.reduce(($,oe)=>$+oe.price*oe.quantity,0).toFixed(2)}</span>
            </div>
            ${i.pricing.personCount>0&&i.pricing.pricePerPerson>0?`
              <!-- Guest Services Breakdown -->
              <div class="totals-row">
                <span>Guest Services (${i.pricing.personCount} guests):</span>
                <span>$${(i.pricing.personCount*i.pricing.pricePerPerson).toFixed(2)}</span>
              </div>
            `:""}
            <div class="subtotal-row">
              <span>Subtotal:</span>
              <span>$${i.pricing.subtotal.toFixed(2)}</span>
            </div>
            ${i.pricing.discount.amount>0?`
              <div class="discount-row">
                <span>Discount:</span>
                <span>-$${i.pricing.discount.amount.toFixed(2)}</span>
              </div>
            `:""}
            ${i.pricing.includeTax?`
              <div class="totals-row">
                <span>Tax (${(i.pricing.taxRate*100).toFixed(1)}%):</span>
                <span>$${i.pricing.taxAmount.toFixed(2)}</span>
              </div>
            `:""}
            <div class="total-row">
              <span>Final Total:</span>
              <span class="total-amount">$${i.pricing.total.toFixed(2)}</span>
            </div>
          </div>
        </div>
        
        <div class="footer">
          <p>Thank you for your business!</p>
          <p style="margin-top: 8px;">Powered and Designed By Mike Akanan | (313) 938-6666</p>
        </div>
      </body>
      </html>
    `,C=window.open("","_blank");C&&(C.document.write(h),C.document.close(),C.onload=()=>{setTimeout(()=>{C.print()},250)});const z=`Invoice: ${i.title}`,_=`Dear ${i.contact.name},

Please find the invoice for your event below.

Event: ${i.title}
Date: ${new Date(i.date).toLocaleDateString()}
Total: $${i.pricing.total.toFixed(2)}

Thank you for your business!

Best regards`,V=`mailto:${i.contact.email}?subject=${encodeURIComponent(z)}&body=${encodeURIComponent(_)}`;window.open(V,"_blank")},ee=h=>{var V;const C=`Event Schedule: ${i.title}`;let z=`Dear ${i.contact.name},

`;z+=`This is to confirm your event details:

`,z+=`Event: ${i.title}
`,z+=`Date: ${new Date(i.date).toLocaleDateString()}
`,z+=`Time: ${i.startTime} - ${i.endTime}
`,z+=`Venue: ${(V=l.find(q=>q.id===i.venueId))==null?void 0:V.name}

`,i.notes&&(z+=`Notes: ${i.notes}

`),z+=`Best regards,
${i.contact.name}`;const _=`mailto:${i.contact.email}?subject=${encodeURIComponent(C)}&body=${encodeURIComponent(z)}`;window.open(_,"_blank")};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:y?"Edit Event":"Add New Event"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Ut,{className:"h-6 w-6"})})]}),s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("div",{className:"flex px-6",children:[s.jsx("button",{type:"button",onClick:()=>g("details"),className:`py-3 px-4 text-sm font-medium border-b-2 transition-colors ${f==="details"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Event Details"}),s.jsxs("button",{type:"button",onClick:()=>g("guests"),className:`py-3 px-4 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${f==="guests"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[s.jsx(ns,{className:"h-4 w-4"}),"Guest Count"]}),s.jsxs("button",{type:"button",onClick:()=>g("menu"),className:`py-3 px-4 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${f==="menu"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[s.jsx(ka,{className:"h-4 w-4"}),"Menu & Pricing"]}),s.jsxs("button",{type:"button",onClick:()=>g("invoice"),className:`py-3 px-4 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${f==="invoice"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[s.jsx(Ft,{className:"h-4 w-4"}),"Invoice Preview"]})]})}),s.jsxs("form",{onSubmit:E,className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[f==="details"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Title *"}),s.jsx("input",{type:"text",value:i.title,onChange:h=>N("title",h.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${m.title?"border-red-300":"border-gray-300"}`,placeholder:"e.g., Corporate Holiday Party"}),m.title&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.title})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Venue *"}),s.jsx("select",{value:i.venueId||i.venue,onChange:h=>{const C=l.find(z=>z.id===h.target.value);N("venueId",h.target.value),N("venue",(C==null?void 0:C.type)||h.target.value)},className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",children:l.map(h=>s.jsxs("option",{value:h.id,children:[h.icon," ",h.name]},h.id))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Color"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>x(!j),className:"flex items-center gap-2 px-3 py-2 border border-slate-300 rounded-md hover:bg-slate-50 transition-colors",children:[s.jsx("div",{className:"w-5 h-5 rounded border border-slate-300",style:{backgroundColor:i.color||((le=l.find(h=>h.id===(i.venueId||i.venue)))==null?void 0:le.color)||"#6b7280"}}),s.jsx(Sn,{className:"h-4 w-4"}),i.color?"Custom":"Default"]}),i.color&&s.jsx("button",{type:"button",onClick:()=>N("color",""),className:"text-sm text-slate-500 hover:text-slate-700",children:"Reset"})]}),j&&s.jsxs("div",{className:"mt-3 p-3 border border-slate-200 rounded-lg bg-slate-50",children:[s.jsx("div",{className:"grid grid-cols-6 gap-2 mb-3",children:c.slice(0,12).map(h=>s.jsx("button",{type:"button",onClick:()=>{N("color",h.color),x(!1)},className:"w-8 h-8 rounded border-2 border-white shadow-sm hover:scale-110 transition-transform",style:{backgroundColor:h.color},title:h.name},h.id))}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"color",value:i.color||"#6b7280",onChange:h=>N("color",h.target.value),className:"w-10 h-8 rounded border border-slate-300"}),s.jsx("span",{className:"text-sm text-slate-600",children:"Custom Color"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),s.jsx("input",{type:"date",value:i.date,onChange:h=>N("date",h.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${m.date?"border-red-300":"border-gray-300"}`}),m.date&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.date})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time *"}),s.jsx("input",{type:"time",value:i.startTime,onChange:h=>N("startTime",h.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${m.startTime?"border-red-300":"border-gray-300"}`}),m.startTime&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.startTime})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Time *"}),s.jsx("input",{type:"time",value:i.endTime,onChange:h=>N("endTime",h.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${m.endTime?"border-red-300":"border-gray-300"}`}),m.endTime&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.endTime})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),s.jsxs("select",{value:i.status,onChange:h=>N("status",h.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",children:[s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"confirmed",children:"Confirmed"}),s.jsx("option",{value:"cancelled",children:"Cancelled"}),s.jsx("option",{value:"closed",children:"Closed"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Status"}),s.jsxs("select",{value:i.paymentStatus,onChange:h=>N("paymentStatus",h.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",children:[s.jsx("option",{value:"unpaid",children:"Unpaid"}),s.jsx("option",{value:"paid",children:"Paid"})]})]}),i.paymentStatus==="paid"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),s.jsxs("select",{value:i.paymentMethod||"",onChange:h=>N("paymentMethod",h.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",children:[s.jsx("option",{value:"",children:"Select method"}),s.jsx("option",{value:"cash",children:"Cash"}),s.jsx("option",{value:"credit_card",children:"Credit Card"}),s.jsx("option",{value:"check",children:"Check"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name *"}),s.jsx("input",{type:"text",value:i.contact.name,onChange:h=>N("contact.name",h.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${m["contact.name"]?"border-red-300":"border-gray-300"}`,placeholder:"Contact person name"}),m["contact.name"]&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m["contact.name"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone *"}),s.jsx("input",{type:"tel",value:i.contact.phone,onChange:h=>{let C=h.target.value.replace(/\D/g,"");C.length<=3?C=C:C.length<=6?C=`${C.slice(0,3)}-${C.slice(3)}`:C.length<=10?C=`${C.slice(0,3)}-${C.slice(3,6)}-${C.slice(6)}`:C=`${C.slice(0,3)}-${C.slice(3,6)}-${C.slice(6,10)}`,N("contact.phone",C)},className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${m["contact.phone"]?"border-red-300":"border-gray-300"}`,placeholder:"000-000-0000",maxLength:12}),m["contact.phone"]&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m["contact.phone"]})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email *"}),s.jsx("input",{type:"email",value:i.contact.email,onChange:h=>N("contact.email",h.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${m["contact.email"]?"border-red-300":"border-gray-300"}`,placeholder:"contact@example.com"}),m["contact.email"]&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m["contact.email"]})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),s.jsx("textarea",{value:i.notes,onChange:h=>N("notes",h.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent shadow-sm",placeholder:"Special requests, dietary restrictions, etc."})]})]}),f==="guests"&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(ns,{className:"h-5 w-5 text-blue-600"}),"Guest Count & Pricing"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Guests"}),s.jsx("input",{type:"number",value:i.pricing.personCount||"",onChange:h=>I({personCount:parseInt(h.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",placeholder:"0"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Total number of guests attending"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Per Guest ($)"}),s.jsx("input",{type:"number",value:i.pricing.pricePerPerson||"",onChange:h=>I({pricePerPerson:parseFloat(h.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0",placeholder:"0.00"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cost per guest for the event"})]})]}),s.jsx("div",{className:"mt-4 p-4 bg-white rounded-md border",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Guest Subtotal:"}),s.jsxs("span",{className:"text-lg font-bold text-blue-600",children:["$",((i.pricing.personCount||0)*(i.pricing.pricePerPerson||0)).toFixed(2)]})]})})]})}),f==="menu"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Menu Items"}),s.jsxs("button",{type:"button",onClick:Y,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[s.jsx(Je,{className:"h-4 w-4"}),"Add Item"]})]}),s.jsxs("div",{className:"grid grid-cols-12 gap-3 mb-3 px-3 py-2 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"col-span-4",children:s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Item Name"})}),s.jsx("div",{className:"col-span-2",children:s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Price ($)"})}),s.jsx("div",{className:"col-span-2",children:s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Quantity"})}),s.jsx("div",{className:"col-span-3",children:s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Total"})}),s.jsx("div",{className:"col-span-1",children:s.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Action"})})]}),s.jsx("div",{className:"space-y-3",children:i.pricing.menuItems.map(h=>s.jsxs("div",{className:"grid grid-cols-12 gap-3 items-start p-3 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsx("div",{className:"col-span-4",children:s.jsx("input",{type:"text",placeholder:"Enter item name",value:h.name,onChange:C=>L(h.id,{name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent font-medium"})}),s.jsx("div",{className:"col-span-2",children:s.jsx("input",{type:"number",placeholder:"0.00",value:h.price||"",onChange:C=>L(h.id,{price:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"})}),s.jsx("div",{className:"col-span-2",children:s.jsx("input",{type:"number",placeholder:"1",value:h.quantity||"",onChange:C=>L(h.id,{quantity:parseInt(C.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1"})}),s.jsx("div",{className:"col-span-3",children:s.jsx("div",{className:"flex items-center justify-center h-10",children:s.jsx("span",{className:"text-lg font-bold text-gray-900",children:h.price>0?`$${(h.price*h.quantity).toFixed(2)}`:"Included"})})}),s.jsx("div",{className:"col-span-1",children:s.jsx("div",{className:"flex items-center justify-center h-10",children:s.jsx("button",{type:"button",onClick:()=>B(h.id),className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors",title:"Remove item",children:s.jsx(jt,{className:"h-4 w-4"})})})}),s.jsx("div",{className:"col-span-12",children:s.jsx("input",{type:"text",placeholder:"Description (optional)",value:h.description||"",onChange:C=>L(h.id,{description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})})]},h.id))})]}),i.pricing.mode==="custom"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Custom Platters"}),s.jsxs("button",{type:"button",onClick:re,className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[s.jsx(Je,{className:"h-4 w-4"}),"Add Platter"]})]}),s.jsx("div",{className:"space-y-3",children:i.pricing.customPlatters.map(h=>s.jsxs("div",{className:"grid grid-cols-12 gap-3 items-start p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"col-span-4",children:s.jsx("input",{type:"text",placeholder:"Platter name",value:h.name,onChange:C=>F(h.id,{name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent"})}),s.jsx("div",{className:"col-span-2",children:s.jsx("input",{type:"number",placeholder:"Price",value:h.price||"",onChange:C=>F(h.id,{price:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent",step:"0.01",min:"0"})}),s.jsx("div",{className:"col-span-2",children:s.jsx("input",{type:"number",placeholder:"Qty",value:h.quantity||"",onChange:C=>F(h.id,{quantity:parseInt(C.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"1"})}),s.jsx("div",{className:"col-span-3",children:s.jsxs("div",{className:"flex items-center justify-between h-10",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",(h.price*h.quantity).toFixed(2)]}),s.jsx("button",{type:"button",onClick:()=>M(h.id),className:"text-red-500 hover:text-red-700 transition-colors",children:s.jsx(jt,{className:"h-4 w-4"})})]})}),s.jsx("div",{className:"col-span-12",children:s.jsx("input",{type:"text",placeholder:"Platter description (optional)",value:h.description||"",onChange:C=>F(h.id,{description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm"})})]},h.id))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Discount"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Type"}),s.jsxs("select",{value:i.pricing.discount.type,onChange:h=>I({discount:{...i.pricing.discount,type:h.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"percentage",children:"Percentage (%)"}),s.jsx("option",{value:"fixed",children:"Fixed Amount ($)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Value"}),s.jsx("input",{type:"number",value:i.pricing.discount.value||"",onChange:h=>I({discount:{...i.pricing.discount,value:parseFloat(h.target.value)||0}}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:i.pricing.discount.type==="percentage"?"1":"0.01",min:"0",max:i.pricing.discount.type==="percentage"?"100":void 0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Amount"}),s.jsxs("div",{className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-md text-gray-700",children:["$",i.pricing.discount.amount.toFixed(2)]})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tax Settings"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx("div",{children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"includeTax",checked:i.pricing.includeTax,onChange:h=>I({includeTax:h.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("label",{htmlFor:"includeTax",className:"text-sm font-medium text-gray-700",children:"Include Tax"})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Rate (%)"}),s.jsx("input",{type:"number",value:(i.pricing.taxRate*100).toFixed(1),onChange:h=>I({taxRate:(parseFloat(h.target.value)||0)/100}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.1",min:"0",max:"100",disabled:!i.pricing.includeTax})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Amount"}),s.jsxs("div",{className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-md text-gray-700",children:["$",i.pricing.taxAmount.toFixed(2)]})]})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Deposits & Payments"}),s.jsxs("button",{type:"button",onClick:K,className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[s.jsx(Je,{className:"h-4 w-4"}),"Add Deposit"]})]}),i.pricing.deposits.length>0&&s.jsx("div",{className:"space-y-3 mb-4",children:i.pricing.deposits.map(h=>s.jsxs("div",{className:"grid grid-cols-12 gap-3 items-start p-3 bg-green-50 rounded-lg border border-green-200",children:[s.jsxs("div",{className:"col-span-3",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Amount ($)"}),s.jsx("input",{type:"number",placeholder:"0.00",value:h.amount||"",onChange:C=>v(h.id,{amount:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent",step:"0.01",min:"0"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Method"}),s.jsxs("select",{value:h.method,onChange:C=>v(h.id,{method:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm",children:[s.jsx("option",{value:"cash",children:"Cash"}),s.jsx("option",{value:"credit_card",children:"Credit Card"}),s.jsx("option",{value:"check",children:"Check"}),s.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),s.jsx("option",{value:"venmo",children:"Venmo"}),s.jsx("option",{value:"paypal",children:"PayPal"}),s.jsx("option",{value:"zelle",children:"Zelle"}),s.jsx("option",{value:"other",children:"Other"})]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date"}),s.jsx("input",{type:"date",value:h.date,onChange:C=>v(h.id,{date:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm"})]}),s.jsxs("div",{className:"col-span-4",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",placeholder:"Payment notes...",value:h.notes||"",onChange:C=>v(h.id,{notes:C.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm"}),s.jsx("button",{type:"button",onClick:()=>P(h.id),className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors",title:"Remove deposit",children:s.jsx(jt,{className:"h-4 w-4"})})]})]})]},h.id))}),s.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Total Deposits"}),s.jsxs("div",{className:"text-lg font-bold text-green-600",children:["$",i.pricing.deposits.reduce((h,C)=>h+C.amount,0).toFixed(2)]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Total Due"}),s.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["$",i.pricing.total.toFixed(2)]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Remaining Balance"}),s.jsxs("div",{className:`text-lg font-bold ${i.pricing.remainingBalance<=0?"text-green-600":"text-orange-600"}`,children:["$",i.pricing.remainingBalance.toFixed(2)]})]})]})})]}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[s.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(ka,{className:"h-5 w-5 text-blue-600"}),"Pricing Summary"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Menu Items Subtotal:"}),s.jsxs("span",{className:"font-medium",children:["$",i.pricing.menuItems.reduce((h,C)=>h+C.price*C.quantity,0).toFixed(2)]})]}),i.pricing.personCount>0&&i.pricing.pricePerPerson>0&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{className:"text-gray-600",children:["Guest Services (",i.pricing.personCount," × $",i.pricing.pricePerPerson.toFixed(2),"):"]}),s.jsxs("span",{className:"font-medium",children:["$",(i.pricing.personCount*i.pricing.pricePerPerson).toFixed(2)]})]}),s.jsx("div",{className:"border-t border-gray-300 pt-2",children:s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium text-gray-800",children:"Total Subtotal:"}),s.jsxs("span",{className:"font-bold text-lg",children:["$",i.pricing.subtotal.toFixed(2)]})]})}),i.pricing.discount.amount>0&&s.jsxs("div",{className:"flex justify-between text-sm text-red-600",children:[s.jsx("span",{children:"Discount:"}),s.jsxs("span",{children:["-$",i.pricing.discount.amount.toFixed(2)]})]}),i.pricing.includeTax&&s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:["Tax (",(i.pricing.taxRate*100).toFixed(1),"%):"]}),s.jsxs("span",{children:["$",i.pricing.taxAmount.toFixed(2)]})]}),s.jsx("div",{className:"border-t-2 border-gray-400 pt-3 mt-2",children:s.jsxs("div",{className:"flex justify-between text-xl font-bold text-gray-900",children:[s.jsx("span",{children:"Final Total:"}),s.jsxs("span",{className:"text-green-600",children:["$",i.pricing.total.toFixed(2)]})]})}),i.pricing.deposits.length>0&&s.jsxs("div",{className:"border-t border-gray-300 pt-3 mt-3",children:[s.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[s.jsx("span",{children:"Total Deposits Paid:"}),s.jsxs("span",{className:"font-medium",children:["$",i.pricing.amountPaid.toFixed(2)]})]}),s.jsxs("div",{className:`flex justify-between text-lg font-bold mt-1 ${i.pricing.remainingBalance<=0?"text-green-600":"text-orange-600"}`,children:[s.jsx("span",{children:"Remaining Balance:"}),s.jsxs("span",{children:["$",i.pricing.remainingBalance.toFixed(2)]})]}),i.pricing.remainingBalance<=0&&s.jsx("div",{className:"text-center mt-2",children:s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"✅ Fully Paid"})})]}),i.pricing.deposits.length>0&&s.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Deposit History:"}),s.jsx("div",{className:"space-y-1",children:i.pricing.deposits.map((h,C)=>s.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[s.jsxs("span",{children:["Deposit #",C+1," (",h.method.replace("_"," "),")",h.notes&&` - ${h.notes}`]}),s.jsxs("span",{className:"font-medium",children:["$",h.amount.toFixed(2)]})]},h.id))})]})]})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Email Actions"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>ee(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[s.jsx(ea,{className:"h-4 w-4"}),"Send Schedule"]}),s.jsxs("button",{type:"button",onClick:()=>ie(),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:[s.jsx(Lt,{className:"h-4 w-4"}),"Send PDF Invoice"]})]})]})]}),f==="invoice"&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Invoice Preview"}),i.pricing.deposits.length>0&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Shows deposits and payment information"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>ie(),className:"flex items-center gap-2 px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm",children:[s.jsx(Cn,{className:"h-4 w-4"}),"Print"]}),s.jsxs("button",{type:"button",onClick:()=>ie(),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors text-sm",children:[s.jsx(Lt,{className:"h-4 w-4"}),"Download PDF"]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-start mb-6",children:[s.jsxs("div",{className:"flex flex-col items-start",children:[s.jsx("img",{src:d.logo&&d.logo.startsWith("data:")?d.logo:"/assets/default-logo.png",alt:"Logo",className:"w-20 h-20 object-contain mb-3"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-bold text-gray-900 text-lg",children:d.storeName}),d.storeAddress&&s.jsx("p",{className:"text-sm text-gray-600",children:d.storeAddress}),d.storePhone&&s.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",d.storePhone]}),d.storeEmail&&s.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",d.storeEmail]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Invoice Date:"}),s.jsx("p",{className:"font-medium",children:new Date().toLocaleDateString()}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Event Date:"}),s.jsx("p",{className:"font-medium",children:new Date(i.date).toLocaleDateString()})]})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"INVOICE"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Event Management Services"})]}),s.jsxs("div",{className:"flex gap-8 mb-6",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Bill To:"}),s.jsxs("div",{className:"text-gray-700",children:[s.jsx("p",{className:"font-medium",children:i.contact.name}),s.jsx("p",{children:i.contact.email}),s.jsx("p",{children:i.contact.phone})]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Event Details:"}),s.jsxs("div",{className:"text-gray-700",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Event:"})," ",i.title]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Date:"})," ",new Date(i.date).toLocaleDateString()]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Time:"})," ",J(i.startTime)," - ",J(i.endTime)]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Venue:"})," ",(ae=l.find(h=>h.id===i.venueId))==null?void 0:ae.name]})]})]})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Services:"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50",children:[s.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Description"}),s.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Quantity"}),s.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Unit Price"}),s.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Total"})]})}),s.jsxs("tbody",{children:[i.pricing.personCount>0&&i.pricing.pricePerPerson>0&&s.jsxs("tr",{children:[s.jsx("td",{className:"border border-gray-300 px-4 py-2",children:"Guest Services"}),s.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:i.pricing.personCount}),s.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-right",children:["$",i.pricing.pricePerPerson.toFixed(2)]}),s.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-right",children:["$",(i.pricing.personCount*i.pricing.pricePerPerson).toFixed(2)]})]}),i.pricing.menuItems.map(h=>s.jsxs("tr",{children:[s.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[h.name,h.description&&s.jsxs("span",{className:"text-blue-900",children:[" (",h.description,")"]})]}),s.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:h.quantity}),s.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:h.price>0?`$${h.price.toFixed(2)}`:"N/A"}),s.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:h.price>0?`$${(h.price*h.quantity).toFixed(2)}`:"Included"})]},h.id))]})]})})]}),s.jsx("div",{className:"border-t border-gray-200 pt-4",children:s.jsxs("div",{className:"w-full max-w-sm ml-auto space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[s.jsx("span",{children:"Menu Items:"}),s.jsxs("span",{children:["$",i.pricing.menuItems.reduce((h,C)=>h+C.price*C.quantity,0).toFixed(2)]})]}),i.pricing.personCount>0&&i.pricing.pricePerPerson>0&&s.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[s.jsxs("span",{children:["Guest Services (",i.pricing.personCount," guests):"]}),s.jsxs("span",{children:["$",(i.pricing.personCount*i.pricing.pricePerPerson).toFixed(2)]})]}),s.jsx("div",{className:"border-t border-gray-300 pt-2",children:s.jsxs("div",{className:"flex justify-between font-medium",children:[s.jsx("span",{children:"Subtotal:"}),s.jsxs("span",{children:["$",i.pricing.subtotal.toFixed(2)]})]})}),i.pricing.discount.amount>0&&s.jsxs("div",{className:"flex justify-between text-red-600",children:[s.jsx("span",{children:"Discount:"}),s.jsxs("span",{children:["-$",i.pricing.discount.amount.toFixed(2)]})]}),i.pricing.includeTax&&s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["Tax (",(i.pricing.taxRate*100).toFixed(1),"%):"]}),s.jsxs("span",{children:["$",i.pricing.taxAmount.toFixed(2)]})]}),s.jsxs("div",{className:"border-t-2 border-gray-400 pt-3 flex justify-between text-xl font-bold",children:[s.jsx("span",{children:"Final Total:"}),s.jsxs("span",{className:"text-green-600",children:["$",i.pricing.total.toFixed(2)]})]}),i.pricing.deposits.length>0&&s.jsxs("div",{className:"border-t border-gray-300 pt-3 mt-3",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payment Information:"}),i.pricing.deposits.map((h,C)=>s.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[s.jsxs("span",{children:["Deposit #",C+1," (",h.method.replace("_"," "),"):"]}),s.jsxs("span",{className:"font-medium text-green-600",children:["$",h.amount.toFixed(2)]})]},h.id)),s.jsxs("div",{className:"border-t border-gray-200 pt-2 mt-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"font-medium",children:"Total Paid:"}),s.jsxs("span",{className:"font-medium text-green-600",children:["$",i.pricing.amountPaid.toFixed(2)]})]}),s.jsxs("div",{className:`flex justify-between text-lg font-bold mt-1 ${i.pricing.remainingBalance<=0?"text-green-600":"text-red-600"}`,children:[s.jsx("span",{children:"Balance Due:"}),s.jsxs("span",{children:["$",i.pricing.remainingBalance.toFixed(2)]})]}),i.pricing.remainingBalance<=0&&s.jsx("div",{className:"text-center mt-2",children:s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"✅ PAID IN FULL"})})]})]})]})}),s.jsxs("div",{className:"border-t border-gray-200 pt-4 text-center text-sm text-gray-600",children:[s.jsx("p",{children:"Thank you for your business!"}),s.jsx("p",{className:"mt-2",children:"Powered and Designed By Mike Akanan | (313) 938-6666"})]})]})]})}),s.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(Tn,{className:"h-4 w-4"}),y?"Update Event":"Create Event"]})]})]})]})}):null};var An="vercel.ai.error",Jc=Symbol.for(An),Pn,Wc=class Dn extends Error{constructor({name:t,message:a,cause:r}){super(a),this[Pn]=!0,this.name=t,this.cause=r}static isInstance(t){return Dn.hasMarker(t,An)}static hasMarker(t,a){const r=Symbol.for(a);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};Pn=Jc;var se=Wc,Rn="AI_APICallError",Mn=`vercel.ai.error.${Rn}`,Yc=Symbol.for(Mn),On,Be=class extends se{constructor({message:e,url:t,requestBodyValues:a,statusCode:r,responseHeaders:n,responseBody:o,cause:l,isRetryable:c=r!=null&&(r===408||r===409||r===429||r>=500),data:d}){super({name:Rn,message:e,cause:l}),this[On]=!0,this.url=t,this.requestBodyValues=a,this.statusCode=r,this.responseHeaders=n,this.responseBody=o,this.isRetryable=c,this.data=d}static isInstance(e){return se.hasMarker(e,Mn)}};On=Yc;var Ln="AI_EmptyResponseBodyError",Fn=`vercel.ai.error.${Ln}`,Kc=Symbol.for(Fn),Un,Qc=class extends se{constructor({message:e="Empty response body"}={}){super({name:Ln,message:e}),this[Un]=!0}static isInstance(e){return se.hasMarker(e,Fn)}};Un=Kc;function vs(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var Vn="AI_InvalidArgumentError",Bn=`vercel.ai.error.${Vn}`,Xc=Symbol.for(Bn),qn,Ya=class extends se{constructor({message:t,cause:a,argument:r}){super({name:Vn,message:t,cause:a}),this[qn]=!0,this.argument=r}static isInstance(t){return se.hasMarker(t,Bn)}};qn=Xc;var Zn="AI_InvalidPromptError",zn=`vercel.ai.error.${Zn}`,ed=Symbol.for(zn),Gn,it=class extends se{constructor({prompt:e,message:t,cause:a}){super({name:Zn,message:`Invalid prompt: ${t}`,cause:a}),this[Gn]=!0,this.prompt=e}static isInstance(e){return se.hasMarker(e,zn)}};Gn=ed;var Hn="AI_InvalidResponseDataError",Jn=`vercel.ai.error.${Hn}`,td=Symbol.for(Jn),Wn,ma=class extends se{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:Hn,message:t}),this[Wn]=!0,this.data=e}static isInstance(e){return se.hasMarker(e,Jn)}};Wn=td;var Yn="AI_JSONParseError",Kn=`vercel.ai.error.${Yn}`,sd=Symbol.for(Kn),Qn,Vt=class extends se{constructor({text:e,cause:t}){super({name:Yn,message:`JSON parsing failed: Text: ${e}.
Error message: ${vs(t)}`,cause:t}),this[Qn]=!0,this.text=e}static isInstance(e){return se.hasMarker(e,Kn)}};Qn=sd;var Xn="AI_LoadAPIKeyError",eo=`vercel.ai.error.${Xn}`,ad=Symbol.for(eo),to,Ts=class extends se{constructor({message:e}){super({name:Xn,message:e}),this[to]=!0}static isInstance(e){return se.hasMarker(e,eo)}};to=ad;var so="AI_TooManyEmbeddingValuesForCallError",ao=`vercel.ai.error.${so}`,rd=Symbol.for(ao),ro,nd=class extends se{constructor(e){super({name:so,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[ro]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return se.hasMarker(e,ao)}};ro=rd;var no="AI_TypeValidationError",oo=`vercel.ai.error.${no}`,od=Symbol.for(oo),io,id=class Ea extends se{constructor({value:t,cause:a}){super({name:no,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${vs(a)}`,cause:a}),this[io]=!0,this.value=t}static isInstance(t){return se.hasMarker(t,oo)}static wrap({value:t,cause:a}){return Ea.isInstance(a)&&a.value===t?a:new Ea({value:t,cause:a})}};io=od;var Bt=id,lo="AI_UnsupportedFunctionalityError",co=`vercel.ai.error.${lo}`,ld=Symbol.for(co),uo,Ce=class extends se{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:lo,message:t}),this[uo]=!0,this.functionality=e}static isInstance(e){return se.hasMarker(e,co)}};uo=ld;let mo=(e,t=21)=>(a=t)=>{let r="",n=a|0;for(;n--;)r+=e[Math.random()*e.length|0];return r};var zt={exports:{}};const cd=typeof Buffer<"u",Ur=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,Vr=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function po(e,t,a){a==null&&t!==null&&typeof t=="object"&&(a=t,t=void 0),cd&&Buffer.isBuffer(e)&&(e=e.toString()),e&&e.charCodeAt(0)===65279&&(e=e.slice(1));const r=JSON.parse(e,t);if(r===null||typeof r!="object")return r;const n=a&&a.protoAction||"error",o=a&&a.constructorAction||"error";if(n==="ignore"&&o==="ignore")return r;if(n!=="ignore"&&o!=="ignore"){if(Ur.test(e)===!1&&Vr.test(e)===!1)return r}else if(n!=="ignore"&&o==="ignore"){if(Ur.test(e)===!1)return r}else if(Vr.test(e)===!1)return r;return ho(r,{protoAction:n,constructorAction:o,safe:a&&a.safe})}function ho(e,{protoAction:t="error",constructorAction:a="error",safe:r}={}){let n=[e];for(;n.length;){const o=n;n=[];for(const l of o){if(t!=="ignore"&&Object.prototype.hasOwnProperty.call(l,"__proto__")){if(r===!0)return null;if(t==="error")throw new SyntaxError("Object contains forbidden prototype property");delete l.__proto__}if(a!=="ignore"&&Object.prototype.hasOwnProperty.call(l,"constructor")&&Object.prototype.hasOwnProperty.call(l.constructor,"prototype")){if(r===!0)return null;if(a==="error")throw new SyntaxError("Object contains forbidden prototype property");delete l.constructor}for(const c in l){const d=l[c];d&&typeof d=="object"&&n.push(d)}}}return e}function Ka(e,t,a){const r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return po(e,t,a)}finally{Error.stackTraceLimit=r}}function dd(e,t){const a=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return po(e,t,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=a}}zt.exports=Ka;zt.exports.default=Ka;zt.exports.parse=Ka;zt.exports.safeParse=dd;zt.exports.scan=ho;var ud=zt.exports;const ta=Hi(ud);function md(e){return new ReadableStream({async pull(t){try{const{value:a,done:r}=await e.next();r?t.close():t.enqueue(a)}catch(a){t.error(a)}},cancel(){}})}async function pd(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}var St=({prefix:e,size:t=16,alphabet:a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const n=mo(a,t);if(e==null)return n;if(a.includes(r))throw new Ya({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${a}".`});return o=>`${e}${r}${n(o)}`};St();function hd(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function fd(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}var $s=Symbol.for("vercel.ai.validator");function gd(e){return{[$s]:!0,validate:e}}function xd(e){return typeof e=="object"&&e!==null&&$s in e&&e[$s]===!0&&"validate"in e}function yd(e){return xd(e)?e:bd(e)}function bd(e){return gd(t=>{const a=e.safeParse(t);return a.success?{success:!0,value:a.data}:{success:!1,error:a.error}})}function sa({value:e,schema:t}){const a=yd(t);try{if(a.validate==null)return{success:!0,value:e};const r=a.validate(e);return r.success?r:{success:!1,error:Bt.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:Bt.wrap({value:e,cause:r})}}}function As({text:e,schema:t}){try{const a=ta.parse(e);if(t==null)return{success:!0,value:a,rawValue:a};const r=sa({value:a,schema:t});return r.success?{...r,rawValue:a}:r}catch(a){return{success:!1,error:Vt.isInstance(a)?a:new Vt({text:e,cause:a})}}}var{btoa:vd,atob:jd}=globalThis;function Qa(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),a=jd(t);return Uint8Array.from(a,r=>r.codePointAt(0))}function Ia(e){let t="";for(let a=0;a<e.length;a++)t+=String.fromCodePoint(e[a]);return vd(t)}const wd=Symbol("Let zodToJsonSchema decide on which parser to use"),Br={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Nd=e=>typeof e=="string"?{...Br,name:e}:{...Br,...e},_d=e=>{const t=Nd(e),a=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:a,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,n])=>[n._def,{def:n._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function fo(e,t,a,r){r!=null&&r.errorMessages&&a&&(e.errorMessage={...e.errorMessage,[t]:a})}function he(e,t,a,r,n){e[t]=a,fo(e,t,r,n)}const go=(e,t)=>{let a=0;for(;a<e.length&&a<t.length&&e[a]===t[a];a++);return[(e.length-a).toString(),...t.slice(a)].join("/")};var ue;(function(e){e.assertEqual=n=>{};function t(n){}e.assertIs=t;function a(n){throw new Error}e.assertNever=a,e.arrayToEnum=n=>{const o={};for(const l of n)o[l]=l;return o},e.getValidEnumValues=n=>{const o=e.objectKeys(n).filter(c=>typeof n[n[c]]!="number"),l={};for(const c of o)l[c]=n[c];return e.objectValues(l)},e.objectValues=n=>e.objectKeys(n).map(function(o){return n[o]}),e.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const o=[];for(const l in n)Object.prototype.hasOwnProperty.call(n,l)&&o.push(l);return o},e.find=(n,o)=>{for(const l of n)if(o(l))return l},e.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function r(n,o=" | "){return n.map(l=>typeof l=="string"?`'${l}'`:l).join(o)}e.joinValues=r,e.jsonStringifyReplacer=(n,o)=>typeof o=="bigint"?o.toString():o})(ue||(ue={}));var qr;(function(e){e.mergeShapes=(t,a)=>({...t,...a})})(qr||(qr={}));const Z=ue.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ft=e=>{switch(typeof e){case"undefined":return Z.undefined;case"string":return Z.string;case"number":return Number.isNaN(e)?Z.nan:Z.number;case"boolean":return Z.boolean;case"function":return Z.function;case"bigint":return Z.bigint;case"symbol":return Z.symbol;case"object":return Array.isArray(e)?Z.array:e===null?Z.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Z.promise:typeof Map<"u"&&e instanceof Map?Z.map:typeof Set<"u"&&e instanceof Set?Z.set:typeof Date<"u"&&e instanceof Date?Z.date:Z.object;default:return Z.unknown}},A=ue.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class dt extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=t}format(t){const a=t||function(o){return o.message},r={_errors:[]},n=o=>{for(const l of o.issues)if(l.code==="invalid_union")l.unionErrors.map(n);else if(l.code==="invalid_return_type")n(l.returnTypeError);else if(l.code==="invalid_arguments")n(l.argumentsError);else if(l.path.length===0)r._errors.push(a(l));else{let c=r,d=0;for(;d<l.path.length;){const i=l.path[d];d===l.path.length-1?(c[i]=c[i]||{_errors:[]},c[i]._errors.push(a(l))):c[i]=c[i]||{_errors:[]},c=c[i],d++}}};return n(this),r}static assert(t){if(!(t instanceof dt))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ue.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=a=>a.message){const a={},r=[];for(const n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(t(n))):r.push(t(n));return{formErrors:r,fieldErrors:a}}get formErrors(){return this.flatten()}}dt.create=e=>new dt(e);const $a=(e,t)=>{let a;switch(e.code){case A.invalid_type:e.received===Z.undefined?a="Required":a=`Expected ${e.expected}, received ${e.received}`;break;case A.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(e.expected,ue.jsonStringifyReplacer)}`;break;case A.unrecognized_keys:a=`Unrecognized key(s) in object: ${ue.joinValues(e.keys,", ")}`;break;case A.invalid_union:a="Invalid input";break;case A.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${ue.joinValues(e.options)}`;break;case A.invalid_enum_value:a=`Invalid enum value. Expected ${ue.joinValues(e.options)}, received '${e.received}'`;break;case A.invalid_arguments:a="Invalid function arguments";break;case A.invalid_return_type:a="Invalid function return type";break;case A.invalid_date:a="Invalid date";break;case A.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(a=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?a=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?a=`Invalid input: must end with "${e.validation.endsWith}"`:ue.assertNever(e.validation):e.validation!=="regex"?a=`Invalid ${e.validation}`:a="Invalid";break;case A.too_small:e.type==="array"?a=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?a=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?a=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?a=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:a="Invalid input";break;case A.too_big:e.type==="array"?a=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?a=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?a=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?a=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?a=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:a="Invalid input";break;case A.custom:a="Invalid input";break;case A.invalid_intersection_types:a="Intersection results could not be merged";break;case A.not_multiple_of:a=`Number must be a multiple of ${e.multipleOf}`;break;case A.not_finite:a="Number must be finite";break;default:a=t.defaultError,ue.assertNever(e)}return{message:a}};let kd=$a;function Sd(){return kd}const Cd=e=>{const{data:t,path:a,errorMaps:r,issueData:n}=e,o=[...a,...n.path||[]],l={...n,path:o};if(n.message!==void 0)return{...n,path:o,message:n.message};let c="";const d=r.filter(i=>!!i).slice().reverse();for(const i of d)c=i(l,{data:t,defaultError:c}).message;return{...n,path:o,message:c}};function U(e,t){const a=Sd(),r=Cd({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,a,a===$a?void 0:$a].filter(n=>!!n)});e.common.issues.push(r)}class Re{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,a){const r=[];for(const n of a){if(n.status==="aborted")return Q;n.status==="dirty"&&t.dirty(),r.push(n.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,a){const r=[];for(const n of a){const o=await n.key,l=await n.value;r.push({key:o,value:l})}return Re.mergeObjectSync(t,r)}static mergeObjectSync(t,a){const r={};for(const n of a){const{key:o,value:l}=n;if(o.status==="aborted"||l.status==="aborted")return Q;o.status==="dirty"&&t.dirty(),l.status==="dirty"&&t.dirty(),o.value!=="__proto__"&&(typeof l.value<"u"||n.alwaysSet)&&(r[o.value]=l.value)}return{status:t.value,value:r}}}const Q=Object.freeze({status:"aborted"}),ss=e=>({status:"dirty",value:e}),qe=e=>({status:"valid",value:e}),Zr=e=>e.status==="aborted",zr=e=>e.status==="dirty",qt=e=>e.status==="valid",Ps=e=>typeof Promise<"u"&&e instanceof Promise;var H;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(H||(H={}));class et{constructor(t,a,r,n){this._cachedPath=[],this.parent=t,this.data=a,this._path=r,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Gr=(e,t)=>{if(qt(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const a=new dt(e.common.issues);return this._error=a,this._error}}};function ne(e){if(!e)return{};const{errorMap:t,invalid_type_error:a,required_error:r,description:n}=e;if(t&&(a||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(l,c)=>{const{message:d}=e;return l.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:d??a??c.defaultError}},description:n}}class ce{get description(){return this._def.description}_getType(t){return ft(t.data)}_getOrReturnCtx(t,a){return a||{common:t.parent.common,data:t.data,parsedType:ft(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Re,ctx:{common:t.parent.common,data:t.data,parsedType:ft(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const a=this._parse(t);if(Ps(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(t){const a=this._parse(t);return Promise.resolve(a)}parse(t,a){const r=this.safeParse(t,a);if(r.success)return r.data;throw r.error}safeParse(t,a){const r={common:{issues:[],async:(a==null?void 0:a.async)??!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ft(t)},n=this._parseSync({data:t,path:r.path,parent:r});return Gr(r,n)}"~validate"(t){var r,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ft(t)};if(!this["~standard"].async)try{const o=this._parseSync({data:t,path:[],parent:a});return qt(o)?{value:o.value}:{issues:a.common.issues}}catch(o){(n=(r=o==null?void 0:o.message)==null?void 0:r.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(o=>qt(o)?{value:o.value}:{issues:a.common.issues})}async parseAsync(t,a){const r=await this.safeParseAsync(t,a);if(r.success)return r.data;throw r.error}async safeParseAsync(t,a){const r={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ft(t)},n=this._parse({data:t,path:r.path,parent:r}),o=await(Ps(n)?n:Promise.resolve(n));return Gr(r,o)}refine(t,a){const r=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,o)=>{const l=t(n),c=()=>o.addIssue({code:A.custom,...r(n)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(t,a){return this._refinement((r,n)=>t(r)?!0:(n.addIssue(typeof a=="function"?a(r,n):a),!1))}_refinement(t){return new _t({schema:this,typeName:D.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return ct.create(this,this._def)}nullable(){return kt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Xe.create(this)}promise(){return Vs.create(this,this._def)}or(t){return Ms.create([this,t],this._def)}and(t){return Os.create(this,t,this._def)}transform(t){return new _t({...ne(this._def),schema:this,typeName:D.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const a=typeof t=="function"?t:()=>t;return new Bs({...ne(this._def),innerType:this,defaultValue:a,typeName:D.ZodDefault})}brand(){return new vo({typeName:D.ZodBranded,type:this,...ne(this._def)})}catch(t){const a=typeof t=="function"?t:()=>t;return new qs({...ne(this._def),innerType:this,catchValue:a,typeName:D.ZodCatch})}describe(t){const a=this.constructor;return new a({...this._def,description:t})}pipe(t){return er.create(this,t)}readonly(){return Zs.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Td=/^c[^\s-]{8,}$/i,Ed=/^[0-9a-z]+$/,Id=/^[0-9A-HJKMNP-TV-Z]{26}$/i,$d=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ad=/^[a-z0-9_-]{21}$/i,Pd=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Dd=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Rd=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Md="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let pa;const Od=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ld=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Fd=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ud=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Vd=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Bd=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,xo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",qd=new RegExp(`^${xo}$`);function yo(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const a=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${a}`}function Zd(e){return new RegExp(`^${yo(e)}$`)}function zd(e){let t=`${xo}T${yo(e)}`;const a=[];return a.push(e.local?"Z?":"Z"),e.offset&&a.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${a.join("|")})`,new RegExp(`^${t}$`)}function Gd(e,t){return!!((t==="v4"||!t)&&Od.test(e)||(t==="v6"||!t)&&Fd.test(e))}function Hd(e,t){if(!Pd.test(e))return!1;try{const[a]=e.split("."),r=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),n=JSON.parse(atob(r));return!(typeof n!="object"||n===null||"typ"in n&&(n==null?void 0:n.typ)!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function Jd(e,t){return!!((t==="v4"||!t)&&Ld.test(e)||(t==="v6"||!t)&&Ud.test(e))}class lt extends ce{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Z.string){const o=this._getOrReturnCtx(t);return U(o,{code:A.invalid_type,expected:Z.string,received:o.parsedType}),Q}const r=new Re;let n;for(const o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(n=this._getOrReturnCtx(t,n),U(n,{code:A.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="max")t.data.length>o.value&&(n=this._getOrReturnCtx(t,n),U(n,{code:A.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="length"){const l=t.data.length>o.value,c=t.data.length<o.value;(l||c)&&(n=this._getOrReturnCtx(t,n),l?U(n,{code:A.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&U(n,{code:A.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if(o.kind==="email")Rd.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"email",code:A.invalid_string,message:o.message}),r.dirty());else if(o.kind==="emoji")pa||(pa=new RegExp(Md,"u")),pa.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"emoji",code:A.invalid_string,message:o.message}),r.dirty());else if(o.kind==="uuid")$d.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"uuid",code:A.invalid_string,message:o.message}),r.dirty());else if(o.kind==="nanoid")Ad.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"nanoid",code:A.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid")Td.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"cuid",code:A.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid2")Ed.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"cuid2",code:A.invalid_string,message:o.message}),r.dirty());else if(o.kind==="ulid")Id.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"ulid",code:A.invalid_string,message:o.message}),r.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),U(n,{validation:"url",code:A.invalid_string,message:o.message}),r.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"regex",code:A.invalid_string,message:o.message}),r.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(n=this._getOrReturnCtx(t,n),U(n,{code:A.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(n=this._getOrReturnCtx(t,n),U(n,{code:A.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(n=this._getOrReturnCtx(t,n),U(n,{code:A.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):o.kind==="datetime"?zd(o).test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{code:A.invalid_string,validation:"datetime",message:o.message}),r.dirty()):o.kind==="date"?qd.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{code:A.invalid_string,validation:"date",message:o.message}),r.dirty()):o.kind==="time"?Zd(o).test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{code:A.invalid_string,validation:"time",message:o.message}),r.dirty()):o.kind==="duration"?Dd.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"duration",code:A.invalid_string,message:o.message}),r.dirty()):o.kind==="ip"?Gd(t.data,o.version)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"ip",code:A.invalid_string,message:o.message}),r.dirty()):o.kind==="jwt"?Hd(t.data,o.alg)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"jwt",code:A.invalid_string,message:o.message}),r.dirty()):o.kind==="cidr"?Jd(t.data,o.version)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"cidr",code:A.invalid_string,message:o.message}),r.dirty()):o.kind==="base64"?Vd.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"base64",code:A.invalid_string,message:o.message}),r.dirty()):o.kind==="base64url"?Bd.test(t.data)||(n=this._getOrReturnCtx(t,n),U(n,{validation:"base64url",code:A.invalid_string,message:o.message}),r.dirty()):ue.assertNever(o);return{status:r.value,value:t.data}}_regex(t,a,r){return this.refinement(n=>t.test(n),{validation:a,code:A.invalid_string,...H.errToObj(r)})}_addCheck(t){return new lt({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...H.errToObj(t)})}url(t){return this._addCheck({kind:"url",...H.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...H.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...H.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...H.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...H.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...H.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...H.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...H.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...H.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...H.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...H.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...H.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...H.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...H.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...H.errToObj(t)})}regex(t,a){return this._addCheck({kind:"regex",regex:t,...H.errToObj(a)})}includes(t,a){return this._addCheck({kind:"includes",value:t,position:a==null?void 0:a.position,...H.errToObj(a==null?void 0:a.message)})}startsWith(t,a){return this._addCheck({kind:"startsWith",value:t,...H.errToObj(a)})}endsWith(t,a){return this._addCheck({kind:"endsWith",value:t,...H.errToObj(a)})}min(t,a){return this._addCheck({kind:"min",value:t,...H.errToObj(a)})}max(t,a){return this._addCheck({kind:"max",value:t,...H.errToObj(a)})}length(t,a){return this._addCheck({kind:"length",value:t,...H.errToObj(a)})}nonempty(t){return this.min(1,H.errToObj(t))}trim(){return new lt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new lt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new lt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t}get maxLength(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t}}lt.create=e=>new lt({checks:[],typeName:D.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...ne(e)});function Wd(e,t){const a=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,n=a>r?a:r,o=Number.parseInt(e.toFixed(n).replace(".","")),l=Number.parseInt(t.toFixed(n).replace(".",""));return o%l/10**n}class Zt extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Z.number){const o=this._getOrReturnCtx(t);return U(o,{code:A.invalid_type,expected:Z.number,received:o.parsedType}),Q}let r;const n=new Re;for(const o of this._def.checks)o.kind==="int"?ue.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),U(r,{code:A.invalid_type,expected:"integer",received:"float",message:o.message}),n.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),U(r,{code:A.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),n.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),U(r,{code:A.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),n.dirty()):o.kind==="multipleOf"?Wd(t.data,o.value)!==0&&(r=this._getOrReturnCtx(t,r),U(r,{code:A.not_multiple_of,multipleOf:o.value,message:o.message}),n.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),U(r,{code:A.not_finite,message:o.message}),n.dirty()):ue.assertNever(o);return{status:n.value,value:t.data}}gte(t,a){return this.setLimit("min",t,!0,H.toString(a))}gt(t,a){return this.setLimit("min",t,!1,H.toString(a))}lte(t,a){return this.setLimit("max",t,!0,H.toString(a))}lt(t,a){return this.setLimit("max",t,!1,H.toString(a))}setLimit(t,a,r,n){return new Zt({...this._def,checks:[...this._def.checks,{kind:t,value:a,inclusive:r,message:H.toString(n)}]})}_addCheck(t){return new Zt({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:H.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:H.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:H.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:H.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:H.toString(t)})}multipleOf(t,a){return this._addCheck({kind:"multipleOf",value:t,message:H.toString(a)})}finite(t){return this._addCheck({kind:"finite",message:H.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:H.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:H.toString(t)})}get minValue(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t}get maxValue(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ue.isInteger(t.value))}get isFinite(){let t=null,a=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(a===null||r.value>a)&&(a=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(a)&&Number.isFinite(t)}}Zt.create=e=>new Zt({checks:[],typeName:D.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...ne(e)});class is extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Z.bigint)return this._getInvalidInput(t);let r;const n=new Re;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),U(r,{code:A.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),U(r,{code:A.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),U(r,{code:A.not_multiple_of,multipleOf:o.value,message:o.message}),n.dirty()):ue.assertNever(o);return{status:n.value,value:t.data}}_getInvalidInput(t){const a=this._getOrReturnCtx(t);return U(a,{code:A.invalid_type,expected:Z.bigint,received:a.parsedType}),Q}gte(t,a){return this.setLimit("min",t,!0,H.toString(a))}gt(t,a){return this.setLimit("min",t,!1,H.toString(a))}lte(t,a){return this.setLimit("max",t,!0,H.toString(a))}lt(t,a){return this.setLimit("max",t,!1,H.toString(a))}setLimit(t,a,r,n){return new is({...this._def,checks:[...this._def.checks,{kind:t,value:a,inclusive:r,message:H.toString(n)}]})}_addCheck(t){return new is({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:H.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:H.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:H.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:H.toString(t)})}multipleOf(t,a){return this._addCheck({kind:"multipleOf",value:t,message:H.toString(a)})}get minValue(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t}get maxValue(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t}}is.create=e=>new is({checks:[],typeName:D.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...ne(e)});class Aa extends ce{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Z.boolean){const r=this._getOrReturnCtx(t);return U(r,{code:A.invalid_type,expected:Z.boolean,received:r.parsedType}),Q}return qe(t.data)}}Aa.create=e=>new Aa({typeName:D.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...ne(e)});class Ds extends ce{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Z.date){const o=this._getOrReturnCtx(t);return U(o,{code:A.invalid_type,expected:Z.date,received:o.parsedType}),Q}if(Number.isNaN(t.data.getTime())){const o=this._getOrReturnCtx(t);return U(o,{code:A.invalid_date}),Q}const r=new Re;let n;for(const o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(n=this._getOrReturnCtx(t,n),U(n,{code:A.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),r.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(n=this._getOrReturnCtx(t,n),U(n,{code:A.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),r.dirty()):ue.assertNever(o);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Ds({...this._def,checks:[...this._def.checks,t]})}min(t,a){return this._addCheck({kind:"min",value:t.getTime(),message:H.toString(a)})}max(t,a){return this._addCheck({kind:"max",value:t.getTime(),message:H.toString(a)})}get minDate(){let t=null;for(const a of this._def.checks)a.kind==="min"&&(t===null||a.value>t)&&(t=a.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const a of this._def.checks)a.kind==="max"&&(t===null||a.value<t)&&(t=a.value);return t!=null?new Date(t):null}}Ds.create=e=>new Ds({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:D.ZodDate,...ne(e)});class Hr extends ce{_parse(t){if(this._getType(t)!==Z.symbol){const r=this._getOrReturnCtx(t);return U(r,{code:A.invalid_type,expected:Z.symbol,received:r.parsedType}),Q}return qe(t.data)}}Hr.create=e=>new Hr({typeName:D.ZodSymbol,...ne(e)});class Pa extends ce{_parse(t){if(this._getType(t)!==Z.undefined){const r=this._getOrReturnCtx(t);return U(r,{code:A.invalid_type,expected:Z.undefined,received:r.parsedType}),Q}return qe(t.data)}}Pa.create=e=>new Pa({typeName:D.ZodUndefined,...ne(e)});class Rs extends ce{_parse(t){if(this._getType(t)!==Z.null){const r=this._getOrReturnCtx(t);return U(r,{code:A.invalid_type,expected:Z.null,received:r.parsedType}),Q}return qe(t.data)}}Rs.create=e=>new Rs({typeName:D.ZodNull,...ne(e)});class ls extends ce{constructor(){super(...arguments),this._any=!0}_parse(t){return qe(t.data)}}ls.create=e=>new ls({typeName:D.ZodAny,...ne(e)});class Da extends ce{constructor(){super(...arguments),this._unknown=!0}_parse(t){return qe(t.data)}}Da.create=e=>new Da({typeName:D.ZodUnknown,...ne(e)});class xt extends ce{_parse(t){const a=this._getOrReturnCtx(t);return U(a,{code:A.invalid_type,expected:Z.never,received:a.parsedType}),Q}}xt.create=e=>new xt({typeName:D.ZodNever,...ne(e)});class Jr extends ce{_parse(t){if(this._getType(t)!==Z.undefined){const r=this._getOrReturnCtx(t);return U(r,{code:A.invalid_type,expected:Z.void,received:r.parsedType}),Q}return qe(t.data)}}Jr.create=e=>new Jr({typeName:D.ZodVoid,...ne(e)});class Xe extends ce{_parse(t){const{ctx:a,status:r}=this._processInputParams(t),n=this._def;if(a.parsedType!==Z.array)return U(a,{code:A.invalid_type,expected:Z.array,received:a.parsedType}),Q;if(n.exactLength!==null){const l=a.data.length>n.exactLength.value,c=a.data.length<n.exactLength.value;(l||c)&&(U(a,{code:l?A.too_big:A.too_small,minimum:c?n.exactLength.value:void 0,maximum:l?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(U(a,{code:A.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(U(a,{code:A.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),a.common.async)return Promise.all([...a.data].map((l,c)=>n.type._parseAsync(new et(a,l,a.path,c)))).then(l=>Re.mergeArray(r,l));const o=[...a.data].map((l,c)=>n.type._parseSync(new et(a,l,a.path,c)));return Re.mergeArray(r,o)}get element(){return this._def.type}min(t,a){return new Xe({...this._def,minLength:{value:t,message:H.toString(a)}})}max(t,a){return new Xe({...this._def,maxLength:{value:t,message:H.toString(a)}})}length(t,a){return new Xe({...this._def,exactLength:{value:t,message:H.toString(a)}})}nonempty(t){return this.min(1,t)}}Xe.create=(e,t)=>new Xe({type:e,minLength:null,maxLength:null,exactLength:null,typeName:D.ZodArray,...ne(t)});function Rt(e){if(e instanceof we){const t={};for(const a in e.shape){const r=e.shape[a];t[a]=ct.create(Rt(r))}return new we({...e._def,shape:()=>t})}else return e instanceof Xe?new Xe({...e._def,type:Rt(e.element)}):e instanceof ct?ct.create(Rt(e.unwrap())):e instanceof kt?kt.create(Rt(e.unwrap())):e instanceof wt?wt.create(e.items.map(t=>Rt(t))):e}class we extends ce{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),a=ue.objectKeys(t);return this._cached={shape:t,keys:a},this._cached}_parse(t){if(this._getType(t)!==Z.object){const i=this._getOrReturnCtx(t);return U(i,{code:A.invalid_type,expected:Z.object,received:i.parsedType}),Q}const{status:r,ctx:n}=this._processInputParams(t),{shape:o,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof xt&&this._def.unknownKeys==="strip"))for(const i in n.data)l.includes(i)||c.push(i);const d=[];for(const i of l){const u=o[i],m=n.data[i];d.push({key:{status:"valid",value:i},value:u._parse(new et(n,m,n.path,i)),alwaysSet:i in n.data})}if(this._def.catchall instanceof xt){const i=this._def.unknownKeys;if(i==="passthrough")for(const u of c)d.push({key:{status:"valid",value:u},value:{status:"valid",value:n.data[u]}});else if(i==="strict")c.length>0&&(U(n,{code:A.unrecognized_keys,keys:c}),r.dirty());else if(i!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const i=this._def.catchall;for(const u of c){const m=n.data[u];d.push({key:{status:"valid",value:u},value:i._parse(new et(n,m,n.path,u)),alwaysSet:u in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const i=[];for(const u of d){const m=await u.key,w=await u.value;i.push({key:m,value:w,alwaysSet:u.alwaysSet})}return i}).then(i=>Re.mergeObjectSync(r,i)):Re.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(t){return H.errToObj,new we({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(a,r)=>{var o,l;const n=((l=(o=this._def).errorMap)==null?void 0:l.call(o,a,r).message)??r.defaultError;return a.code==="unrecognized_keys"?{message:H.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new we({...this._def,unknownKeys:"strip"})}passthrough(){return new we({...this._def,unknownKeys:"passthrough"})}extend(t){return new we({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new we({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:D.ZodObject})}setKey(t,a){return this.augment({[t]:a})}catchall(t){return new we({...this._def,catchall:t})}pick(t){const a={};for(const r of ue.objectKeys(t))t[r]&&this.shape[r]&&(a[r]=this.shape[r]);return new we({...this._def,shape:()=>a})}omit(t){const a={};for(const r of ue.objectKeys(this.shape))t[r]||(a[r]=this.shape[r]);return new we({...this._def,shape:()=>a})}deepPartial(){return Rt(this)}partial(t){const a={};for(const r of ue.objectKeys(this.shape)){const n=this.shape[r];t&&!t[r]?a[r]=n:a[r]=n.optional()}return new we({...this._def,shape:()=>a})}required(t){const a={};for(const r of ue.objectKeys(this.shape))if(t&&!t[r])a[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof ct;)o=o._def.innerType;a[r]=o}return new we({...this._def,shape:()=>a})}keyof(){return bo(ue.objectKeys(this.shape))}}we.create=(e,t)=>new we({shape:()=>e,unknownKeys:"strip",catchall:xt.create(),typeName:D.ZodObject,...ne(t)});we.strictCreate=(e,t)=>new we({shape:()=>e,unknownKeys:"strict",catchall:xt.create(),typeName:D.ZodObject,...ne(t)});we.lazycreate=(e,t)=>new we({shape:e,unknownKeys:"strip",catchall:xt.create(),typeName:D.ZodObject,...ne(t)});class Ms extends ce{_parse(t){const{ctx:a}=this._processInputParams(t),r=this._def.options;function n(o){for(const c of o)if(c.result.status==="valid")return c.result;for(const c of o)if(c.result.status==="dirty")return a.common.issues.push(...c.ctx.common.issues),c.result;const l=o.map(c=>new dt(c.ctx.common.issues));return U(a,{code:A.invalid_union,unionErrors:l}),Q}if(a.common.async)return Promise.all(r.map(async o=>{const l={...a,common:{...a.common,issues:[]},parent:null};return{result:await o._parseAsync({data:a.data,path:a.path,parent:l}),ctx:l}})).then(n);{let o;const l=[];for(const d of r){const i={...a,common:{...a.common,issues:[]},parent:null},u=d._parseSync({data:a.data,path:a.path,parent:i});if(u.status==="valid")return u;u.status==="dirty"&&!o&&(o={result:u,ctx:i}),i.common.issues.length&&l.push(i.common.issues)}if(o)return a.common.issues.push(...o.ctx.common.issues),o.result;const c=l.map(d=>new dt(d));return U(a,{code:A.invalid_union,unionErrors:c}),Q}}get options(){return this._def.options}}Ms.create=(e,t)=>new Ms({options:e,typeName:D.ZodUnion,...ne(t)});const ot=e=>e instanceof Fs?ot(e.schema):e instanceof _t?ot(e.innerType()):e instanceof Us?[e.value]:e instanceof Nt?e.options:e instanceof Ma?ue.objectValues(e.enum):e instanceof Bs?ot(e._def.innerType):e instanceof Pa?[void 0]:e instanceof Rs?[null]:e instanceof ct?[void 0,...ot(e.unwrap())]:e instanceof kt?[null,...ot(e.unwrap())]:e instanceof vo||e instanceof Zs?ot(e.unwrap()):e instanceof qs?ot(e._def.innerType):[];class Xa extends ce{_parse(t){const{ctx:a}=this._processInputParams(t);if(a.parsedType!==Z.object)return U(a,{code:A.invalid_type,expected:Z.object,received:a.parsedType}),Q;const r=this.discriminator,n=a.data[r],o=this.optionsMap.get(n);return o?a.common.async?o._parseAsync({data:a.data,path:a.path,parent:a}):o._parseSync({data:a.data,path:a.path,parent:a}):(U(a,{code:A.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Q)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,a,r){const n=new Map;for(const o of a){const l=ot(o.shape[t]);if(!l.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const c of l){if(n.has(c))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(c)}`);n.set(c,o)}}return new Xa({typeName:D.ZodDiscriminatedUnion,discriminator:t,options:a,optionsMap:n,...ne(r)})}}function Ra(e,t){const a=ft(e),r=ft(t);if(e===t)return{valid:!0,data:e};if(a===Z.object&&r===Z.object){const n=ue.objectKeys(t),o=ue.objectKeys(e).filter(c=>n.indexOf(c)!==-1),l={...e,...t};for(const c of o){const d=Ra(e[c],t[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(a===Z.array&&r===Z.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let o=0;o<e.length;o++){const l=e[o],c=t[o],d=Ra(l,c);if(!d.valid)return{valid:!1};n.push(d.data)}return{valid:!0,data:n}}else return a===Z.date&&r===Z.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Os extends ce{_parse(t){const{status:a,ctx:r}=this._processInputParams(t),n=(o,l)=>{if(Zr(o)||Zr(l))return Q;const c=Ra(o.value,l.value);return c.valid?((zr(o)||zr(l))&&a.dirty(),{status:a.value,value:c.data}):(U(r,{code:A.invalid_intersection_types}),Q)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,l])=>n(o,l)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Os.create=(e,t,a)=>new Os({left:e,right:t,typeName:D.ZodIntersection,...ne(a)});class wt extends ce{_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.parsedType!==Z.array)return U(r,{code:A.invalid_type,expected:Z.array,received:r.parsedType}),Q;if(r.data.length<this._def.items.length)return U(r,{code:A.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Q;!this._def.rest&&r.data.length>this._def.items.length&&(U(r,{code:A.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());const o=[...r.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new et(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(o).then(l=>Re.mergeArray(a,l)):Re.mergeArray(a,o)}get items(){return this._def.items}rest(t){return new wt({...this._def,rest:t})}}wt.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new wt({items:e,typeName:D.ZodTuple,rest:null,...ne(t)})};class Ls extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.parsedType!==Z.object)return U(r,{code:A.invalid_type,expected:Z.object,received:r.parsedType}),Q;const n=[],o=this._def.keyType,l=this._def.valueType;for(const c in r.data)n.push({key:o._parse(new et(r,c,r.path,c)),value:l._parse(new et(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?Re.mergeObjectAsync(a,n):Re.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(t,a,r){return a instanceof ce?new Ls({keyType:t,valueType:a,typeName:D.ZodRecord,...ne(r)}):new Ls({keyType:lt.create(),valueType:t,typeName:D.ZodRecord,...ne(a)})}}class Wr extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.parsedType!==Z.map)return U(r,{code:A.invalid_type,expected:Z.map,received:r.parsedType}),Q;const n=this._def.keyType,o=this._def.valueType,l=[...r.data.entries()].map(([c,d],i)=>({key:n._parse(new et(r,c,r.path,[i,"key"])),value:o._parse(new et(r,d,r.path,[i,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const i=await d.key,u=await d.value;if(i.status==="aborted"||u.status==="aborted")return Q;(i.status==="dirty"||u.status==="dirty")&&a.dirty(),c.set(i.value,u.value)}return{status:a.value,value:c}})}else{const c=new Map;for(const d of l){const i=d.key,u=d.value;if(i.status==="aborted"||u.status==="aborted")return Q;(i.status==="dirty"||u.status==="dirty")&&a.dirty(),c.set(i.value,u.value)}return{status:a.value,value:c}}}}Wr.create=(e,t,a)=>new Wr({valueType:t,keyType:e,typeName:D.ZodMap,...ne(a)});class cs extends ce{_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.parsedType!==Z.set)return U(r,{code:A.invalid_type,expected:Z.set,received:r.parsedType}),Q;const n=this._def;n.minSize!==null&&r.data.size<n.minSize.value&&(U(r,{code:A.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&r.data.size>n.maxSize.value&&(U(r,{code:A.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());const o=this._def.valueType;function l(d){const i=new Set;for(const u of d){if(u.status==="aborted")return Q;u.status==="dirty"&&a.dirty(),i.add(u.value)}return{status:a.value,value:i}}const c=[...r.data.values()].map((d,i)=>o._parse(new et(r,d,r.path,i)));return r.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(t,a){return new cs({...this._def,minSize:{value:t,message:H.toString(a)}})}max(t,a){return new cs({...this._def,maxSize:{value:t,message:H.toString(a)}})}size(t,a){return this.min(t,a).max(t,a)}nonempty(t){return this.min(1,t)}}cs.create=(e,t)=>new cs({valueType:e,minSize:null,maxSize:null,typeName:D.ZodSet,...ne(t)});class Fs extends ce{get schema(){return this._def.getter()}_parse(t){const{ctx:a}=this._processInputParams(t);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}}Fs.create=(e,t)=>new Fs({getter:e,typeName:D.ZodLazy,...ne(t)});class Us extends ce{_parse(t){if(t.data!==this._def.value){const a=this._getOrReturnCtx(t);return U(a,{received:a.data,code:A.invalid_literal,expected:this._def.value}),Q}return{status:"valid",value:t.data}}get value(){return this._def.value}}Us.create=(e,t)=>new Us({value:e,typeName:D.ZodLiteral,...ne(t)});function bo(e,t){return new Nt({values:e,typeName:D.ZodEnum,...ne(t)})}class Nt extends ce{_parse(t){if(typeof t.data!="string"){const a=this._getOrReturnCtx(t),r=this._def.values;return U(a,{expected:ue.joinValues(r),received:a.parsedType,code:A.invalid_type}),Q}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const a=this._getOrReturnCtx(t),r=this._def.values;return U(a,{received:a.data,code:A.invalid_enum_value,options:r}),Q}return qe(t.data)}get options(){return this._def.values}get enum(){const t={};for(const a of this._def.values)t[a]=a;return t}get Values(){const t={};for(const a of this._def.values)t[a]=a;return t}get Enum(){const t={};for(const a of this._def.values)t[a]=a;return t}extract(t,a=this._def){return Nt.create(t,{...this._def,...a})}exclude(t,a=this._def){return Nt.create(this.options.filter(r=>!t.includes(r)),{...this._def,...a})}}Nt.create=bo;class Ma extends ce{_parse(t){const a=ue.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==Z.string&&r.parsedType!==Z.number){const n=ue.objectValues(a);return U(r,{expected:ue.joinValues(n),received:r.parsedType,code:A.invalid_type}),Q}if(this._cache||(this._cache=new Set(ue.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=ue.objectValues(a);return U(r,{received:r.data,code:A.invalid_enum_value,options:n}),Q}return qe(t.data)}get enum(){return this._def.values}}Ma.create=(e,t)=>new Ma({values:e,typeName:D.ZodNativeEnum,...ne(t)});class Vs extends ce{unwrap(){return this._def.type}_parse(t){const{ctx:a}=this._processInputParams(t);if(a.parsedType!==Z.promise&&a.common.async===!1)return U(a,{code:A.invalid_type,expected:Z.promise,received:a.parsedType}),Q;const r=a.parsedType===Z.promise?a.data:Promise.resolve(a.data);return qe(r.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}}Vs.create=(e,t)=>new Vs({type:e,typeName:D.ZodPromise,...ne(t)});class _t extends ce{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===D.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:a,ctx:r}=this._processInputParams(t),n=this._def.effect||null,o={addIssue:l=>{U(r,l),l.fatal?a.abort():a.dirty()},get path(){return r.path}};if(o.addIssue=o.addIssue.bind(o),n.type==="preprocess"){const l=n.transform(r.data,o);if(r.common.async)return Promise.resolve(l).then(async c=>{if(a.value==="aborted")return Q;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?Q:d.status==="dirty"||a.value==="dirty"?ss(d.value):d});{if(a.value==="aborted")return Q;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?Q:c.status==="dirty"||a.value==="dirty"?ss(c.value):c}}if(n.type==="refinement"){const l=c=>{const d=n.refinement(c,o);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Q:(c.status==="dirty"&&a.dirty(),l(c.value),{status:a.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?Q:(c.status==="dirty"&&a.dirty(),l(c.value).then(()=>({status:a.value,value:c.value}))))}if(n.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!qt(l))return Q;const c=n.transform(l.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>qt(l)?Promise.resolve(n.transform(l.value,o)).then(c=>({status:a.value,value:c})):Q);ue.assertNever(n)}}_t.create=(e,t,a)=>new _t({schema:e,typeName:D.ZodEffects,effect:t,...ne(a)});_t.createWithPreprocess=(e,t,a)=>new _t({schema:t,effect:{type:"preprocess",transform:e},typeName:D.ZodEffects,...ne(a)});class ct extends ce{_parse(t){return this._getType(t)===Z.undefined?qe(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ct.create=(e,t)=>new ct({innerType:e,typeName:D.ZodOptional,...ne(t)});class kt extends ce{_parse(t){return this._getType(t)===Z.null?qe(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}kt.create=(e,t)=>new kt({innerType:e,typeName:D.ZodNullable,...ne(t)});class Bs extends ce{_parse(t){const{ctx:a}=this._processInputParams(t);let r=a.data;return a.parsedType===Z.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:a.path,parent:a})}removeDefault(){return this._def.innerType}}Bs.create=(e,t)=>new Bs({innerType:e,typeName:D.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ne(t)});class qs extends ce{_parse(t){const{ctx:a}=this._processInputParams(t),r={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ps(n)?n.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new dt(r.common.issues)},input:r.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new dt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}qs.create=(e,t)=>new qs({innerType:e,typeName:D.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ne(t)});class Yr extends ce{_parse(t){if(this._getType(t)!==Z.nan){const r=this._getOrReturnCtx(t);return U(r,{code:A.invalid_type,expected:Z.nan,received:r.parsedType}),Q}return{status:"valid",value:t.data}}}Yr.create=e=>new Yr({typeName:D.ZodNaN,...ne(e)});class vo extends ce{_parse(t){const{ctx:a}=this._processInputParams(t),r=a.data;return this._def.type._parse({data:r,path:a.path,parent:a})}unwrap(){return this._def.type}}class er extends ce{_parse(t){const{status:a,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Q:o.status==="dirty"?(a.dirty(),ss(o.value)):this._def.out._parseAsync({data:o.value,path:r.path,parent:r})})();{const n=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?Q:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:r.path,parent:r})}}static create(t,a){return new er({in:t,out:a,typeName:D.ZodPipeline})}}class Zs extends ce{_parse(t){const a=this._def.innerType._parse(t),r=n=>(qt(n)&&(n.value=Object.freeze(n.value)),n);return Ps(a)?a.then(n=>r(n)):r(a)}unwrap(){return this._def.innerType}}Zs.create=(e,t)=>new Zs({innerType:e,typeName:D.ZodReadonly,...ne(t)});function Kr(e,t){const a=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof a=="string"?{message:a}:a}function jo(e,t={},a){return e?ls.create().superRefine((r,n)=>{const o=e(r);if(o instanceof Promise)return o.then(l=>{if(!l){const c=Kr(t,r),d=c.fatal??a??!0;n.addIssue({code:"custom",...c,fatal:d})}});if(!o){const l=Kr(t,r),c=l.fatal??a??!0;n.addIssue({code:"custom",...l,fatal:c})}}):ls.create()}var D;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(D||(D={}));const zs=(e,t={message:`Input not instance of ${e.name}`})=>jo(a=>a instanceof e,t),k=lt.create,W=Zt.create,Qe=Aa.create,Yd=Rs.create,wo=ls.create,aa=Da.create;xt.create;const de=Xe.create,S=we.create,Ne=Ms.create,tr=Xa.create;Os.create;wt.create;const ds=Ls.create,Kd=Fs.create,te=Us.create,sr=Nt.create;Vs.create;const _e=ct.create;kt.create;function Me(e){if(e.target!=="openAi")return{};const t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:e.$refStrategy==="relative"?go(t,e.currentPath):t.join("/")}}function Qd(e,t){var r,n,o;const a={type:"array"};return(r=e.type)!=null&&r._def&&((o=(n=e.type)==null?void 0:n._def)==null?void 0:o.typeName)!==D.ZodAny&&(a.items=pe(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&he(a,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&he(a,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(he(a,"minItems",e.exactLength.value,e.exactLength.message,t),he(a,"maxItems",e.exactLength.value,e.exactLength.message,t)),a}function Xd(e,t){const a={type:"integer",format:"int64"};if(!e.checks)return a;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?he(a,"minimum",r.value,r.message,t):he(a,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(a.exclusiveMinimum=!0),he(a,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?he(a,"maximum",r.value,r.message,t):he(a,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(a.exclusiveMaximum=!0),he(a,"maximum",r.value,r.message,t));break;case"multipleOf":he(a,"multipleOf",r.value,r.message,t);break}return a}function eu(){return{type:"boolean"}}function No(e,t){return pe(e.type._def,t)}const tu=(e,t)=>pe(e.innerType._def,t);function _o(e,t,a){const r=a??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((n,o)=>_o(e,t,n))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return su(e,t)}}const su=(e,t)=>{const a={type:"integer",format:"unix-time"};if(t.target==="openApi3")return a;for(const r of e.checks)switch(r.kind){case"min":he(a,"minimum",r.value,r.message,t);break;case"max":he(a,"maximum",r.value,r.message,t);break}return a};function au(e,t){return{...pe(e.innerType._def,t),default:e.defaultValue()}}function ru(e,t){return t.effectStrategy==="input"?pe(e.schema._def,t):Me(t)}function nu(e){return{type:"string",enum:Array.from(e.values)}}const ou=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function iu(e,t){const a=[pe(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),pe(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const n=[];return a.forEach(o=>{if(ou(o))n.push(...o.allOf),o.unevaluatedProperties===void 0&&(r=void 0);else{let l=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:c,...d}=o;l=d}else r=void 0;n.push(l)}}),n.length?{allOf:n,...r}:void 0}function lu(e,t){const a=typeof e.value;return a!=="bigint"&&a!=="number"&&a!=="boolean"&&a!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:a==="bigint"?"integer":a,enum:[e.value]}:{type:a==="bigint"?"integer":a,const:e.value}}let ha;const ze={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(ha===void 0&&(ha=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ha),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function ko(e,t){const a={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":he(a,"minLength",typeof a.minLength=="number"?Math.max(a.minLength,r.value):r.value,r.message,t);break;case"max":he(a,"maxLength",typeof a.maxLength=="number"?Math.min(a.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Ge(a,"email",r.message,t);break;case"format:idn-email":Ge(a,"idn-email",r.message,t);break;case"pattern:zod":De(a,ze.email,r.message,t);break}break;case"url":Ge(a,"uri",r.message,t);break;case"uuid":Ge(a,"uuid",r.message,t);break;case"regex":De(a,r.regex,r.message,t);break;case"cuid":De(a,ze.cuid,r.message,t);break;case"cuid2":De(a,ze.cuid2,r.message,t);break;case"startsWith":De(a,RegExp(`^${fa(r.value,t)}`),r.message,t);break;case"endsWith":De(a,RegExp(`${fa(r.value,t)}$`),r.message,t);break;case"datetime":Ge(a,"date-time",r.message,t);break;case"date":Ge(a,"date",r.message,t);break;case"time":Ge(a,"time",r.message,t);break;case"duration":Ge(a,"duration",r.message,t);break;case"length":he(a,"minLength",typeof a.minLength=="number"?Math.max(a.minLength,r.value):r.value,r.message,t),he(a,"maxLength",typeof a.maxLength=="number"?Math.min(a.maxLength,r.value):r.value,r.message,t);break;case"includes":{De(a,RegExp(fa(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&Ge(a,"ipv4",r.message,t),r.version!=="v4"&&Ge(a,"ipv6",r.message,t);break}case"base64url":De(a,ze.base64url,r.message,t);break;case"jwt":De(a,ze.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&De(a,ze.ipv4Cidr,r.message,t),r.version!=="v4"&&De(a,ze.ipv6Cidr,r.message,t);break}case"emoji":De(a,ze.emoji(),r.message,t);break;case"ulid":{De(a,ze.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Ge(a,"binary",r.message,t);break}case"contentEncoding:base64":{he(a,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{De(a,ze.base64,r.message,t);break}}break}case"nanoid":De(a,ze.nanoid,r.message,t)}return a}function fa(e,t){return t.patternStrategy==="escape"?du(e):e}const cu=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function du(e){let t="";for(let a=0;a<e.length;a++)cu.has(e[a])||(t+="\\"),t+=e[a];return t}function Ge(e,t,a,r){var n;e.format||(n=e.anyOf)!=null&&n.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...a&&r.errorMessages&&{errorMessage:{format:a}}})):he(e,"format",t,a,r)}function De(e,t,a,r){var n;e.pattern||(n=e.allOf)!=null&&n.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:Qr(t,r),...a&&r.errorMessages&&{errorMessage:{pattern:a}}})):he(e,"pattern",Qr(t,r),a,r)}function Qr(e,t){var d;if(!t.applyRegexFlags||!e.flags)return e.source;const a={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=a.i?e.source.toLowerCase():e.source;let n="",o=!1,l=!1,c=!1;for(let i=0;i<r.length;i++){if(o){n+=r[i],o=!1;continue}if(a.i){if(l){if(r[i].match(/[a-z]/)){c?(n+=r[i],n+=`${r[i-2]}-${r[i]}`.toUpperCase(),c=!1):r[i+1]==="-"&&((d=r[i+2])!=null&&d.match(/[a-z]/))?(n+=r[i],c=!0):n+=`${r[i]}${r[i].toUpperCase()}`;continue}}else if(r[i].match(/[a-z]/)){n+=`[${r[i]}${r[i].toUpperCase()}]`;continue}}if(a.m){if(r[i]==="^"){n+=`(^|(?<=[\r
]))`;continue}else if(r[i]==="$"){n+=`($|(?=[\r
]))`;continue}}if(a.s&&r[i]==="."){n+=l?`${r[i]}\r
`:`[${r[i]}\r
]`;continue}n+=r[i],r[i]==="\\"?o=!0:l&&r[i]==="]"?l=!1:!l&&r[i]==="["&&(l=!0)}try{new RegExp(n)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return n}function So(e,t){var r,n,o,l,c,d;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===D.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((i,u)=>({...i,[u]:pe(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??Me(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};const a={type:"object",additionalProperties:pe(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return a;if(((n=e.keyType)==null?void 0:n._def.typeName)===D.ZodString&&((o=e.keyType._def.checks)!=null&&o.length)){const{type:i,...u}=ko(e.keyType._def,t);return{...a,propertyNames:u}}else{if(((l=e.keyType)==null?void 0:l._def.typeName)===D.ZodEnum)return{...a,propertyNames:{enum:e.keyType._def.values}};if(((c=e.keyType)==null?void 0:c._def.typeName)===D.ZodBranded&&e.keyType._def.type._def.typeName===D.ZodString&&((d=e.keyType._def.type._def.checks)!=null&&d.length)){const{type:i,...u}=No(e.keyType._def,t);return{...a,propertyNames:u}}}return a}function uu(e,t){if(t.mapStrategy==="record")return So(e,t);const a=pe(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||Me(t),r=pe(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||Me(t);return{type:"array",maxItems:125,items:{type:"array",items:[a,r],minItems:2,maxItems:2}}}function mu(e){const t=e.values,r=Object.keys(e.values).filter(o=>typeof t[t[o]]!="number").map(o=>t[o]),n=Array.from(new Set(r.map(o=>typeof o)));return{type:n.length===1?n[0]==="string"?"string":"number":["string","number"],enum:r}}function pu(e){return e.target==="openAi"?void 0:{not:Me({...e,currentPath:[...e.currentPath,"not"]})}}function hu(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Gs={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function fu(e,t){if(t.target==="openApi3")return Xr(e,t);const a=e.options instanceof Map?Array.from(e.options.values()):e.options;if(a.every(r=>r._def.typeName in Gs&&(!r._def.checks||!r._def.checks.length))){const r=a.reduce((n,o)=>{const l=Gs[o._def.typeName];return l&&!n.includes(l)?[...n,l]:n},[]);return{type:r.length>1?r:r[0]}}else if(a.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=a.reduce((n,o)=>{const l=typeof o._def.value;switch(l){case"string":case"number":case"boolean":return[...n,l];case"bigint":return[...n,"integer"];case"object":if(o._def.value===null)return[...n,"null"];case"symbol":case"undefined":case"function":default:return n}},[]);if(r.length===a.length){const n=r.filter((o,l,c)=>c.indexOf(o)===l);return{type:n.length>1?n:n[0],enum:a.reduce((o,l)=>o.includes(l._def.value)?o:[...o,l._def.value],[])}}}else if(a.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:a.reduce((r,n)=>[...r,...n._def.values.filter(o=>!r.includes(o))],[])};return Xr(e,t)}const Xr=(e,t)=>{const a=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,n)=>pe(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${n}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return a.length?{anyOf:a}:void 0};function gu(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Gs[e.innerType._def.typeName],nullable:!0}:{type:[Gs[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=pe(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const a=pe(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return a&&{anyOf:[a,{type:"null"}]}}function xu(e,t){const a={type:"number"};if(!e.checks)return a;for(const r of e.checks)switch(r.kind){case"int":a.type="integer",fo(a,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?he(a,"minimum",r.value,r.message,t):he(a,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(a.exclusiveMinimum=!0),he(a,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?he(a,"maximum",r.value,r.message,t):he(a,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(a.exclusiveMaximum=!0),he(a,"maximum",r.value,r.message,t));break;case"multipleOf":he(a,"multipleOf",r.value,r.message,t);break}return a}function yu(e,t){const a=t.target==="openAi",r={type:"object",properties:{}},n=[],o=e.shape();for(const c in o){let d=o[c];if(d===void 0||d._def===void 0)continue;let i=vu(d);i&&a&&(d._def.typeName==="ZodOptional"&&(d=d._def.innerType),d.isNullable()||(d=d.nullable()),i=!1);const u=pe(d._def,{...t,currentPath:[...t.currentPath,"properties",c],propertyPath:[...t.currentPath,"properties",c]});u!==void 0&&(r.properties[c]=u,i||n.push(c))}n.length&&(r.required=n);const l=bu(e,t);return l!==void 0&&(r.additionalProperties=l),r}function bu(e,t){if(e.catchall._def.typeName!=="ZodNever")return pe(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function vu(e){try{return e.isOptional()}catch{return!0}}const ju=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return pe(e.innerType._def,t);const a=pe(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return a?{anyOf:[{not:Me(t)},a]}:Me(t)},wu=(e,t)=>{if(t.pipeStrategy==="input")return pe(e.in._def,t);if(t.pipeStrategy==="output")return pe(e.out._def,t);const a=pe(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=pe(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",a?"1":"0"]});return{allOf:[a,r].filter(n=>n!==void 0)}};function Nu(e,t){return pe(e.type._def,t)}function _u(e,t){const r={type:"array",uniqueItems:!0,items:pe(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&he(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&he(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function ku(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((a,r)=>pe(a._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((a,r)=>r===void 0?a:[...a,r],[]),additionalItems:pe(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((a,r)=>pe(a._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((a,r)=>r===void 0?a:[...a,r],[])}}function Su(e){return{not:Me(e)}}function Cu(e){return Me(e)}const Tu=(e,t)=>pe(e.innerType._def,t),Eu=(e,t,a)=>{switch(t){case D.ZodString:return ko(e,a);case D.ZodNumber:return xu(e,a);case D.ZodObject:return yu(e,a);case D.ZodBigInt:return Xd(e,a);case D.ZodBoolean:return eu();case D.ZodDate:return _o(e,a);case D.ZodUndefined:return Su(a);case D.ZodNull:return hu(a);case D.ZodArray:return Qd(e,a);case D.ZodUnion:case D.ZodDiscriminatedUnion:return fu(e,a);case D.ZodIntersection:return iu(e,a);case D.ZodTuple:return ku(e,a);case D.ZodRecord:return So(e,a);case D.ZodLiteral:return lu(e,a);case D.ZodEnum:return nu(e);case D.ZodNativeEnum:return mu(e);case D.ZodNullable:return gu(e,a);case D.ZodOptional:return ju(e,a);case D.ZodMap:return uu(e,a);case D.ZodSet:return _u(e,a);case D.ZodLazy:return()=>e.getter()._def;case D.ZodPromise:return Nu(e,a);case D.ZodNaN:case D.ZodNever:return pu(a);case D.ZodEffects:return ru(e,a);case D.ZodAny:return Me(a);case D.ZodUnknown:return Cu(a);case D.ZodDefault:return au(e,a);case D.ZodBranded:return No(e,a);case D.ZodReadonly:return Tu(e,a);case D.ZodCatch:return tu(e,a);case D.ZodPipeline:return wu(e,a);case D.ZodFunction:case D.ZodVoid:case D.ZodSymbol:return;default:return(r=>{})()}};function pe(e,t,a=!1){var c;const r=t.seen.get(e);if(t.override){const d=(c=t.override)==null?void 0:c.call(t,e,t,r,a);if(d!==wd)return d}if(r&&!a){const d=Iu(r,t);if(d!==void 0)return d}const n={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,n);const o=Eu(e,e.typeName,t),l=typeof o=="function"?pe(o(),t):o;if(l&&$u(e,t,l),t.postProcess){const d=t.postProcess(l,e,t);return n.jsonSchema=l,d}return n.jsonSchema=l,l}const Iu=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:go(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((a,r)=>t.currentPath[r]===a)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),Me(t)):t.$refStrategy==="seen"?Me(t):void 0}},$u=(e,t,a)=>(e.description&&(a.description=e.description,t.markdownDescription&&(a.markdownDescription=e.description)),a),Au=(e,t)=>{const a=_d(t);let r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((d,[i,u])=>({...d,[i]:pe(u._def,{...a,currentPath:[...a.basePath,a.definitionPath,i]},!0)??Me(a)}),{}):void 0;const n=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,o=pe(e._def,n===void 0?a:{...a,currentPath:[...a.basePath,a.definitionPath,n]},!1)??Me(a),l=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;l!==void 0&&(o.title=l),a.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[a.openAiAnyTypeName]||(r[a.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:a.$refStrategy==="relative"?"1":[...a.basePath,a.definitionPath,a.openAiAnyTypeName].join("/")}}));const c=n===void 0?r?{...o,[a.definitionPath]:r}:o:{$ref:[...a.$refStrategy==="relative"?[]:a.basePath,a.definitionPath,n].join("/"),[a.definitionPath]:{...r,[n]:o}};return a.target==="jsonSchema7"?c.$schema="http://json-schema.org/draft-07/schema#":(a.target==="jsonSchema2019-09"||a.target==="openAi")&&(c.$schema="https://json-schema.org/draft/2019-09/schema#"),a.target==="openAi"&&("anyOf"in c||"oneOf"in c||"allOf"in c||"type"in c&&Array.isArray(c.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),c};var us={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},ms={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},ps={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},hs={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},fs={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},Pu=[us,ms,ps,hs,fs];us.code+"",ms.code+"",ps.code+"",hs.code+"",fs.code+"";us.name+"",us.code,ms.name+"",ms.code,ps.name+"",ps.code,hs.name+"",hs.code,fs.name+"",fs.code;Pu.map(e=>e.code);function Du(e){const t=["ROOT"];let a=-1,r=null;function n(d,i,u){switch(d){case'"':{a=i,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{a=i,r=i,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{a=i,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{a=i,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{a=i,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(d,i){switch(d){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{a=i,t.pop();break}}}function l(d,i){switch(d){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{a=i,t.pop();break}}}for(let d=0;d<e.length;d++){const i=e[d];switch(t[t.length-1]){case"ROOT":n(i,d,"FINISH");break;case"INSIDE_OBJECT_START":{switch(i){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{a=d,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(i){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(i){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(i){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{n(i,d,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(i,d);break}case"INSIDE_STRING":{switch(i){case'"':{t.pop(),a=d;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:a=d}break}case"INSIDE_ARRAY_START":{switch(i){case"]":{a=d,t.pop();break}default:{a=d,n(i,d,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(i){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{a=d,t.pop();break}default:{a=d;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{n(i,d,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),a=d;break}case"INSIDE_NUMBER":{switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{a=d;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&l(i,d),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(i,d);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(i,d);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&l(i,d);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const m=e.substring(r,d+1);!"false".startsWith(m)&&!"true".startsWith(m)&&!"null".startsWith(m)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(i,d):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&l(i,d)):a=d;break}}}let c=e.slice(0,a+1);for(let d=t.length-1;d>=0;d--)switch(t[d]){case"INSIDE_STRING":{c+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{c+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{c+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?c+="true".slice(u.length):"false".startsWith(u)?c+="false".slice(u.length):"null".startsWith(u)&&(c+="null".slice(u.length))}}return c}function Ru(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=As({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=As({text:Du(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Mu={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Ou={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},Lu={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Fu={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},Uu={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},Vu={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},Bu={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},qu={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},Zu={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},zu={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},Gu={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},Hu={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},Ju={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},Wu={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},Yu={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},Ku={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},ra=[Mu,Ou,Lu,Fu,Uu,Vu,Bu,qu,Zu,zu,Gu,Hu,Ju,Wu,Yu,Ku];Object.fromEntries(ra.map(e=>[e.code,e]));Object.fromEntries(ra.map(e=>[e.name,e.code]));ra.map(e=>e.code);function Co(e,t){const a=ra.find(r=>r.name===e);if(!a)throw new Error(`Invalid stream part type: ${e}`);return`${a.code}:${JSON.stringify(t)}
`}function Qu(e,t){var a;const r=(a=void 0)!=null?a:!1;return Xu(Au(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:n=>{const o=e.safeParse(n);return o.success?{success:!0,value:o.data}:{success:!1,error:o.error}}})}var Oa=Symbol.for("vercel.ai.schema");function Xu(e,{validate:t}={}){return{[Oa]:!0,_type:void 0,[$s]:!0,jsonSchema:e,validate:t}}function em(e){return typeof e=="object"&&e!==null&&Oa in e&&e[Oa]===!0&&"jsonSchema"in e&&"validate"in e}function na(e){return em(e)?e:Qu(e)}var tm=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{},vt="1.9.0",en=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function sm(e){var t=new Set([e]),a=new Set,r=e.match(en);if(!r)return function(){return!1};var n={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(n.prerelease!=null)return function(d){return d===e};function o(c){return a.add(c),!1}function l(c){return t.add(c),!0}return function(d){if(t.has(d))return!0;if(a.has(d))return!1;var i=d.match(en);if(!i)return o(d);var u={major:+i[1],minor:+i[2],patch:+i[3],prerelease:i[4]};return u.prerelease!=null||n.major!==u.major?o(d):n.major===0?n.minor===u.minor&&n.patch<=u.patch?l(d):o(d):n.minor<=u.minor?l(d):o(d)}}var am=sm(vt),rm=vt.split(".")[0],gs=Symbol.for("opentelemetry.js.api."+rm),xs=tm;function ar(e,t,a,r){var n;r===void 0&&(r=!1);var o=xs[gs]=(n=xs[gs])!==null&&n!==void 0?n:{version:vt};if(!r&&o[e]){var l=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return a.error(l.stack||l.message),!1}if(o.version!==vt){var l=new Error("@opentelemetry/api: Registration of version v"+o.version+" for "+e+" does not match previously registered API v"+vt);return a.error(l.stack||l.message),!1}return o[e]=t,a.debug("@opentelemetry/api: Registered a global for "+e+" v"+vt+"."),!0}function ys(e){var t,a,r=(t=xs[gs])===null||t===void 0?void 0:t.version;if(!(!r||!am(r)))return(a=xs[gs])===null||a===void 0?void 0:a[e]}function rr(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+vt+".");var a=xs[gs];a&&delete a[e]}var nm=function(e,t){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var r=a.call(e),n,o=[],l;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(c){l={error:c}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(l)throw l.error}}return o},om=function(e,t,a){if(a||arguments.length===2)for(var r=0,n=t.length,o;r<n;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},im=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return es("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return es("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return es("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return es("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return es("verbose",this._namespace,t)},e}();function es(e,t,a){var r=ys("diag");if(r)return a.unshift(t),r[e].apply(r,om([],nm(a),!1))}var Le;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(Le||(Le={}));function lm(e,t){e<Le.NONE?e=Le.NONE:e>Le.ALL&&(e=Le.ALL),t=t||{};function a(r,n){var o=t[r];return typeof o=="function"&&e>=n?o.bind(t):function(){}}return{error:a("error",Le.ERROR),warn:a("warn",Le.WARN),info:a("info",Le.INFO),debug:a("debug",Le.DEBUG),verbose:a("verbose",Le.VERBOSE)}}var cm=function(e,t){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var r=a.call(e),n,o=[],l;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(c){l={error:c}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(l)throw l.error}}return o},dm=function(e,t,a){if(a||arguments.length===2)for(var r=0,n=t.length,o;r<n;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},um="diag",Hs=function(){function e(){function t(n){return function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];var c=ys("diag");if(c)return c[n].apply(c,dm([],cm(o),!1))}}var a=this,r=function(n,o){var l,c,d;if(o===void 0&&(o={logLevel:Le.INFO}),n===a){var i=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return a.error((l=i.stack)!==null&&l!==void 0?l:i.message),!1}typeof o=="number"&&(o={logLevel:o});var u=ys("diag"),m=lm((c=o.logLevel)!==null&&c!==void 0?c:Le.INFO,n);if(u&&!o.suppressOverrideMessage){var w=(d=new Error().stack)!==null&&d!==void 0?d:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+w),m.warn("Current logger will overwrite one already registered from "+w)}return ar("diag",m,a,!0)};a.setLogger=r,a.disable=function(){rr(um,a)},a.createComponentLogger=function(n){return new im(n)},a.verbose=t("verbose"),a.debug=t("debug"),a.info=t("info"),a.warn=t("warn"),a.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function mm(e){return Symbol.for(e)}var pm=function(){function e(t){var a=this;a._currentContext=t?new Map(t):new Map,a.getValue=function(r){return a._currentContext.get(r)},a.setValue=function(r,n){var o=new e(a._currentContext);return o._currentContext.set(r,n),o},a.deleteValue=function(r){var n=new e(a._currentContext);return n._currentContext.delete(r),n}}return e}(),hm=new pm,fm=function(e,t){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var r=a.call(e),n,o=[],l;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(c){l={error:c}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(l)throw l.error}}return o},gm=function(e,t,a){if(a||arguments.length===2)for(var r=0,n=t.length,o;r<n;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},xm=function(){function e(){}return e.prototype.active=function(){return hm},e.prototype.with=function(t,a,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];return a.call.apply(a,gm([r],fm(n),!1))},e.prototype.bind=function(t,a){return a},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),ym=function(e,t){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var r=a.call(e),n,o=[],l;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(c){l={error:c}}finally{try{n&&!n.done&&(a=r.return)&&a.call(r)}finally{if(l)throw l.error}}return o},bm=function(e,t,a){if(a||arguments.length===2)for(var r=0,n=t.length,o;r<n;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},ga="context",vm=new xm,To=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return ar(ga,t,Hs.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,a,r){for(var n,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];return(n=this._getContextManager()).with.apply(n,bm([t,a,r],ym(o),!1))},e.prototype.bind=function(t,a){return this._getContextManager().bind(t,a)},e.prototype._getContextManager=function(){return ys(ga)||vm},e.prototype.disable=function(){this._getContextManager().disable(),rr(ga,Hs.instance())},e}(),La;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(La||(La={}));var Eo="0000000000000000",Io="00000000000000000000000000000000",jm={traceId:Io,spanId:Eo,traceFlags:La.NONE},rs=function(){function e(t){t===void 0&&(t=jm),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,a){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,a){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,a){},e}(),nr=mm("OpenTelemetry Context Key SPAN");function or(e){return e.getValue(nr)||void 0}function wm(){return or(To.getInstance().active())}function ir(e,t){return e.setValue(nr,t)}function Nm(e){return e.deleteValue(nr)}function _m(e,t){return ir(e,new rs(t))}function $o(e){var t;return(t=or(e))===null||t===void 0?void 0:t.spanContext()}var km=/^([0-9a-f]{32})$/i,Sm=/^[0-9a-f]{16}$/i;function Cm(e){return km.test(e)&&e!==Io}function Tm(e){return Sm.test(e)&&e!==Eo}function Ao(e){return Cm(e.traceId)&&Tm(e.spanId)}function Em(e){return new rs(e)}var xa=To.getInstance(),Po=function(){function e(){}return e.prototype.startSpan=function(t,a,r){r===void 0&&(r=xa.active());var n=!!(a!=null&&a.root);if(n)return new rs;var o=r&&$o(r);return Im(o)&&Ao(o)?new rs(o):new rs},e.prototype.startActiveSpan=function(t,a,r,n){var o,l,c;if(!(arguments.length<2)){arguments.length===2?c=a:arguments.length===3?(o=a,c=r):(o=a,l=r,c=n);var d=l??xa.active(),i=this.startSpan(t,o,d),u=ir(d,i);return xa.with(u,c,void 0,i)}},e}();function Im(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var $m=new Po,Am=function(){function e(t,a,r,n){this._provider=t,this.name=a,this.version=r,this.options=n}return e.prototype.startSpan=function(t,a,r){return this._getTracer().startSpan(t,a,r)},e.prototype.startActiveSpan=function(t,a,r,n){var o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):$m},e}(),Pm=function(){function e(){}return e.prototype.getTracer=function(t,a,r){return new Po},e}(),Dm=new Pm,tn=function(){function e(){}return e.prototype.getTracer=function(t,a,r){var n;return(n=this.getDelegateTracer(t,a,r))!==null&&n!==void 0?n:new Am(this,t,a,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:Dm},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,a,r){var n;return(n=this._delegate)===null||n===void 0?void 0:n.getTracer(t,a,r)},e}(),Js;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(Js||(Js={}));var ya="trace",Rm=function(){function e(){this._proxyTracerProvider=new tn,this.wrapSpanContext=Em,this.isSpanContextValid=Ao,this.deleteSpan=Nm,this.getSpan=or,this.getActiveSpan=wm,this.getSpanContext=$o,this.setSpan=ir,this.setSpanContext=_m}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var a=ar(ya,this._proxyTracerProvider,Hs.instance());return a&&this._proxyTracerProvider.setDelegate(t),a},e.prototype.getTracerProvider=function(){return ys(ya)||this._proxyTracerProvider},e.prototype.getTracer=function(t,a){return this.getTracerProvider().getTracer(t,a)},e.prototype.disable=function(){rr(ya,Hs.instance()),this._proxyTracerProvider=new tn},e}(),Mm=Rm.getInstance(),Om=Object.defineProperty,lr=(e,t)=>{for(var a in t)Om(e,a,{get:t[a],enumerable:!0})};function Do(e,{contentType:t,dataStreamVersion:a}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),r.set("X-Vercel-AI-Data-Stream",a),r}var Ro="AI_InvalidArgumentError",Mo=`vercel.ai.error.${Ro}`,Lm=Symbol.for(Mo),Oo,He=class extends se{constructor({parameter:e,value:t,message:a}){super({name:Ro,message:`Invalid argument for parameter ${e}: ${a}`}),this[Oo]=!0,this.parameter=e,this.value=t}static isInstance(e){return se.hasMarker(e,Mo)}};Oo=Lm;var Lo="AI_RetryError",Fo=`vercel.ai.error.${Lo}`,Fm=Symbol.for(Fo),Uo,sn=class extends se{constructor({message:e,reason:t,errors:a}){super({name:Lo,message:e}),this[Uo]=!0,this.reason=t,this.errors=a,this.lastError=a[a.length-1]}static isInstance(e){return se.hasMarker(e,Fo)}};Uo=Fm;var Um=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:a=2}={})=>async r=>Vo(r,{maxRetries:e,delayInMs:t,backoffFactor:a});async function Vo(e,{maxRetries:t,delayInMs:a,backoffFactor:r},n=[]){try{return await e()}catch(o){if(fd(o)||t===0)throw o;const l=hd(o),c=[...n,o],d=c.length;if(d>t)throw new sn({message:`Failed after ${d} attempts. Last error: ${l}`,reason:"maxRetriesExceeded",errors:c});if(o instanceof Error&&Be.isInstance(o)&&o.isRetryable===!0&&d<=t)return await pd(a),Vo(e,{maxRetries:t,delayInMs:r*a,backoffFactor:r},c);throw d===1?o:new sn({message:`Failed after ${d} attempts with non-retryable error: '${l}'`,reason:"errorNotRetryable",errors:c})}}function Vm({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new He({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new He({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:Um({maxRetries:t})}}function Fa({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function Bm({model:e,settings:t,telemetry:a,headers:r}){var n;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((o,[l,c])=>(o[`ai.settings.${l}`]=c,o),{}),...Object.entries((n=a==null?void 0:a.metadata)!=null?n:{}).reduce((o,[l,c])=>(o[`ai.telemetry.metadata.${l}`]=c,o),{}),...Object.entries(r??{}).reduce((o,[l,c])=>(c!==void 0&&(o[`ai.request.headers.${l}`]=c),o),{})}}var qm={startSpan(){return Es},startActiveSpan(e,t,a,r){if(typeof t=="function")return t(Es);if(typeof a=="function")return a(Es);if(typeof r=="function")return r(Es)}},Es={spanContext(){return Zm},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},Zm={traceId:"",spanId:"",traceFlags:0};function zm({isEnabled:e=!1,tracer:t}={}){return e?t||Mm.getTracer("ai"):qm}function Ua({name:e,tracer:t,attributes:a,fn:r,endWhenDone:n=!0}){return t.startActiveSpan(e,{attributes:a},async o=>{try{const l=await r(o);return n&&o.end(),l}catch(l){try{l instanceof Error?(o.recordException({name:l.name,message:l.message,stack:l.stack}),o.setStatus({code:Js.ERROR,message:l.message})):o.setStatus({code:Js.ERROR})}finally{o.end()}throw l}})}function Mt({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((a,[r,n])=>{if(n===void 0)return a;if(typeof n=="object"&&"input"in n&&typeof n.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return a;const o=n.input();return o===void 0?a:{...a,[r]:o}}if(typeof n=="object"&&"output"in n&&typeof n.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return a;const o=n.output();return o===void 0?a:{...a,[r]:o}}return{...a,[r]:n}},{})}var Gm=class{constructor({data:e,mimeType:t}){const a=e instanceof Uint8Array;this.base64Data=a?void 0:e,this.uint8ArrayData=a?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Ia(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=Qa(this.base64Data)),this.uint8ArrayData}},Hm=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],Jm=e=>{const t=typeof e=="string"?Qa(e):e,a=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(a+10)};function Wm(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?Jm(e):e}function Ym({data:e,signatures:t}){const a=Wm(e);for(const r of t)if(typeof a=="string"?a.startsWith(r.base64Prefix):a.length>=r.bytesPrefix.length&&r.bytesPrefix.every((n,o)=>a[o]===n))return r.mimeType}var Bo="AI_NoObjectGeneratedError",qo=`vercel.ai.error.${Bo}`,Km=Symbol.for(qo),Zo,an=class extends se{constructor({message:e="No object generated.",cause:t,text:a,response:r,usage:n,finishReason:o}){super({name:Bo,message:e,cause:t}),this[Zo]=!0,this.text=a,this.response=r,this.usage=n,this.finishReason=o}static isInstance(e){return se.hasMarker(e,qo)}};Zo=Km;var zo="AI_DownloadError",Go=`vercel.ai.error.${zo}`,Qm=Symbol.for(Go),Ho,ba=class extends se{constructor({url:e,statusCode:t,statusText:a,cause:r,message:n=r==null?`Failed to download ${e}: ${t} ${a}`:`Failed to download ${e}: ${r}`}){super({name:zo,message:n,cause:r}),this[Ho]=!0,this.url=e,this.statusCode=t,this.statusText=a}static isInstance(e){return se.hasMarker(e,Go)}};Ho=Qm;async function Xm({url:e}){var t;const a=e.toString();try{const r=await fetch(a);if(!r.ok)throw new ba({url:a,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw ba.isInstance(r)?r:new ba({url:a,cause:r})}}var Jo="AI_InvalidDataContentError",Wo=`vercel.ai.error.${Jo}`,ep=Symbol.for(Wo),Yo,rn=class extends se{constructor({content:e,cause:t,message:a=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:Jo,message:a,cause:t}),this[Yo]=!0,this.content=e}static isInstance(e){return se.hasMarker(e,Wo)}};Yo=ep;var Ko=Ne([k(),zs(Uint8Array),zs(ArrayBuffer),jo(e=>{var t,a;return(a=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?a:!1},{message:"Must be a Buffer"})]);function cr(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Ia(new Uint8Array(e)):Ia(e)}function Ws(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return Qa(e)}catch(t){throw new rn({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new rn({content:e})}function tp(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var Qo="AI_InvalidMessageRoleError",Xo=`vercel.ai.error.${Qo}`,sp=Symbol.for(Xo),ei,ap=class extends se{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:Qo,message:t}),this[ei]=!0,this.role=e}static isInstance(e){return se.hasMarker(e,Xo)}};ei=sp;function rp(e){try{const[t,a]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:a}}catch{return{mimeType:void 0,base64Content:void 0}}}async function np({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:a=()=>!1,downloadImplementation:r=Xm}){const n=await ip(e.messages,r,t,a);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(o=>op(o,n))]}function op(e,t){var a,r,n,o,l,c;const d=e.role;switch(d){case"system":return{role:"system",content:e.content,providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(i=>lp(i,t)).filter(i=>i.type!=="text"||i.text!==""),providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(i=>i.type!=="text"||i.text!=="").map(i=>{var u;const m=(u=i.providerOptions)!=null?u:i.experimental_providerMetadata;switch(i.type){case"file":return{type:"file",data:i.data instanceof URL?i.data:cr(i.data),filename:i.filename,mimeType:i.mimeType,providerMetadata:m};case"reasoning":return{type:"reasoning",text:i.text,signature:i.signature,providerMetadata:m};case"redacted-reasoning":return{type:"redacted-reasoning",data:i.data,providerMetadata:m};case"text":return{type:"text",text:i.text,providerMetadata:m};case"tool-call":return{type:"tool-call",toolCallId:i.toolCallId,toolName:i.toolName,args:i.args,providerMetadata:m}}}),providerMetadata:(l=e.providerOptions)!=null?l:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(i=>{var u;return{type:"tool-result",toolCallId:i.toolCallId,toolName:i.toolName,result:i.result,content:i.experimental_content,isError:i.isError,providerMetadata:(u=i.providerOptions)!=null?u:i.experimental_providerMetadata}}),providerMetadata:(c=e.providerOptions)!=null?c:e.experimental_providerMetadata};default:{const i=d;throw new ap({role:i})}}}async function ip(e,t,a,r){const n=e.filter(l=>l.role==="user").map(l=>l.content).filter(l=>Array.isArray(l)).flat().filter(l=>l.type==="image"||l.type==="file").filter(l=>!(l.type==="image"&&a===!0)).map(l=>l.type==="image"?l.image:l.data).map(l=>typeof l=="string"&&(l.startsWith("http:")||l.startsWith("https:"))?new URL(l):l).filter(l=>l instanceof URL).filter(l=>!r(l)),o=await Promise.all(n.map(async l=>({url:l,data:await t({url:l})})));return Object.fromEntries(o.map(({url:l,data:c})=>[l.toString(),c]))}function lp(e,t){var a,r,n,o;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};let l=e.mimeType,c,d,i;const u=e.type;switch(u){case"image":c=e.image;break;case"file":c=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{d=typeof c=="string"?new URL(c):c}catch{d=c}if(d instanceof URL)if(d.protocol==="data:"){const{mimeType:m,base64Content:w}=rp(d.toString());if(m==null||w==null)throw new Error(`Invalid data URL format in part ${u}`);l=m,i=Ws(w)}else{const m=t[d.toString()];m?(i=m.data,l??(l=m.mimeType)):i=d}else i=Ws(d);switch(u){case"image":return i instanceof Uint8Array&&(l=(r=Ym({data:i,signatures:Hm}))!=null?r:l),{type:"image",image:i,mimeType:l,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"file":{if(l==null)throw new Error("Mime type is missing for file part");return{type:"file",data:i instanceof Uint8Array?cr(i):i,filename:e.filename,mimeType:l,providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata}}}}function cp({maxTokens:e,temperature:t,topP:a,topK:r,presencePenalty:n,frequencyPenalty:o,stopSequences:l,seed:c}){if(e!=null){if(!Number.isInteger(e))throw new He({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new He({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new He({parameter:"temperature",value:t,message:"temperature must be a number"});if(a!=null&&typeof a!="number")throw new He({parameter:"topP",value:a,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new He({parameter:"topK",value:r,message:"topK must be a number"});if(n!=null&&typeof n!="number")throw new He({parameter:"presencePenalty",value:n,message:"presencePenalty must be a number"});if(o!=null&&typeof o!="number")throw new He({parameter:"frequencyPenalty",value:o,message:"frequencyPenalty must be a number"});if(c!=null&&!Number.isInteger(c))throw new He({parameter:"seed",value:c,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:a,topK:r,presencePenalty:n,frequencyPenalty:o,stopSequences:l!=null&&l.length>0?l:void 0,seed:c}}function nn(e){var t,a,r;const n=[];for(const o of e){let l;try{l=new URL(o.url)}catch{throw new Error(`Invalid URL: ${o.url}`)}switch(l.protocol){case"http:":case"https:":{if((t=o.contentType)!=null&&t.startsWith("image/"))n.push({type:"image",image:l});else{if(!o.contentType)throw new Error("If the attachment is not an image, it must specify a content type");n.push({type:"file",data:l,mimeType:o.contentType})}break}case"data:":{let c,d,i;try{[c,d]=o.url.split(","),i=c.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${o.url}`)}if(i==null||d==null)throw new Error(`Invalid data URL format: ${o.url}`);if((a=o.contentType)!=null&&a.startsWith("image/"))n.push({type:"image",image:Ws(d)});else if((r=o.contentType)!=null&&r.startsWith("text/"))n.push({type:"text",text:tp(Ws(d))});else{if(!o.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");n.push({type:"file",data:d,mimeType:o.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${l.protocol}`)}}return n}var ti="AI_MessageConversionError",si=`vercel.ai.error.${ti}`,dp=Symbol.for(si),ai,va=class extends se{constructor({originalMessage:e,message:t}){super({name:ti,message:t}),this[ai]=!0,this.originalMessage=e}static isInstance(e){return se.hasMarker(e,si)}};ai=dp;function up(e,t){var a,r;const n=(a=t==null?void 0:t.tools)!=null?a:{},o=[];for(let l=0;l<e.length;l++){const c=e[l],d=l===e.length-1,{role:i,content:u,experimental_attachments:m}=c;switch(i){case"system":{o.push({role:"system",content:u});break}case"user":{if(c.parts==null)o.push({role:"user",content:m?[{type:"text",text:u},...nn(m)]:u});else{const w=c.parts.filter(j=>j.type==="text").map(j=>({type:"text",text:j.text}));o.push({role:"user",content:m?[...w,...nn(m)]:w})}break}case"assistant":{if(c.parts!=null){let x=function(){const b=[];for(const N of y)switch(N.type){case"file":case"text":{b.push(N);break}case"reasoning":{for(const O of N.details)switch(O.type){case"text":b.push({type:"reasoning",text:O.text,signature:O.signature});break;case"redacted":b.push({type:"redacted-reasoning",data:O.data});break}break}case"tool-invocation":b.push({type:"tool-call",toolCallId:N.toolInvocation.toolCallId,toolName:N.toolInvocation.toolName,args:N.toolInvocation.args});break;default:{const O=N;throw new Error(`Unsupported part: ${O}`)}}o.push({role:"assistant",content:b});const E=y.filter(N=>N.type==="tool-invocation").map(N=>N.toolInvocation);E.length>0&&o.push({role:"tool",content:E.map(N=>{if(!("result"in N))throw new va({originalMessage:c,message:"ToolInvocation must have a result: "+JSON.stringify(N)});const{toolCallId:O,toolName:I,result:Y}=N,L=n[I];return(L==null?void 0:L.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:O,toolName:I,result:L.experimental_toToolResultContent(Y),experimental_content:L.experimental_toToolResultContent(Y)}:{type:"tool-result",toolCallId:O,toolName:I,result:Y}})}),y=[],g=!1,f++},f=0,g=!1,y=[];for(const b of c.parts)switch(b.type){case"text":{g&&x(),y.push(b);break}case"file":case"reasoning":{y.push(b);break}case"tool-invocation":{((r=b.toolInvocation.step)!=null?r:0)!==f&&x(),y.push(b),g=!0;break}}x();break}const w=c.toolInvocations;if(w==null||w.length===0){o.push({role:"assistant",content:u});break}const j=w.reduce((x,f)=>{var g;return Math.max(x,(g=f.step)!=null?g:0)},0);for(let x=0;x<=j;x++){const f=w.filter(g=>{var y;return((y=g.step)!=null?y:0)===x});f.length!==0&&(o.push({role:"assistant",content:[...d&&u&&x===0?[{type:"text",text:u}]:[],...f.map(({toolCallId:g,toolName:y,args:b})=>({type:"tool-call",toolCallId:g,toolName:y,args:b}))]}),o.push({role:"tool",content:f.map(g=>{if(!("result"in g))throw new va({originalMessage:c,message:"ToolInvocation must have a result: "+JSON.stringify(g)});const{toolCallId:y,toolName:b,result:E}=g,N=n[b];return(N==null?void 0:N.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:y,toolName:b,result:N.experimental_toToolResultContent(E),experimental_content:N.experimental_toToolResultContent(E)}:{type:"tool-result",toolCallId:y,toolName:b,result:E}})}))}u&&!d&&o.push({role:"assistant",content:u});break}case"data":break;default:{const w=i;throw new va({originalMessage:c,message:`Unsupported role: ${w}`})}}}return o}var Va=Kd(()=>Ne([Yd(),k(),W(),Qe(),ds(k(),Va),de(Va)])),ve=ds(k(),ds(k(),Va)),mp=de(Ne([S({type:te("text"),text:k()}),S({type:te("image"),data:k(),mimeType:k().optional()})])),ri=S({type:te("text"),text:k(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),pp=S({type:te("image"),image:Ne([Ko,zs(URL)]),mimeType:k().optional(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),ni=S({type:te("file"),data:Ne([Ko,zs(URL)]),filename:k().optional(),mimeType:k(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),hp=S({type:te("reasoning"),text:k(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),fp=S({type:te("redacted-reasoning"),data:k(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),gp=S({type:te("tool-call"),toolCallId:k(),toolName:k(),args:aa(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),xp=S({type:te("tool-result"),toolCallId:k(),toolName:k(),result:aa(),content:mp.optional(),isError:Qe().optional(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),yp=S({role:te("system"),content:k(),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),bp=S({role:te("user"),content:Ne([k(),de(Ne([ri,pp,ni]))]),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),vp=S({role:te("assistant"),content:Ne([k(),de(Ne([ri,ni,hp,fp,gp]))]),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),jp=S({role:te("tool"),content:de(xp),providerOptions:ve.optional(),experimental_providerMetadata:ve.optional()}),wp=Ne([yp,bp,vp,jp]);function Np({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new it({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new it({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new it({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new it({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=_p(e.messages)==="ui-messages"?up(e.messages,{tools:t}):e.messages;if(r.length===0)throw new it({prompt:e,message:"messages must not be empty"});const n=sa({value:r,schema:de(wp)});if(!n.success)throw new it({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${n.error.message}`].join(`
`),cause:n.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function _p(e){if(!Array.isArray(e))throw new it({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(kp);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const a=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(a===-1)return"messages";throw new it({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[a]}" at index ${a}`,`messages[${a}]: ${JSON.stringify(e[a])}`].join(`
`),cause:e})}function kp(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Sp({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function Cp(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var Tp="JSON schema:",Ep="You MUST answer with a JSON object that matches the JSON schema above.",Ip="You MUST answer with JSON.";function $p({prompt:e,schema:t,schemaPrefix:a=t!=null?Tp:void 0,schemaSuffix:r=t!=null?Ep:Ip}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,a,t!=null?JSON.stringify(t):void 0,r].filter(n=>n!=null).join(`
`)}function Ap(e){const t=e.map(a=>({...a,content:typeof a.content=="string"?a.content:a.content.map(Pp)}));return JSON.stringify(t)}function Pp(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?cr(e.image):e.image}:e}St({prefix:"aiobj",size:24});St({prefix:"aiobj",size:24});var oi="AI_NoOutputSpecifiedError",ii=`vercel.ai.error.${oi}`,Dp=Symbol.for(ii),li,Rp=class extends se{constructor({message:e="No output specified."}={}){super({name:oi,message:e}),this[li]=!0}static isInstance(e){return se.hasMarker(e,ii)}};li=Dp;var ci="AI_ToolExecutionError",di=`vercel.ai.error.${ci}`,Mp=Symbol.for(di),ui,Op=class extends se{constructor({toolArgs:e,toolName:t,toolCallId:a,cause:r,message:n=`Error executing tool ${t}: ${vs(r)}`}){super({name:ci,message:n,cause:r}),this[ui]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=a}static isInstance(e){return se.hasMarker(e,di)}};ui=Mp;function Lp(e){return e!=null&&Object.keys(e).length>0}function Fp({tools:e,toolChoice:t,activeTools:a}){return Lp(e)?{tools:(a!=null?Object.entries(e).filter(([n])=>a.includes(n)):Object.entries(e)).map(([n,o])=>{const l=o.type;switch(l){case void 0:case"function":return{type:"function",name:n,description:o.description,parameters:na(o.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:n,id:o.id,args:o.args};default:{const c=l;throw new Error(`Unsupported tool type: ${c}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var Up=/^([\s\S]*?)(\s+)(\S*)$/;function Vp(e){const t=e.match(Up);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}function Bp(e){const t=Vp(e);return t?t.prefix+t.whitespace:e}var mi="AI_InvalidToolArgumentsError",pi=`vercel.ai.error.${mi}`,qp=Symbol.for(pi),hi,fi=class extends se{constructor({toolArgs:e,toolName:t,cause:a,message:r=`Invalid arguments for tool ${t}: ${vs(a)}`}){super({name:mi,message:r,cause:a}),this[hi]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return se.hasMarker(e,pi)}};hi=qp;var gi="AI_NoSuchToolError",xi=`vercel.ai.error.${gi}`,Zp=Symbol.for(xi),yi,Ba=class extends se{constructor({toolName:e,availableTools:t=void 0,message:a=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:gi,message:a}),this[yi]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return se.hasMarker(e,xi)}};yi=Zp;var bi="AI_ToolCallRepairError",vi=`vercel.ai.error.${bi}`,zp=Symbol.for(vi),ji,Gp=class extends se{constructor({cause:e,originalError:t,message:a=`Error repairing tool call: ${vs(e)}`}){super({name:bi,message:a,cause:e}),this[ji]=!0,this.originalError=t}static isInstance(e){return se.hasMarker(e,vi)}};ji=zp;async function Hp({toolCall:e,tools:t,repairToolCall:a,system:r,messages:n}){if(t==null)throw new Ba({toolName:e.toolName});try{return await on({toolCall:e,tools:t})}catch(o){if(a==null||!(Ba.isInstance(o)||fi.isInstance(o)))throw o;let l=null;try{l=await a({toolCall:e,tools:t,parameterSchema:({toolName:c})=>na(t[c].parameters).jsonSchema,system:r,messages:n,error:o})}catch(c){throw new Gp({cause:c,originalError:o})}if(l==null)throw o;return await on({toolCall:l,tools:t})}}async function on({toolCall:e,tools:t}){const a=e.toolName,r=t[a];if(r==null)throw new Ba({toolName:e.toolName,availableTools:Object.keys(t)});const n=na(r.parameters),o=e.args.trim()===""?sa({value:{},schema:n}):As({text:e.args,schema:n});if(o.success===!1)throw new fi({toolName:a,toolArgs:e.args,cause:o.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:a,args:o.value}}function ln(e){const t=e.filter(a=>a.type==="text").map(a=>a.text).join("");return t.length>0?t:void 0}function Jp({text:e="",files:t,reasoning:a,tools:r,toolCalls:n,toolResults:o,messageId:l,generateMessageId:c}){const d=[],i=[];return a.length>0&&i.push(...a.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&i.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&i.push({type:"text",text:e}),n.length>0&&i.push(...n),i.length>0&&d.push({role:"assistant",content:i,id:l}),o.length>0&&d.push({role:"tool",id:c(),content:o.map(u=>{const m=r[u.toolName];return(m==null?void 0:m.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:m.experimental_toToolResultContent(u.result),experimental_content:m.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),d}var Wp=St({prefix:"aitxt",size:24}),Yp=St({prefix:"msg",size:24});async function qa({model:e,tools:t,toolChoice:a,system:r,prompt:n,messages:o,maxRetries:l,abortSignal:c,headers:d,maxSteps:i=1,experimental_generateMessageId:u=Yp,experimental_output:m,experimental_continueSteps:w=!1,experimental_telemetry:j,experimental_providerMetadata:x,providerOptions:f=x,experimental_activeTools:g,experimental_prepareStep:y,experimental_repairToolCall:b,_internal:{generateId:E=Wp,currentDate:N=()=>new Date}={},onStepFinish:O,...I}){var Y;if(i<1)throw new He({parameter:"maxSteps",value:i,message:"maxSteps must be at least 1"});const{maxRetries:L,retry:B}=Vm({maxRetries:l}),re=Bm({model:e,telemetry:j,headers:d,settings:{...I,maxRetries:L}}),F=Np({prompt:{system:(Y=m==null?void 0:m.injectIntoSystemPrompt({system:r,model:e}))!=null?Y:r,prompt:n,messages:o},tools:t}),M=zm(j);return Ua({name:"ai.generateText",attributes:Mt({telemetry:j,attributes:{...Fa({operationId:"ai.generateText",telemetry:j}),...re,"ai.model.provider":e.provider,"ai.model.id":e.modelId,"ai.prompt":{input:()=>JSON.stringify({system:r,prompt:n,messages:o})},"ai.settings.maxSteps":i}}),tracer:M,fn:async K=>{var v,P,J,ie,ee,le,ae,h,C,z,_,V,q,$;const oe=cp(I);let G,xe=[],ye=[],fe=[],Te=0;const ge=[];let Oe="";const mt=[],Fe=[];let Ee={completionTokens:0,promptTokens:0,totalTokens:0},Ie="initial";do{const Ct=Te===0?F.type:"messages",Tt=[...F.messages,...ge],at=await(y==null?void 0:y({model:e,steps:Fe,maxSteps:i,stepNumber:Te})),ws=(v=at==null?void 0:at.toolChoice)!=null?v:a,Ns=(P=at==null?void 0:at.experimental_activeTools)!=null?P:g,Ue=(J=at==null?void 0:at.model)!=null?J:e,Ht=await np({prompt:{type:Ct,system:F.system,messages:Tt},modelSupportsImageUrls:Ue.supportsImageUrls,modelSupportsUrl:(ie=Ue.supportsUrl)==null?void 0:ie.bind(Ue)}),yt={type:"regular",...Fp({tools:t,toolChoice:ws,activeTools:Ns})};G=await B(()=>Ua({name:"ai.generateText.doGenerate",attributes:Mt({telemetry:j,attributes:{...Fa({operationId:"ai.generateText.doGenerate",telemetry:j}),...re,"ai.model.provider":Ue.provider,"ai.model.id":Ue.modelId,"ai.prompt.format":{input:()=>Ct},"ai.prompt.messages":{input:()=>Ap(Ht)},"ai.prompt.tools":{input:()=>{var Se;return(Se=yt.tools)==null?void 0:Se.map(ht=>JSON.stringify(ht))}},"ai.prompt.toolChoice":{input:()=>yt.toolChoice!=null?JSON.stringify(yt.toolChoice):void 0},"gen_ai.system":Ue.provider,"gen_ai.request.model":Ue.modelId,"gen_ai.request.frequency_penalty":I.frequencyPenalty,"gen_ai.request.max_tokens":I.maxTokens,"gen_ai.request.presence_penalty":I.presencePenalty,"gen_ai.request.stop_sequences":I.stopSequences,"gen_ai.request.temperature":I.temperature,"gen_ai.request.top_k":I.topK,"gen_ai.request.top_p":I.topP}}),tracer:M,fn:async Se=>{var ht,Ye,$t,Ke,At,nt;const $e=await Ue.doGenerate({mode:yt,...oe,inputFormat:Ct,responseFormat:m==null?void 0:m.responseFormat({model:e}),prompt:Ht,providerMetadata:f,abortSignal:c,headers:d}),Ve={id:(Ye=(ht=$e.response)==null?void 0:ht.id)!=null?Ye:E(),timestamp:(Ke=($t=$e.response)==null?void 0:$t.timestamp)!=null?Ke:N(),modelId:(nt=(At=$e.response)==null?void 0:At.modelId)!=null?nt:Ue.modelId};return Se.setAttributes(Mt({telemetry:j,attributes:{"ai.response.finishReason":$e.finishReason,"ai.response.text":{output:()=>$e.text},"ai.response.toolCalls":{output:()=>JSON.stringify($e.toolCalls)},"ai.response.id":Ve.id,"ai.response.model":Ve.modelId,"ai.response.timestamp":Ve.timestamp.toISOString(),"ai.usage.promptTokens":$e.usage.promptTokens,"ai.usage.completionTokens":$e.usage.completionTokens,"gen_ai.response.finish_reasons":[$e.finishReason],"gen_ai.response.id":Ve.id,"gen_ai.response.model":Ve.modelId,"gen_ai.usage.input_tokens":$e.usage.promptTokens,"gen_ai.usage.output_tokens":$e.usage.completionTokens}})),{...$e,response:Ve}}})),xe=await Promise.all(((ee=G.toolCalls)!=null?ee:[]).map(Se=>Hp({toolCall:Se,tools:t,repairToolCall:b,system:r,messages:Tt}))),ye=t==null?[]:await Kp({toolCalls:xe,tools:t,tracer:M,telemetry:j,messages:Tt,abortSignal:c});const Et=Sp(G.usage);Ee=Cp(Ee,Et);let rt="done";++Te<i&&(w&&G.finishReason==="length"&&xe.length===0?rt="continue":xe.length>0&&ye.length===xe.length&&(rt="tool-result"));const It=(le=G.text)!=null?le:"",Jt=Ie==="continue"&&Oe.trimEnd()!==Oe?It.trimStart():It,pt=rt==="continue"?Bp(Jt):Jt;if(Oe=rt==="continue"||Ie==="continue"?Oe+pt:pt,fe=cn(G.reasoning),mt.push(...(ae=G.sources)!=null?ae:[]),Ie==="continue"){const Se=ge[ge.length-1];typeof Se.content=="string"?Se.content+=pt:Se.content.push({text:pt,type:"text"})}else ge.push(...Jp({text:Oe,files:ja(G.files),reasoning:cn(G.reasoning),tools:t??{},toolCalls:xe,toolResults:ye,messageId:u(),generateMessageId:u}));const Wt={stepType:Ie,text:pt,reasoning:ln(fe),reasoningDetails:fe,files:ja(G.files),sources:(h=G.sources)!=null?h:[],toolCalls:xe,toolResults:ye,finishReason:G.finishReason,usage:Et,warnings:G.warnings,logprobs:G.logprobs,request:(C=G.request)!=null?C:{},response:{...G.response,headers:(z=G.rawResponse)==null?void 0:z.headers,body:(_=G.rawResponse)==null?void 0:_.body,messages:structuredClone(ge)},providerMetadata:G.providerMetadata,experimental_providerMetadata:G.providerMetadata,isContinued:rt==="continue"};Fe.push(Wt),await(O==null?void 0:O(Wt)),Ie=rt}while(Ie!=="done");return K.setAttributes(Mt({telemetry:j,attributes:{"ai.response.finishReason":G.finishReason,"ai.response.text":{output:()=>G.text},"ai.response.toolCalls":{output:()=>JSON.stringify(G.toolCalls)},"ai.usage.promptTokens":G.usage.promptTokens,"ai.usage.completionTokens":G.usage.completionTokens}})),new Qp({text:Oe,files:ja(G.files),reasoning:ln(fe),reasoningDetails:fe,sources:mt,outputResolver:()=>{if(m==null)throw new Rp;return m.parseOutput({text:Oe},{response:G.response,usage:Ee,finishReason:G.finishReason})},toolCalls:xe,toolResults:ye,finishReason:G.finishReason,usage:Ee,warnings:G.warnings,request:(V=G.request)!=null?V:{},response:{...G.response,headers:(q=G.rawResponse)==null?void 0:q.headers,body:($=G.rawResponse)==null?void 0:$.body,messages:ge},logprobs:G.logprobs,steps:Fe,providerMetadata:G.providerMetadata})}})}async function Kp({toolCalls:e,tools:t,tracer:a,telemetry:r,messages:n,abortSignal:o}){return(await Promise.all(e.map(async({toolCallId:c,toolName:d,args:i})=>{const u=t[d];if((u==null?void 0:u.execute)==null)return;const m=await Ua({name:"ai.toolCall",attributes:Mt({telemetry:r,attributes:{...Fa({operationId:"ai.toolCall",telemetry:r}),"ai.toolCall.name":d,"ai.toolCall.id":c,"ai.toolCall.args":{output:()=>JSON.stringify(i)}}}),tracer:a,fn:async w=>{try{const j=await u.execute(i,{toolCallId:c,messages:n,abortSignal:o});try{w.setAttributes(Mt({telemetry:r,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(j)}}}))}catch{}return j}catch(j){throw new Op({toolCallId:c,toolName:d,toolArgs:i,cause:j})}}});return{type:"tool-result",toolCallId:c,toolName:d,args:i,result:m}}))).filter(c=>c!=null)}var Qp=class{constructor(e){this.text=e.text,this.files=e.files,this.reasoning=e.reasoning,this.reasoningDetails=e.reasoningDetails,this.toolCalls=e.toolCalls,this.toolResults=e.toolResults,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.request=e.request,this.response=e.response,this.steps=e.steps,this.experimental_providerMetadata=e.providerMetadata,this.providerMetadata=e.providerMetadata,this.logprobs=e.logprobs,this.outputResolver=e.outputResolver,this.sources=e.sources}get experimental_output(){return this.outputResolver()}};function cn(e){return e==null?[]:typeof e=="string"?[{type:"text",text:e}]:e}function ja(e){var t;return(t=e==null?void 0:e.map(a=>new Gm(a)))!=null?t:[]}var Xp={};lr(Xp,{object:()=>th,text:()=>eh});var eh=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),th=({schema:e})=>{const t=na(e);return{type:"object",responseFormat:({model:a})=>({type:"json",schema:a.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:a,model:r}){return r.supportsStructuredOutputs?a:$p({prompt:a,schema:t.jsonSchema})},parsePartial({text:a}){const r=Ru(a);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const n=r.state;throw new Error(`Unsupported parse state: ${n}`)}}},parseOutput({text:a},r){const n=As({text:a});if(!n.success)throw new an({message:"No object generated: could not parse the response.",cause:n.error,text:a,response:r.response,usage:r.usage,finishReason:r.finishReason});const o=sa({value:n.value,schema:t});if(!o.success)throw new an({message:"No object generated: response did not match schema.",cause:o.error,text:a,response:r.response,usage:r.usage,finishReason:r.finishReason});return o.value}}};function wi(e,t){const a=e.getReader(),r=t.getReader();let n,o,l=!1,c=!1;async function d(u){try{n==null&&(n=a.read());const m=await n;n=void 0,m.done?u.close():u.enqueue(m.value)}catch(m){u.error(m)}}async function i(u){try{o==null&&(o=r.read());const m=await o;o=void 0,m.done?u.close():u.enqueue(m.value)}catch(m){u.error(m)}}return new ReadableStream({async pull(u){try{if(l){await i(u);return}if(c){await d(u);return}n==null&&(n=a.read()),o==null&&(o=r.read());const{result:m,reader:w}=await Promise.race([n.then(j=>({result:j,reader:a})),o.then(j=>({result:j,reader:r}))]);m.done||u.enqueue(m.value),w===a?(n=void 0,m.done&&(await i(u),l=!0)):(o=void 0,m.done&&(c=!0,await d(u)))}catch(m){u.error(m)}},cancel(){a.cancel(),r.cancel()}})}St({prefix:"aitxt",size:24});St({prefix:"msg",size:24});var sh=S({name:k(),version:k()}).passthrough(),dr=S({_meta:_e(S({}).passthrough())}).passthrough(),bs=dr,ah=S({method:k(),params:_e(dr)}),rh=S({experimental:_e(S({}).passthrough()),logging:_e(S({}).passthrough()),prompts:_e(S({listChanged:_e(Qe())}).passthrough()),resources:_e(S({subscribe:_e(Qe()),listChanged:_e(Qe())}).passthrough()),tools:_e(S({listChanged:_e(Qe())}).passthrough())}).passthrough();bs.extend({protocolVersion:k(),capabilities:rh,serverInfo:sh,instructions:_e(k())});var nh=bs.extend({nextCursor:_e(k())}),oh=S({name:k(),description:_e(k()),inputSchema:S({type:te("object"),properties:_e(S({}).passthrough())}).passthrough()}).passthrough();nh.extend({tools:de(oh)});var ih=S({type:te("text"),text:k()}).passthrough(),lh=S({type:te("image"),data:k().base64(),mimeType:k()}).passthrough(),Ni=S({uri:k(),mimeType:_e(k())}).passthrough(),ch=Ni.extend({text:k()}),dh=Ni.extend({blob:k().base64()}),uh=S({type:te("resource"),resource:Ne([ch,dh])}).passthrough();bs.extend({content:de(Ne([ih,lh,uh])),isError:Qe().default(!1).optional()}).or(bs.extend({toolResult:aa()}));var oa="2.0",mh=S({jsonrpc:te(oa),id:Ne([k(),W().int()])}).merge(ah).strict(),ph=S({jsonrpc:te(oa),id:Ne([k(),W().int()]),result:bs}).strict(),hh=S({jsonrpc:te(oa),id:Ne([k(),W().int()]),error:S({code:W().int(),message:k(),data:_e(aa())})}).strict(),fh=S({jsonrpc:te(oa)}).merge(S({method:k(),params:_e(dr)})).strict();Ne([mh,fh,ph,hh]);var gh={};lr(gh,{mergeIntoDataStream:()=>bh,toDataStream:()=>xh,toDataStreamResponse:()=>yh});function _i(e={}){const t=new TextEncoder;let a="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,n){n.enqueue(t.encode(r)),a+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(a),e.onFinal&&await e.onFinal(a)}})}function ur(e,t){return e.pipeThrough(new TransformStream({transform:async(a,r)=>{var n;if(typeof a=="string"){r.enqueue(a);return}if("event"in a){a.event==="on_chat_model_stream"&&dn((n=a.data)==null?void 0:n.chunk,r);return}dn(a,r)}})).pipeThrough(_i(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(a,r)=>{r.enqueue(Co("text",a))}}))}function xh(e,t){return ur(e,t).pipeThrough(new TextEncoderStream)}function yh(e,t){var a;const r=ur(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),n=t==null?void 0:t.data,o=t==null?void 0:t.init,l=n?wi(n.stream,r):r;return new Response(l,{status:(a=o==null?void 0:o.status)!=null?a:200,statusText:o==null?void 0:o.statusText,headers:Do(o==null?void 0:o.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function bh(e,t){t.dataStream.merge(ur(e,t.callbacks))}function dn(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const a=e.content;for(const r of a)r.type==="text"&&t.enqueue(r.text)}}var vh={};lr(vh,{mergeIntoDataStream:()=>Nh,toDataStream:()=>jh,toDataStreamResponse:()=>wh});function mr(e,t){const a=_h();return md(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,n){n.enqueue(a(r.delta))}})).pipeThrough(_i(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,n)=>{n.enqueue(Co("text",r))}}))}function jh(e,t){return mr(e,t).pipeThrough(new TextEncoderStream)}function wh(e,t={}){var a;const{init:r,data:n,callbacks:o}=t,l=mr(e,o).pipeThrough(new TextEncoderStream),c=n?wi(n.stream,l):l;return new Response(c,{status:(a=r==null?void 0:r.status)!=null?a:200,statusText:r==null?void 0:r.statusText,headers:Do(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Nh(e,t){t.dataStream.merge(mr(e,t.callbacks))}function _h(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}var kh={};function tt(...e){return e.reduce((t,a)=>({...t,...a??{}}),{})}function Sh(){let e="",t,a=[],r,n;function o(d,i){if(d===""){l(i);return}if(d.startsWith(":"))return;const u=d.indexOf(":");if(u===-1){c(d,"");return}const m=d.slice(0,u),w=u+1,j=w<d.length&&d[w]===" "?d.slice(w+1):d.slice(w);c(m,j)}function l(d){a.length>0&&(d.enqueue({event:t,data:a.join(`
`),id:r,retry:n}),a=[],t=void 0,n=void 0)}function c(d,i){switch(d){case"event":t=i;break;case"data":a.push(i);break;case"id":r=i;break;case"retry":const u=parseInt(i,10);isNaN(u)||(n=u);break}}return new TransformStream({transform(d,i){const{lines:u,incompleteLine:m}=Ch(e,d);e=m;for(let w=0;w<u.length;w++)o(u[w],i)},flush(d){o(e,d),l(d)}})}function Ch(e,t){const a=[];let r=e;for(let n=0;n<t.length;){const o=t[n++];o===`
`?(a.push(r),r=""):o==="\r"?(a.push(r),r="",t[n]===`
`&&n++):r+=o}return{lines:a,incompleteLine:r}}function js(e){const t={};return e.headers.forEach((a,r)=>{t[r]=a}),t}var Th=({prefix:e,size:t=16,alphabet:a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const n=mo(a,t);if(e==null)return n;if(a.includes(r))throw new Ya({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${a}".`});return o=>`${e}${r}${n(o)}`},bt=Th();function Eh(e){return Object.fromEntries(Object.entries(e).filter(([t,a])=>a!=null))}function wa(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function Ih({apiKey:e,environmentVariableName:t,apiKeyParameterName:a="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new Ts({message:`${r} API key must be a string.`});if(typeof process>"u")throw new Ts({message:`${r} API key is missing. Pass it using the '${a}' parameter. Environment variables is not supported in this environment.`});if(e=kh[t],e==null)throw new Ts({message:`${r} API key is missing. Pass it using the '${a}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new Ts({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var Za=Symbol.for("vercel.ai.validator");function $h(e){return{[Za]:!0,validate:e}}function Ah(e){return typeof e=="object"&&e!==null&&Za in e&&e[Za]===!0&&"validate"in e}function Ph(e){return Ah(e)?e:Dh(e)}function Dh(e){return $h(t=>{const a=e.safeParse(t);return a.success?{success:!0,value:a.data}:{success:!1,error:a.error}})}function Rh({value:e,schema:t}){const a=pr({value:e,schema:t});if(!a.success)throw Bt.wrap({value:e,cause:a.error});return a.value}function pr({value:e,schema:t}){const a=Ph(t);try{if(a.validate==null)return{success:!0,value:e};const r=a.validate(e);return r.success?r:{success:!1,error:Bt.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:Bt.wrap({value:e,cause:r})}}}function Mh({text:e,schema:t}){try{const a=ta.parse(e);return t==null?a:Rh({value:a,schema:t})}catch(a){throw Vt.isInstance(a)||Bt.isInstance(a)?a:new Vt({text:e,cause:a})}}function ki({text:e,schema:t}){try{const a=ta.parse(e);if(t==null)return{success:!0,value:a,rawValue:a};const r=pr({value:a,schema:t});return r.success?{...r,rawValue:a}:r}catch(a){return{success:!1,error:Vt.isInstance(a)?a:new Vt({text:e,cause:a})}}}function un(e){try{return ta.parse(e),!0}catch{return!1}}function hr({provider:e,providerOptions:t,schema:a}){if((t==null?void 0:t[e])==null)return;const r=pr({value:t[e],schema:a});if(!r.success)throw new Ya({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var Oh=()=>globalThis.fetch,ut=async({url:e,headers:t,body:a,failedResponseHandler:r,successfulResponseHandler:n,abortSignal:o,fetch:l})=>Si({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(a),values:a},failedResponseHandler:r,successfulResponseHandler:n,abortSignal:o,fetch:l}),Lh=async({url:e,headers:t,formData:a,failedResponseHandler:r,successfulResponseHandler:n,abortSignal:o,fetch:l})=>Si({url:e,headers:t,body:{content:a,values:Object.fromEntries(a.entries())},failedResponseHandler:r,successfulResponseHandler:n,abortSignal:o,fetch:l}),Si=async({url:e,headers:t={},body:a,successfulResponseHandler:r,failedResponseHandler:n,abortSignal:o,fetch:l=Oh()})=>{try{const c=await l(e,{method:"POST",headers:Eh(t),body:a.content,signal:o}),d=js(c);if(!c.ok){let i;try{i=await n({response:c,url:e,requestBodyValues:a.values})}catch(u){throw wa(u)||Be.isInstance(u)?u:new Be({message:"Failed to process error response",cause:u,statusCode:c.status,url:e,responseHeaders:d,requestBodyValues:a.values})}throw i.value}try{return await r({response:c,url:e,requestBodyValues:a.values})}catch(i){throw i instanceof Error&&(wa(i)||Be.isInstance(i))?i:new Be({message:"Failed to process successful response",cause:i,statusCode:c.status,url:e,responseHeaders:d,requestBodyValues:a.values})}}catch(c){if(wa(c))throw c;if(c instanceof TypeError&&c.message==="fetch failed"){const d=c.cause;if(d!=null)throw new Be({message:`Cannot connect to API: ${d.message}`,cause:d,url:e,requestBodyValues:a.values,isRetryable:!0})}throw c}},Fh=({errorSchema:e,errorToMessage:t,isRetryable:a})=>async({response:r,url:n,requestBodyValues:o})=>{const l=await r.text(),c=js(r);if(l.trim()==="")return{responseHeaders:c,value:new Be({message:r.statusText,url:n,requestBodyValues:o,statusCode:r.status,responseHeaders:c,responseBody:l,isRetryable:a==null?void 0:a(r)})};try{const d=Mh({text:l,schema:e});return{responseHeaders:c,value:new Be({message:t(d),url:n,requestBodyValues:o,statusCode:r.status,responseHeaders:c,responseBody:l,data:d,isRetryable:a==null?void 0:a(r,d)})}}catch{return{responseHeaders:c,value:new Be({message:r.statusText,url:n,requestBodyValues:o,statusCode:r.status,responseHeaders:c,responseBody:l,isRetryable:a==null?void 0:a(r)})}}},fr=e=>async({response:t})=>{const a=js(t);if(t.body==null)throw new Qc({});return{responseHeaders:a,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(Sh()).pipeThrough(new TransformStream({transform({data:r},n){r!=="[DONE]"&&n.enqueue(ki({text:r,schema:e}))}}))}},Gt=e=>async({response:t,url:a,requestBodyValues:r})=>{const n=await t.text(),o=ki({text:n,schema:e}),l=js(t);if(!o.success)throw new Be({message:"Invalid JSON response",cause:o.error,statusCode:t.status,responseHeaders:l,responseBody:n,url:a,requestBodyValues:r});return{responseHeaders:l,value:o.value,rawValue:o.rawValue}},Uh=()=>async({response:e,url:t,requestBodyValues:a})=>{const r=js(e);if(!e.body)throw new Be({message:"Response body is empty",url:t,requestBodyValues:a,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const n=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(n)}}catch(n){throw new Be({message:"Failed to read response as array buffer",url:t,requestBodyValues:a,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:n})}},{btoa:Vh,atob:Bh}=globalThis;function qh(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),a=Bh(t);return Uint8Array.from(a,r=>r.codePointAt(0))}function Ci(e){let t="";for(let a=0;a<e.length;a++)t+=String.fromCodePoint(e[a]);return Vh(t)}function Zh(e){return e==null?void 0:e.replace(/\/$/,"")}function zh({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:a="system"}){const r=[],n=[];for(const{role:o,content:l}of e)switch(o){case"system":{switch(a){case"system":{r.push({role:"system",content:l});break}case"developer":{r.push({role:"developer",content:l});break}case"remove":{n.push({type:"other",message:"system messages are removed for this model"});break}default:{const c=a;throw new Error(`Unsupported system message mode: ${c}`)}}break}case"user":{if(l.length===1&&l[0].type==="text"){r.push({role:"user",content:l[0].text});break}r.push({role:"user",content:l.map((c,d)=>{var i,u,m,w;switch(c.type){case"text":return{type:"text",text:c.text};case"image":return{type:"image_url",image_url:{url:c.image instanceof URL?c.image.toString():`data:${(i=c.mimeType)!=null?i:"image/jpeg"};base64,${Ci(c.image)}`,detail:(m=(u=c.providerMetadata)==null?void 0:u.openai)==null?void 0:m.imageDetail}};case"file":{if(c.data instanceof URL)throw new Ce({functionality:"'File content parts with URL data' functionality not supported."});switch(c.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:c.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:c.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(w=c.filename)!=null?w:`part-${d}.pdf`,file_data:`data:application/pdf;base64,${c.data}`}};default:throw new Ce({functionality:`File content part type ${c.mimeType} in user messages`})}}}})});break}case"assistant":{let c="";const d=[];for(const i of l)switch(i.type){case"text":{c+=i.text;break}case"tool-call":{d.push({id:i.toolCallId,type:"function",function:{name:i.toolName,arguments:JSON.stringify(i.args)}});break}}if(t){if(d.length>1)throw new Ce({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:c,function_call:d.length>0?d[0].function:void 0})}else r.push({role:"assistant",content:c,tool_calls:d.length>0?d:void 0});break}case"tool":{for(const c of l)t?r.push({role:"function",name:c.toolName,content:JSON.stringify(c.result)}):r.push({role:"tool",tool_call_id:c.toolCallId,content:JSON.stringify(c.result)});break}default:{const c=o;throw new Error(`Unsupported role: ${c}`)}}return{messages:r,warnings:n}}function mn(e){var t,a;return(a=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:n,top_logprobs:o})=>({token:r,logprob:n,topLogprobs:o?o.map(({token:l,logprob:c})=>({token:l,logprob:c})):[]})))!=null?a:void 0}function Ys(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var gr=S({error:S({message:k(),type:k().nullish(),param:wo().nullish(),code:Ne([k(),W()]).nullish()})}),st=Fh({errorSchema:gr,errorToMessage:e=>e.error.message});function Ks({id:e,model:t,created:a}){return{id:e??void 0,modelId:t??void 0,timestamp:a!=null?new Date(a*1e3):void 0}}function Gh({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:a}){var r;const n=(r=e.tools)!=null&&r.length?e.tools:void 0,o=[];if(n==null)return{tools:void 0,tool_choice:void 0,toolWarnings:o};const l=e.toolChoice;if(t){const i=[];for(const m of n)m.type==="provider-defined"?o.push({type:"unsupported-tool",tool:m}):i.push({name:m.name,description:m.description,parameters:m.parameters});if(l==null)return{functions:i,function_call:void 0,toolWarnings:o};switch(l.type){case"auto":case"none":case void 0:return{functions:i,function_call:void 0,toolWarnings:o};case"required":throw new Ce({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:i,function_call:{name:l.toolName},toolWarnings:o}}}const c=[];for(const i of n)i.type==="provider-defined"?o.push({type:"unsupported-tool",tool:i}):c.push({type:"function",function:{name:i.name,description:i.description,parameters:i.parameters,strict:a?!0:void 0}});if(l==null)return{tools:c,tool_choice:void 0,toolWarnings:o};const d=l.type;switch(d){case"auto":case"none":case"required":return{tools:c,tool_choice:d,toolWarnings:o};case"tool":return{tools:c,tool_choice:{type:"function",function:{name:l.toolName}},toolWarnings:o};default:{const i=d;throw new Ce({functionality:`Unsupported tool choice type: ${i}`})}}}var Hh=class{constructor(e,t,a){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=a}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:za(this.modelId)}get defaultObjectGenerationMode(){return Yh(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:a,temperature:r,topP:n,topK:o,frequencyPenalty:l,presencePenalty:c,stopSequences:d,responseFormat:i,seed:u,providerMetadata:m}){var w,j,x,f,g,y,b,E;const N=e.type,O=[];o!=null&&O.push({type:"unsupported-setting",setting:"topK"}),(i==null?void 0:i.type)==="json"&&i.schema!=null&&!this.supportsStructuredOutputs&&O.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const I=this.settings.useLegacyFunctionCalling;if(I&&this.settings.parallelToolCalls===!0)throw new Ce({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(I&&this.supportsStructuredOutputs)throw new Ce({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:Y,warnings:L}=zh({prompt:t,useLegacyFunctionCalling:I,systemMessageMode:Kh(this.modelId)});O.push(...L);const B={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:a,temperature:r,top_p:n,frequency_penalty:l,presence_penalty:c,response_format:(i==null?void 0:i.type)==="json"?this.supportsStructuredOutputs&&i.schema!=null?{type:"json_schema",json_schema:{schema:i.schema,strict:!0,name:(w=i.name)!=null?w:"response",description:i.description}}:{type:"json_object"}:void 0,stop:d,seed:u,max_completion_tokens:(j=m==null?void 0:m.openai)==null?void 0:j.maxCompletionTokens,store:(x=m==null?void 0:m.openai)==null?void 0:x.store,metadata:(f=m==null?void 0:m.openai)==null?void 0:f.metadata,prediction:(g=m==null?void 0:m.openai)==null?void 0:g.prediction,reasoning_effort:(b=(y=m==null?void 0:m.openai)==null?void 0:y.reasoningEffort)!=null?b:this.settings.reasoningEffort,messages:Y};switch(za(this.modelId)?(B.temperature!=null&&(B.temperature=void 0,O.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),B.top_p!=null&&(B.top_p=void 0,O.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),B.frequency_penalty!=null&&(B.frequency_penalty=void 0,O.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),B.presence_penalty!=null&&(B.presence_penalty=void 0,O.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),B.logit_bias!=null&&(B.logit_bias=void 0,O.push({type:"other",message:"logitBias is not supported for reasoning models"})),B.logprobs!=null&&(B.logprobs=void 0,O.push({type:"other",message:"logprobs is not supported for reasoning models"})),B.top_logprobs!=null&&(B.top_logprobs=void 0,O.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),B.max_tokens!=null&&(B.max_completion_tokens==null&&(B.max_completion_tokens=B.max_tokens),B.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&B.temperature!=null&&(B.temperature=void 0,O.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),N){case"regular":{const{tools:re,tool_choice:F,functions:M,function_call:K,toolWarnings:v}=Gh({mode:e,useLegacyFunctionCalling:I,structuredOutputs:this.supportsStructuredOutputs});return{args:{...B,tools:re,tool_choice:F,functions:M,function_call:K},warnings:[...O,...v]}}case"object-json":return{args:{...B,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(E=e.name)!=null?E:"response",description:e.description}}:{type:"json_object"}},warnings:O};case"object-tool":return{args:I?{...B,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...B,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:O};default:{const re=N;throw new Error(`Unsupported type: ${re}`)}}}async doGenerate(e){var t,a,r,n,o,l,c,d;const{args:i,warnings:u}=this.getArgs(e),{responseHeaders:m,value:w,rawValue:j}=await ut({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),body:i,failedResponseHandler:st,successfulResponseHandler:Gt(Jh),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:x,...f}=i,g=w.choices[0],y=(t=w.usage)==null?void 0:t.completion_tokens_details,b=(a=w.usage)==null?void 0:a.prompt_tokens_details,E={openai:{}};return(y==null?void 0:y.reasoning_tokens)!=null&&(E.openai.reasoningTokens=y==null?void 0:y.reasoning_tokens),(y==null?void 0:y.accepted_prediction_tokens)!=null&&(E.openai.acceptedPredictionTokens=y==null?void 0:y.accepted_prediction_tokens),(y==null?void 0:y.rejected_prediction_tokens)!=null&&(E.openai.rejectedPredictionTokens=y==null?void 0:y.rejected_prediction_tokens),(b==null?void 0:b.cached_tokens)!=null&&(E.openai.cachedPromptTokens=b==null?void 0:b.cached_tokens),{text:(r=g.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&g.message.function_call?[{toolCallType:"function",toolCallId:bt(),toolName:g.message.function_call.name,args:g.message.function_call.arguments}]:(n=g.message.tool_calls)==null?void 0:n.map(N=>{var O;return{toolCallType:"function",toolCallId:(O=N.id)!=null?O:bt(),toolName:N.function.name,args:N.function.arguments}}),finishReason:Ys(g.finish_reason),usage:{promptTokens:(l=(o=w.usage)==null?void 0:o.prompt_tokens)!=null?l:NaN,completionTokens:(d=(c=w.usage)==null?void 0:c.completion_tokens)!=null?d:NaN},rawCall:{rawPrompt:x,rawSettings:f},rawResponse:{headers:m,body:j},request:{body:JSON.stringify(i)},response:Ks(w),warnings:u,logprobs:mn(g.logprobs),providerMetadata:E}}async doStream(e){if(this.settings.simulateStreaming){const f=await this.doGenerate(e);return{stream:new ReadableStream({start(y){if(y.enqueue({type:"response-metadata",...f.response}),f.text&&y.enqueue({type:"text-delta",textDelta:f.text}),f.toolCalls)for(const b of f.toolCalls)y.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:b.toolCallId,toolName:b.toolName,argsTextDelta:b.args}),y.enqueue({type:"tool-call",...b});y.enqueue({type:"finish",finishReason:f.finishReason,usage:f.usage,logprobs:f.logprobs,providerMetadata:f.providerMetadata}),y.close()}}),rawCall:f.rawCall,rawResponse:f.rawResponse,warnings:f.warnings}}const{args:t,warnings:a}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:n,value:o}=await ut({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),body:r,failedResponseHandler:st,successfulResponseHandler:fr(Wh),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=t,d=[];let i="unknown",u={promptTokens:void 0,completionTokens:void 0},m,w=!0;const{useLegacyFunctionCalling:j}=this.settings,x={openai:{}};return{stream:o.pipeThrough(new TransformStream({transform(f,g){var y,b,E,N,O,I,Y,L,B,re,F,M;if(!f.success){i="error",g.enqueue({type:"error",error:f.error});return}const K=f.value;if("error"in K){i="error",g.enqueue({type:"error",error:K.error});return}if(w&&(w=!1,g.enqueue({type:"response-metadata",...Ks(K)})),K.usage!=null){const{prompt_tokens:ee,completion_tokens:le,prompt_tokens_details:ae,completion_tokens_details:h}=K.usage;u={promptTokens:ee??void 0,completionTokens:le??void 0},(h==null?void 0:h.reasoning_tokens)!=null&&(x.openai.reasoningTokens=h==null?void 0:h.reasoning_tokens),(h==null?void 0:h.accepted_prediction_tokens)!=null&&(x.openai.acceptedPredictionTokens=h==null?void 0:h.accepted_prediction_tokens),(h==null?void 0:h.rejected_prediction_tokens)!=null&&(x.openai.rejectedPredictionTokens=h==null?void 0:h.rejected_prediction_tokens),(ae==null?void 0:ae.cached_tokens)!=null&&(x.openai.cachedPromptTokens=ae==null?void 0:ae.cached_tokens)}const v=K.choices[0];if((v==null?void 0:v.finish_reason)!=null&&(i=Ys(v.finish_reason)),(v==null?void 0:v.delta)==null)return;const P=v.delta;P.content!=null&&g.enqueue({type:"text-delta",textDelta:P.content});const J=mn(v==null?void 0:v.logprobs);J!=null&&J.length&&(m===void 0&&(m=[]),m.push(...J));const ie=j&&P.function_call!=null?[{type:"function",id:bt(),function:P.function_call,index:0}]:P.tool_calls;if(ie!=null)for(const ee of ie){const le=ee.index;if(d[le]==null){if(ee.type!=="function")throw new ma({data:ee,message:"Expected 'function' type."});if(ee.id==null)throw new ma({data:ee,message:"Expected 'id' to be a string."});if(((y=ee.function)==null?void 0:y.name)==null)throw new ma({data:ee,message:"Expected 'function.name' to be a string."});d[le]={id:ee.id,type:"function",function:{name:ee.function.name,arguments:(b=ee.function.arguments)!=null?b:""},hasFinished:!1};const h=d[le];((E=h.function)==null?void 0:E.name)!=null&&((N=h.function)==null?void 0:N.arguments)!=null&&(h.function.arguments.length>0&&g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:h.id,toolName:h.function.name,argsTextDelta:h.function.arguments}),un(h.function.arguments)&&(g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(O=h.id)!=null?O:bt(),toolName:h.function.name,args:h.function.arguments}),h.hasFinished=!0));continue}const ae=d[le];ae.hasFinished||(((I=ee.function)==null?void 0:I.arguments)!=null&&(ae.function.arguments+=(L=(Y=ee.function)==null?void 0:Y.arguments)!=null?L:""),g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ae.id,toolName:ae.function.name,argsTextDelta:(B=ee.function.arguments)!=null?B:""}),((re=ae.function)==null?void 0:re.name)!=null&&((F=ae.function)==null?void 0:F.arguments)!=null&&un(ae.function.arguments)&&(g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(M=ae.id)!=null?M:bt(),toolName:ae.function.name,args:ae.function.arguments}),ae.hasFinished=!0))}},flush(f){var g,y;f.enqueue({type:"finish",finishReason:i,logprobs:m,usage:{promptTokens:(g=u.promptTokens)!=null?g:NaN,completionTokens:(y=u.completionTokens)!=null?y:NaN},...x!=null?{providerMetadata:x}:{}})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:n},request:{body:JSON.stringify(r)},warnings:a}}},Ti=S({prompt_tokens:W().nullish(),completion_tokens:W().nullish(),prompt_tokens_details:S({cached_tokens:W().nullish()}).nullish(),completion_tokens_details:S({reasoning_tokens:W().nullish(),accepted_prediction_tokens:W().nullish(),rejected_prediction_tokens:W().nullish()}).nullish()}).nullish(),Jh=S({id:k().nullish(),created:W().nullish(),model:k().nullish(),choices:de(S({message:S({role:te("assistant").nullish(),content:k().nullish(),function_call:S({arguments:k(),name:k()}).nullish(),tool_calls:de(S({id:k().nullish(),type:te("function"),function:S({name:k(),arguments:k()})})).nullish()}),index:W(),logprobs:S({content:de(S({token:k(),logprob:W(),top_logprobs:de(S({token:k(),logprob:W()}))})).nullable()}).nullish(),finish_reason:k().nullish()})),usage:Ti}),Wh=Ne([S({id:k().nullish(),created:W().nullish(),model:k().nullish(),choices:de(S({delta:S({role:sr(["assistant"]).nullish(),content:k().nullish(),function_call:S({name:k().optional(),arguments:k().optional()}).nullish(),tool_calls:de(S({index:W(),id:k().nullish(),type:te("function").nullish(),function:S({name:k().nullish(),arguments:k().nullish()})})).nullish()}).nullish(),logprobs:S({content:de(S({token:k(),logprob:W(),top_logprobs:de(S({token:k(),logprob:W()}))})).nullable()}).nullish(),finish_reason:k().nullish(),index:W()})),usage:Ti}),gr]);function za(e){return e.startsWith("o")}function Yh(e){return e.startsWith("gpt-4o-audio-preview")}function Kh(e){var t,a;return za(e)?(a=(t=Qh[e])==null?void 0:t.systemMessageMode)!=null?a:"developer":"system"}var Qh={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function Xh({prompt:e,inputFormat:t,user:a="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let n="";e[0].role==="system"&&(n+=`${e[0].content}

`,e=e.slice(1));for(const{role:o,content:l}of e)switch(o){case"system":throw new it({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const c=l.map(d=>{switch(d.type){case"text":return d.text;case"image":throw new Ce({functionality:"images"})}}).join("");n+=`${a}:
${c}

`;break}case"assistant":{const c=l.map(d=>{switch(d.type){case"text":return d.text;case"tool-call":throw new Ce({functionality:"tool-call messages"})}}).join("");n+=`${r}:
${c}

`;break}case"tool":throw new Ce({functionality:"tool messages"});default:{const c=o;throw new Error(`Unsupported role: ${c}`)}}return n+=`${r}:
`,{prompt:n,stopSequences:[`
${a}:`]}}function pn(e){return e==null?void 0:e.tokens.map((t,a)=>({token:t,logprob:e.token_logprobs[a],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[a]).map(([r,n])=>({token:r,logprob:n})):[]}))}var ef=class{constructor(e,t,a){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=a}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:a,maxTokens:r,temperature:n,topP:o,topK:l,frequencyPenalty:c,presencePenalty:d,stopSequences:i,responseFormat:u,seed:m}){var w;const j=e.type,x=[];l!=null&&x.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&x.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:f,stopSequences:g}=Xh({prompt:a,inputFormat:t}),y=[...g??[],...i??[]],b={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:n,top_p:o,frequency_penalty:c,presence_penalty:d,seed:m,prompt:f,stop:y.length>0?y:void 0};switch(j){case"regular":{if((w=e.tools)!=null&&w.length)throw new Ce({functionality:"tools"});if(e.toolChoice)throw new Ce({functionality:"toolChoice"});return{args:b,warnings:x}}case"object-json":throw new Ce({functionality:"object-json mode"});case"object-tool":throw new Ce({functionality:"object-tool mode"});default:{const E=j;throw new Error(`Unsupported type: ${E}`)}}}async doGenerate(e){const{args:t,warnings:a}=this.getArgs(e),{responseHeaders:r,value:n,rawValue:o}=await ut({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),body:t,failedResponseHandler:st,successfulResponseHandler:Gt(tf),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:l,...c}=t,d=n.choices[0];return{text:d.text,usage:{promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens},finishReason:Ys(d.finish_reason),logprobs:pn(d.logprobs),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:r,body:o},response:Ks(n),warnings:a,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:a}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:n,value:o}=await ut({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),body:r,failedResponseHandler:st,successfulResponseHandler:fr(sf),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:l,...c}=t;let d="unknown",i={promptTokens:Number.NaN,completionTokens:Number.NaN},u,m=!0;return{stream:o.pipeThrough(new TransformStream({transform(w,j){if(!w.success){d="error",j.enqueue({type:"error",error:w.error});return}const x=w.value;if("error"in x){d="error",j.enqueue({type:"error",error:x.error});return}m&&(m=!1,j.enqueue({type:"response-metadata",...Ks(x)})),x.usage!=null&&(i={promptTokens:x.usage.prompt_tokens,completionTokens:x.usage.completion_tokens});const f=x.choices[0];(f==null?void 0:f.finish_reason)!=null&&(d=Ys(f.finish_reason)),(f==null?void 0:f.text)!=null&&j.enqueue({type:"text-delta",textDelta:f.text});const g=pn(f==null?void 0:f.logprobs);g!=null&&g.length&&(u===void 0&&(u=[]),u.push(...g))},flush(w){w.enqueue({type:"finish",finishReason:d,logprobs:u,usage:i})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:n},warnings:a,request:{body:JSON.stringify(r)}}}},tf=S({id:k().nullish(),created:W().nullish(),model:k().nullish(),choices:de(S({text:k(),finish_reason:k(),logprobs:S({tokens:de(k()),token_logprobs:de(W()),top_logprobs:de(ds(k(),W())).nullable()}).nullish()})),usage:S({prompt_tokens:W(),completion_tokens:W()})}),sf=Ne([S({id:k().nullish(),created:W().nullish(),model:k().nullish(),choices:de(S({text:k(),finish_reason:k().nullish(),index:W(),logprobs:S({tokens:de(k()),token_logprobs:de(W()),top_logprobs:de(ds(k(),W())).nullable()}).nullish()})),usage:S({prompt_tokens:W(),completion_tokens:W()}).nullish()}),gr]),af=class{constructor(e,t,a){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=a}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:a}){if(e.length>this.maxEmbeddingsPerCall)throw new nd({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:n}=await ut({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:tt(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:st,successfulResponseHandler:Gt(rf),abortSignal:a,fetch:this.config.fetch});return{embeddings:n.data.map(o=>o.embedding),usage:n.usage?{tokens:n.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},rf=S({data:de(S({embedding:de(W())})),usage:S({prompt_tokens:W()}).nullish()}),nf={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},of=new Set(["gpt-image-1"]),lf=class{constructor(e,t,a){this.modelId=e,this.settings=t,this.config=a,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:nf[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:a,aspectRatio:r,seed:n,providerOptions:o,headers:l,abortSignal:c}){var d,i,u,m;const w=[];r!=null&&w.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),n!=null&&w.push({type:"unsupported-setting",setting:"seed"});const j=(u=(i=(d=this.config._internal)==null?void 0:d.currentDate)==null?void 0:i.call(d))!=null?u:new Date,{value:x,responseHeaders:f}=await ut({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:tt(this.config.headers(),l),body:{model:this.modelId,prompt:e,n:t,size:a,...(m=o.openai)!=null?m:{},...of.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:st,successfulResponseHandler:Gt(cf),abortSignal:c,fetch:this.config.fetch});return{images:x.data.map(g=>g.b64_json),warnings:w,response:{timestamp:j,modelId:this.modelId,headers:f}}}},cf=S({data:de(S({b64_json:k()}))}),df=S({include:de(k()).nullish(),language:k().nullish(),prompt:k().nullish(),temperature:W().min(0).max(1).nullish().default(0),timestampGranularities:de(sr(["word","segment"])).nullish().default(["segment"])}),hn={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},uf=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:a}){var r,n,o,l,c;const d=[],i=hr({provider:"openai",providerOptions:a,schema:df}),u=new FormData,m=e instanceof Uint8Array?new Blob([e]):new Blob([qh(e)]);if(u.append("model",this.modelId),u.append("file",new File([m],"audio",{type:t})),i){const w={include:(r=i.include)!=null?r:void 0,language:(n=i.language)!=null?n:void 0,prompt:(o=i.prompt)!=null?o:void 0,temperature:(l=i.temperature)!=null?l:void 0,timestamp_granularities:(c=i.timestampGranularities)!=null?c:void 0};for(const j in w){const x=w[j];x!==void 0&&u.append(j,String(x))}}return{formData:u,warnings:d}}async doGenerate(e){var t,a,r,n,o,l;const c=(r=(a=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:a.call(t))!=null?r:new Date,{formData:d,warnings:i}=this.getArgs(e),{value:u,responseHeaders:m,rawValue:w}=await Lh({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),formData:d,failedResponseHandler:st,successfulResponseHandler:Gt(mf),abortSignal:e.abortSignal,fetch:this.config.fetch}),j=u.language!=null&&u.language in hn?hn[u.language]:void 0;return{text:u.text,segments:(o=(n=u.words)==null?void 0:n.map(x=>({text:x.word,startSecond:x.start,endSecond:x.end})))!=null?o:[],language:j,durationInSeconds:(l=u.duration)!=null?l:void 0,warnings:i,response:{timestamp:c,modelId:this.modelId,headers:m,body:w}}}},mf=S({text:k(),language:k().nullish(),duration:W().nullish(),words:de(S({word:k(),start:W(),end:W()})).nullish()});function pf({prompt:e,systemMessageMode:t}){const a=[],r=[];for(const{role:n,content:o}of e)switch(n){case"system":{switch(t){case"system":{a.push({role:"system",content:o});break}case"developer":{a.push({role:"developer",content:o});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const l=t;throw new Error(`Unsupported system message mode: ${l}`)}}break}case"user":{a.push({role:"user",content:o.map((l,c)=>{var d,i,u,m;switch(l.type){case"text":return{type:"input_text",text:l.text};case"image":return{type:"input_image",image_url:l.image instanceof URL?l.image.toString():`data:${(d=l.mimeType)!=null?d:"image/jpeg"};base64,${Ci(l.image)}`,detail:(u=(i=l.providerMetadata)==null?void 0:i.openai)==null?void 0:u.imageDetail};case"file":{if(l.data instanceof URL)throw new Ce({functionality:"File URLs in user messages"});switch(l.mimeType){case"application/pdf":return{type:"input_file",filename:(m=l.filename)!=null?m:`part-${c}.pdf`,file_data:`data:application/pdf;base64,${l.data}`};default:throw new Ce({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const l of o)switch(l.type){case"text":{a.push({role:"assistant",content:[{type:"output_text",text:l.text}]});break}case"tool-call":{a.push({type:"function_call",call_id:l.toolCallId,name:l.toolName,arguments:JSON.stringify(l.args)});break}}break}case"tool":{for(const l of o)a.push({type:"function_call_output",call_id:l.toolCallId,output:JSON.stringify(l.result)});break}default:{const l=n;throw new Error(`Unsupported role: ${l}`)}}return{messages:a,warnings:r}}function fn({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function hf({mode:e,strict:t}){var a;const r=(a=e.tools)!=null&&a.length?e.tools:void 0,n=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:n};const o=e.toolChoice,l=[];for(const d of r)switch(d.type){case"function":l.push({type:"function",name:d.name,description:d.description,parameters:d.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(d.id){case"openai.web_search_preview":l.push({type:"web_search_preview",search_context_size:d.args.searchContextSize,user_location:d.args.userLocation});break;default:n.push({type:"unsupported-tool",tool:d});break}break;default:n.push({type:"unsupported-tool",tool:d});break}if(o==null)return{tools:l,tool_choice:void 0,toolWarnings:n};const c=o.type;switch(c){case"auto":case"none":case"required":return{tools:l,tool_choice:c,toolWarnings:n};case"tool":return o.toolName==="web_search_preview"?{tools:l,tool_choice:{type:"web_search_preview"},toolWarnings:n}:{tools:l,tool_choice:{type:"function",name:o.toolName},toolWarnings:n};default:{const d=c;throw new Ce({functionality:`Unsupported tool choice type: ${d}`})}}}var ff=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:a,stopSequences:r,topP:n,topK:o,presencePenalty:l,frequencyPenalty:c,seed:d,prompt:i,providerMetadata:u,responseFormat:m}){var w,j,x;const f=[],g=Pf(this.modelId),y=e.type;o!=null&&f.push({type:"unsupported-setting",setting:"topK"}),d!=null&&f.push({type:"unsupported-setting",setting:"seed"}),l!=null&&f.push({type:"unsupported-setting",setting:"presencePenalty"}),c!=null&&f.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&f.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:b,warnings:E}=pf({prompt:i,systemMessageMode:g.systemMessageMode});f.push(...E);const N=hr({provider:"openai",providerOptions:u,schema:Df}),O=(w=N==null?void 0:N.strictSchemas)!=null?w:!0,I={model:this.modelId,input:b,temperature:a,top_p:n,max_output_tokens:t,...(m==null?void 0:m.type)==="json"&&{text:{format:m.schema!=null?{type:"json_schema",strict:O,name:(j=m.name)!=null?j:"response",description:m.description,schema:m.schema}:{type:"json_object"}}},metadata:N==null?void 0:N.metadata,parallel_tool_calls:N==null?void 0:N.parallelToolCalls,previous_response_id:N==null?void 0:N.previousResponseId,store:N==null?void 0:N.store,user:N==null?void 0:N.user,instructions:N==null?void 0:N.instructions,...g.isReasoningModel&&((N==null?void 0:N.reasoningEffort)!=null||(N==null?void 0:N.reasoningSummary)!=null)&&{reasoning:{...(N==null?void 0:N.reasoningEffort)!=null&&{effort:N.reasoningEffort},...(N==null?void 0:N.reasoningSummary)!=null&&{summary:N.reasoningSummary}}},...g.requiredAutoTruncation&&{truncation:"auto"}};switch(g.isReasoningModel&&(I.temperature!=null&&(I.temperature=void 0,f.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,f.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),y){case"regular":{const{tools:Y,tool_choice:L,toolWarnings:B}=hf({mode:e,strict:O});return{args:{...I,tools:Y,tool_choice:L},warnings:[...f,...B]}}case"object-json":return{args:{...I,text:{format:e.schema!=null?{type:"json_schema",strict:O,name:(x=e.name)!=null?x:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:f};case"object-tool":return{args:{...I,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:O}]},warnings:f};default:{const Y=y;throw new Error(`Unsupported type: ${Y}`)}}}async doGenerate(e){var t,a,r,n,o,l,c;const{args:d,warnings:i}=this.getArgs(e),{responseHeaders:u,value:m,rawValue:w}=await ut({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),body:d,failedResponseHandler:st,successfulResponseHandler:Gt(S({id:k(),created_at:W(),model:k(),output:de(tr("type",[S({type:te("message"),role:te("assistant"),content:de(S({type:te("output_text"),text:k(),annotations:de(S({type:te("url_citation"),start_index:W(),end_index:W(),url:k(),title:k()}))}))}),S({type:te("function_call"),call_id:k(),name:k(),arguments:k()}),S({type:te("web_search_call")}),S({type:te("computer_call")}),S({type:te("reasoning"),summary:de(S({type:te("summary_text"),text:k()}))})])),incomplete_details:S({reason:k()}).nullable(),usage:Ei})),abortSignal:e.abortSignal,fetch:this.config.fetch}),j=m.output.filter(g=>g.type==="message").flatMap(g=>g.content).filter(g=>g.type==="output_text"),x=m.output.filter(g=>g.type==="function_call").map(g=>({toolCallType:"function",toolCallId:g.call_id,toolName:g.name,args:g.arguments})),f=(a=(t=m.output.find(g=>g.type==="reasoning"))==null?void 0:t.summary)!=null?a:null;return{text:j.map(g=>g.text).join(`
`),sources:j.flatMap(g=>g.annotations.map(y=>{var b,E,N;return{sourceType:"url",id:(N=(E=(b=this.config).generateId)==null?void 0:E.call(b))!=null?N:bt(),url:y.url,title:y.title}})),finishReason:fn({finishReason:(r=m.incomplete_details)==null?void 0:r.reason,hasToolCalls:x.length>0}),toolCalls:x.length>0?x:void 0,reasoning:f?f.map(g=>({type:"text",text:g.text})):void 0,usage:{promptTokens:m.usage.input_tokens,completionTokens:m.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:w},request:{body:JSON.stringify(d)},response:{id:m.id,timestamp:new Date(m.created_at*1e3),modelId:m.model},providerMetadata:{openai:{responseId:m.id,cachedPromptTokens:(o=(n=m.usage.input_tokens_details)==null?void 0:n.cached_tokens)!=null?o:null,reasoningTokens:(c=(l=m.usage.output_tokens_details)==null?void 0:l.reasoning_tokens)!=null?c:null}},warnings:i}}async doStream(e){const{args:t,warnings:a}=this.getArgs(e),{responseHeaders:r,value:n}=await ut({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:st,successfulResponseHandler:fr(_f),abortSignal:e.abortSignal,fetch:this.config.fetch}),o=this;let l="unknown",c=NaN,d=NaN,i=null,u=null,m=null;const w={};let j=!1;return{stream:n.pipeThrough(new TransformStream({transform(x,f){var g,y,b,E,N,O,I,Y;if(!x.success){l="error",f.enqueue({type:"error",error:x.error});return}const L=x.value;if(If(L))L.item.type==="function_call"&&(w[L.output_index]={toolName:L.item.name,toolCallId:L.item.call_id},f.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:L.item.call_id,toolName:L.item.name,argsTextDelta:L.item.arguments}));else if(Ef(L)){const B=w[L.output_index];B!=null&&f.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:B.toolCallId,toolName:B.toolName,argsTextDelta:L.delta})}else Tf(L)?(m=L.response.id,f.enqueue({type:"response-metadata",id:L.response.id,timestamp:new Date(L.response.created_at*1e3),modelId:L.response.model})):kf(L)?f.enqueue({type:"text-delta",textDelta:L.delta}):Af(L)?f.enqueue({type:"reasoning",textDelta:L.delta}):Sf(L)&&L.item.type==="function_call"?(w[L.output_index]=void 0,j=!0,f.enqueue({type:"tool-call",toolCallType:"function",toolCallId:L.item.call_id,toolName:L.item.name,args:L.item.arguments})):Cf(L)?(l=fn({finishReason:(g=L.response.incomplete_details)==null?void 0:g.reason,hasToolCalls:j}),c=L.response.usage.input_tokens,d=L.response.usage.output_tokens,i=(b=(y=L.response.usage.input_tokens_details)==null?void 0:y.cached_tokens)!=null?b:i,u=(N=(E=L.response.usage.output_tokens_details)==null?void 0:E.reasoning_tokens)!=null?N:u):$f(L)&&f.enqueue({type:"source",source:{sourceType:"url",id:(Y=(I=(O=o.config).generateId)==null?void 0:I.call(O))!=null?Y:bt(),url:L.annotation.url,title:L.annotation.title}})},flush(x){x.enqueue({type:"finish",finishReason:l,usage:{promptTokens:c,completionTokens:d},...(i!=null||u!=null)&&{providerMetadata:{openai:{responseId:m,cachedPromptTokens:i,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:a}}},Ei=S({input_tokens:W(),input_tokens_details:S({cached_tokens:W().nullish()}).nullish(),output_tokens:W(),output_tokens_details:S({reasoning_tokens:W().nullish()}).nullish()}),gf=S({type:te("response.output_text.delta"),delta:k()}),xf=S({type:sr(["response.completed","response.incomplete"]),response:S({incomplete_details:S({reason:k()}).nullish(),usage:Ei})}),yf=S({type:te("response.created"),response:S({id:k(),created_at:W(),model:k()})}),bf=S({type:te("response.output_item.done"),output_index:W(),item:tr("type",[S({type:te("message")}),S({type:te("function_call"),id:k(),call_id:k(),name:k(),arguments:k(),status:te("completed")})])}),vf=S({type:te("response.function_call_arguments.delta"),item_id:k(),output_index:W(),delta:k()}),jf=S({type:te("response.output_item.added"),output_index:W(),item:tr("type",[S({type:te("message")}),S({type:te("function_call"),id:k(),call_id:k(),name:k(),arguments:k()})])}),wf=S({type:te("response.output_text.annotation.added"),annotation:S({type:te("url_citation"),url:k(),title:k()})}),Nf=S({type:te("response.reasoning_summary_text.delta"),item_id:k(),output_index:W(),summary_index:W(),delta:k()}),_f=Ne([gf,xf,yf,bf,vf,jf,wf,Nf,S({type:k()}).passthrough()]);function kf(e){return e.type==="response.output_text.delta"}function Sf(e){return e.type==="response.output_item.done"}function Cf(e){return e.type==="response.completed"||e.type==="response.incomplete"}function Tf(e){return e.type==="response.created"}function Ef(e){return e.type==="response.function_call_arguments.delta"}function If(e){return e.type==="response.output_item.added"}function $f(e){return e.type==="response.output_text.annotation.added"}function Af(e){return e.type==="response.reasoning_summary_text.delta"}function Pf(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var Df=S({metadata:wo().nullish(),parallelToolCalls:Qe().nullish(),previousResponseId:k().nullish(),store:Qe().nullish(),user:k().nullish(),reasoningEffort:k().nullish(),strictSchemas:Qe().nullish(),instructions:k().nullish(),reasoningSummary:k().nullish()}),Rf=S({});function Mf({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:Rf}}var Of={webSearchPreview:Mf},Lf=S({instructions:k().nullish(),speed:W().min(.25).max(4).default(1).nullish()}),Ff=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:a="mp3",speed:r,instructions:n,providerOptions:o}){const l=[],c=hr({provider:"openai",providerOptions:o,schema:Lf}),d={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:n};if(a&&(["mp3","opus","aac","flac","wav","pcm"].includes(a)?d.response_format=a:l.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${a}. Using mp3 instead.`})),c){const i={};for(const u in i){const m=i[u];m!==void 0&&(d[u]=m)}}return{requestBody:d,warnings:l}}async doGenerate(e){var t,a,r;const n=(r=(a=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:a.call(t))!=null?r:new Date,{requestBody:o,warnings:l}=this.getArgs(e),{value:c,responseHeaders:d,rawValue:i}=await ut({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:tt(this.config.headers(),e.headers),body:o,failedResponseHandler:st,successfulResponseHandler:Uh(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:c,warnings:l,request:{body:JSON.stringify(o)},response:{timestamp:n,modelId:this.modelId,headers:d,body:i}}}};function Qs(e={}){var t,a,r;const n=(t=Zh(e.baseURL))!=null?t:"https://api.openai.com/v1",o=(a=e.compatibility)!=null?a:"compatible",l=(r=e.name)!=null?r:"openai",c=()=>({Authorization:`Bearer ${Ih({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),d=(y,b={})=>new Hh(y,b,{provider:`${l}.chat`,url:({path:E})=>`${n}${E}`,headers:c,compatibility:o,fetch:e.fetch}),i=(y,b={})=>new ef(y,b,{provider:`${l}.completion`,url:({path:E})=>`${n}${E}`,headers:c,compatibility:o,fetch:e.fetch}),u=(y,b={})=>new af(y,b,{provider:`${l}.embedding`,url:({path:E})=>`${n}${E}`,headers:c,fetch:e.fetch}),m=(y,b={})=>new lf(y,b,{provider:`${l}.image`,url:({path:E})=>`${n}${E}`,headers:c,fetch:e.fetch}),w=y=>new uf(y,{provider:`${l}.transcription`,url:({path:b})=>`${n}${b}`,headers:c,fetch:e.fetch}),j=y=>new Ff(y,{provider:`${l}.speech`,url:({path:b})=>`${n}${b}`,headers:c,fetch:e.fetch}),x=(y,b)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return y==="gpt-3.5-turbo-instruct"?i(y,b):d(y,b)},f=y=>new ff(y,{provider:`${l}.responses`,url:({path:b})=>`${n}${b}`,headers:c,fetch:e.fetch}),g=function(y,b){return x(y,b)};return g.languageModel=x,g.chat=d,g.completion=i,g.responses=f,g.embedding=u,g.textEmbedding=u,g.textEmbeddingModel=u,g.image=m,g.imageModel=m,g.transcription=w,g.transcriptionModel=w,g.speech=j,g.speechModel=j,g.tools=Of,g}Qs({compatibility:"strict"});const Uf=({event:e,isOpen:t,onClose:a})=>{const{settings:r,updateEvent:n}=Ae(),[o,l]=T.useState(null),[c,d]=T.useState([]),[i,u]=T.useState([]),[m,w]=T.useState(!1),[j,x]=T.useState(8.5),[f,g]=T.useState(0),[y,b]=T.useState(""),[E,N]=T.useState(!1),[O,I]=T.useState(!1);T.useEffect(()=>{t&&e&&Y()},[t,e]);const Y=()=>{var ge,Oe;const _=`INV-${e.id.slice(-6).toUpperCase()}`,V=new Date().toISOString().split("T")[0],q=new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],$=((ge=e.pricing)==null?void 0:ge.menuItems)||[{id:"1",name:"Event Package",price:250,quantity:1,description:"Base event package"}],oe=((Oe=e.pricing)==null?void 0:Oe.deposits)||[];d($),u(oe),b(e.contact.email);const G=$.reduce((mt,Fe)=>mt+Fe.price*Fe.quantity,0),xe=(G-f)*(j/100),ye=G-f+xe,fe=oe.reduce((mt,Fe)=>mt+Fe.amount,0),Te={eventId:e.id,invoiceNumber:_,issueDate:V,dueDate:q,customerInfo:{name:e.contact.name,email:e.contact.email,phone:e.contact.phone},eventDetails:{title:e.title,date:me(new Date(e.date),"MMMM dd, yyyy"),time:`${L(e.startTime)} - ${L(e.endTime)}`,venue:e.venue},lineItems:$,subtotal:G,taxAmount:xe,discount:f,total:ye,amountPaid:fe,remainingBalance:ye-fe,terms:"Payment due within 30 days. Late payments may incur fees."};l(Te)},L=_=>{const[V,q]=_.split(":").map(Number),$=V>=12?"PM":"AM";return`${V===0?12:V>12?V-12:V}:${q.toString().padStart(2,"0")} ${$}`},B=()=>{const _={id:Date.now().toString(),name:"",price:0,quantity:1,description:""};d([...c,_])},re=(_,V,q)=>{d(c.map($=>$.id===_?{...$,[V]:q}:$))},F=_=>{d(c.filter(V=>V.id!==_))},M=()=>{const _={id:Date.now().toString(),amount:0,method:"cash",date:new Date().toISOString().split("T")[0],notes:""};u([...i,_])},K=(_,V,q)=>{u(i.map($=>$.id===_?{...$,[V]:q}:$))},v=_=>{u(i.filter(V=>V.id!==_))},P=()=>{const _=c.reduce((G,xe)=>G+xe.price*xe.quantity,0),V=(_-f)*(j/100),q=_-f+V,$=i.reduce((G,xe)=>G+xe.amount,0),oe=q-$;return{subtotal:_,taxAmount:V,total:q,amountPaid:$,remainingBalance:oe}},J=()=>{const{subtotal:_,taxAmount:V,total:q,amountPaid:$,remainingBalance:oe}=P(),G={mode:"custom",menuItems:c,personCount:0,pricePerPerson:0,customPlatters:[],subtotal:_,discount:{type:"fixed",value:f,amount:f},taxRate:j,taxAmount:V,includeTax:!0,total:q,deposits:i,amountPaid:$,remainingBalance:oe};n(e.id,{pricing:G,paymentStatus:oe<=0?"paid":"unpaid"}),w(!1)},ie=async()=>{var V,q;if(!o)return;N(!0);const _=Date.now();console.log("📄 Starting PDF generation for invoice:",{invoiceNumber:o.invoiceNumber,customer:o.customerInfo.name,total:o.total});try{const $=(q=(V=globalThis.ywConfig)==null?void 0:V.ai_config)==null?void 0:q.pdf_content_generator;if(!$)throw new Error("PDF generator configuration not found");const oe=Qs({baseURL:"https://api.youware.com/public/v1/ai",apiKey:"sk-YOUWARE"}),G=`${r.storeName}, ${r.storeEmail}, ${r.storePhone}`,{text:xe}=await qa({model:oe($.model),messages:[{role:"system",content:$.system_prompt({documentType:"invoice",businessInfo:G})},{role:"user",content:`Generate a professional HTML invoice document with the following data:
            
Business: ${r.storeName}
Address: ${r.storeAddress}
Contact: ${r.storeEmail}, ${r.storePhone}

Invoice: ${o.invoiceNumber}
Date: ${o.issueDate}
Due Date: ${o.dueDate}

Customer: ${o.customerInfo.name}
Email: ${o.customerInfo.email}
Phone: ${o.customerInfo.phone}

Event: ${o.eventDetails.title}
Date: ${o.eventDetails.date}
Time: ${o.eventDetails.time}
Venue: ${o.eventDetails.venue}

Line Items:
${o.lineItems.map(ge=>`- ${ge.name}: $${ge.price.toFixed(2)} x ${ge.quantity} = $${(ge.price*ge.quantity).toFixed(2)}`).join(`
`)}

Subtotal: $${o.subtotal.toFixed(2)}
Discount: $${o.discount.toFixed(2)}
Tax (${j}%): $${o.taxAmount.toFixed(2)}
Total: $${o.total.toFixed(2)}

Deposits Paid:
${i.map(ge=>`- ${ge.date}: $${ge.amount.toFixed(2)} (${ge.method})`).join(`
`)}
Amount Paid: $${o.amountPaid.toFixed(2)}
Remaining Balance: $${o.remainingBalance.toFixed(2)}

Terms: ${o.terms}

Create a professional, printable HTML invoice with proper styling, company branding, and clear layout.`}],temperature:$.temperature||.3,maxTokens:$.maxTokens||6e3});console.log("✅ PDF content generated successfully:",{contentLength:xe.length,processingTime:`${Date.now()-_}ms`});const ye=new Blob([xe],{type:"text/html"}),fe=URL.createObjectURL(ye),Te=document.createElement("a");Te.href=fe,Te.download=`${o.invoiceNumber}_${o.customerInfo.name.replace(/\s+/g,"_")}.html`,document.body.appendChild(Te),Te.click(),document.body.removeChild(Te),URL.revokeObjectURL(fe)}catch($){console.error("❌ PDF generation failed:",{error:$.message,processingTime:`${Date.now()-_}ms`}),alert(`PDF generation failed: ${$.message}`)}finally{N(!1)}},ee=async()=>{var V,q;if(!o||!y)return;I(!0);const _=Date.now();console.log("📧 Starting invoice email generation:",{recipient:y,invoiceNumber:o.invoiceNumber,customer:o.customerInfo.name});try{const $=(q=(V=globalThis.ywConfig)==null?void 0:V.ai_config)==null?void 0:q.email_generator;if(!$)throw new Error("Email generator configuration not found");const oe=Qs({baseURL:"https://api.youware.com/public/v1/ai",apiKey:"sk-YOUWARE"}),G=`${r.storeName} - Event Management & Catering`,{text:xe}=await qa({model:oe($.model),messages:[{role:"system",content:$.system_prompt({emailType:"invoice",businessContext:G})},{role:"user",content:`Generate a professional invoice email for:

Business: ${r.storeName}
Customer: ${o.customerInfo.name}
Invoice: ${o.invoiceNumber}
Event: ${o.eventDetails.title}
Date: ${o.eventDetails.date}
Total: $${o.total.toFixed(2)}
Amount Paid: $${o.amountPaid.toFixed(2)}
Balance Due: $${o.remainingBalance.toFixed(2)}
Due Date: ${me(new Date(o.dueDate),"MMMM dd, yyyy")}

Include:
- Professional subject line
- Friendly greeting
- Invoice details summary
- Payment instructions
- Contact information
- Professional closing

Make it warm but professional, suitable for hospitality business.`}],temperature:$.temperature||.7,maxTokens:$.maxTokens||4e3});console.log("✅ Email content generated successfully:",{contentLength:xe.length,processingTime:`${Date.now()-_}ms`});const ye=`Invoice ${o.invoiceNumber} - ${o.eventDetails.title}`,fe=encodeURIComponent(xe),Te=`mailto:${y}?subject=${encodeURIComponent(ye)}&body=${fe}`;window.open(Te),alert("Email client opened with generated invoice email content!")}catch($){console.error("❌ Email generation failed:",{error:$.message,processingTime:`${Date.now()-_}ms`}),alert(`Email generation failed: ${$.message}`)}finally{I(!1)}},{subtotal:le,taxAmount:ae,total:h,amountPaid:C,remainingBalance:z}=P();return!t||!o?null:s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ft,{className:"h-6 w-6 text-amber-600"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Invoice"}),s.jsx("p",{className:"text-slate-600",children:o.invoiceNumber})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>w(!m),className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-lg font-medium transition-colors",children:m?"Save Changes":"Edit Invoice"}),s.jsx("button",{onClick:a,className:"p-2 text-slate-600 hover:text-slate-800 transition-colors",children:s.jsx(Ut,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-slate-800 mb-2",children:"From:"}),s.jsxs("div",{className:"text-slate-600",children:[s.jsx("p",{className:"font-medium",children:r.storeName}),s.jsx("p",{children:r.storeAddress}),s.jsx("p",{children:r.storeEmail}),s.jsx("p",{children:r.storePhone})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-slate-800 mb-2",children:"Bill To:"}),s.jsxs("div",{className:"text-slate-600",children:[s.jsx("p",{className:"font-medium",children:o.customerInfo.name}),s.jsx("p",{children:o.customerInfo.email}),s.jsx("p",{children:o.customerInfo.phone})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8 p-4 bg-slate-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-600",children:"Invoice Date"}),s.jsx("p",{className:"font-medium",children:me(new Date(o.issueDate),"MMM dd, yyyy")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-600",children:"Due Date"}),s.jsx("p",{className:"font-medium",children:me(new Date(o.dueDate),"MMM dd, yyyy")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-600",children:"Event Date"}),s.jsx("p",{className:"font-medium",children:o.eventDetails.date})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"font-semibold text-slate-800 mb-4",children:"Event Details"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-blue-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-600",children:"Event"}),s.jsx("p",{className:"font-medium",children:o.eventDetails.title})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-600",children:"Time"}),s.jsx("p",{className:"font-medium",children:o.eventDetails.time})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-600",children:"Venue"}),s.jsx("p",{className:"font-medium capitalize",children:o.eventDetails.venue})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-slate-800",children:"Line Items"}),m&&s.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors",children:[s.jsx(Je,{className:"h-4 w-4"}),"Add Item"]})]}),s.jsx("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-slate-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left p-3 text-sm font-medium text-slate-600",children:"Description"}),s.jsx("th",{className:"text-right p-3 text-sm font-medium text-slate-600",children:"Price"}),s.jsx("th",{className:"text-center p-3 text-sm font-medium text-slate-600",children:"Qty"}),s.jsx("th",{className:"text-right p-3 text-sm font-medium text-slate-600",children:"Total"}),m&&s.jsx("th",{className:"w-10"})]})}),s.jsx("tbody",{children:c.map((_,V)=>s.jsxs("tr",{className:"border-t border-slate-200",children:[s.jsx("td",{className:"p-3",children:m?s.jsxs("div",{children:[s.jsx("input",{type:"text",value:_.name,onChange:q=>re(_.id,"name",q.target.value),className:"w-full p-2 border border-slate-300 rounded mb-1",placeholder:"Item name"}),s.jsx("input",{type:"text",value:_.description||"",onChange:q=>re(_.id,"description",q.target.value),className:"w-full p-2 border border-slate-300 rounded text-sm",placeholder:"Description (optional)"})]}):s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:_.name}),_.description&&s.jsx("p",{className:"text-sm text-slate-600",children:_.description})]})}),s.jsx("td",{className:"p-3 text-right",children:m?s.jsx("input",{type:"number",value:_.price,onChange:q=>re(_.id,"price",parseFloat(q.target.value)||0),className:"w-20 p-2 border border-slate-300 rounded text-right",min:"0",step:"0.01"}):`$${_.price.toFixed(2)}`}),s.jsx("td",{className:"p-3 text-center",children:m?s.jsx("input",{type:"number",value:_.quantity,onChange:q=>re(_.id,"quantity",parseInt(q.target.value)||1),className:"w-16 p-2 border border-slate-300 rounded text-center",min:"1"}):_.quantity}),s.jsxs("td",{className:"p-3 text-right font-medium",children:["$",(_.price*_.quantity).toFixed(2)]}),m&&s.jsx("td",{className:"p-3",children:s.jsx("button",{onClick:()=>F(_.id),className:"p-1 text-red-600 hover:text-red-800 transition-colors",children:s.jsx(Ir,{className:"h-4 w-4"})})})]},_.id))})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-slate-800 mb-4",children:"Invoice Summary"}),s.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 rounded-lg",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Subtotal:"}),s.jsxs("span",{children:["$",le.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Discount:"}),s.jsx("div",{className:"flex items-center gap-2",children:m?s.jsx("input",{type:"number",value:f,onChange:_=>g(parseFloat(_.target.value)||0),className:"w-20 p-1 border border-slate-300 rounded text-right text-sm",min:"0",step:"0.01"}):s.jsxs("span",{children:["-$",f.toFixed(2)]})})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{children:["Tax (",j,"%):"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[m&&s.jsx("input",{type:"number",value:j,onChange:_=>x(parseFloat(_.target.value)||0),className:"w-16 p-1 border border-slate-300 rounded text-right text-sm",min:"0",max:"50",step:"0.1"}),s.jsxs("span",{children:["$",ae.toFixed(2)]})]})]}),s.jsx("div",{className:"border-t border-slate-300 pt-3 font-semibold text-lg",children:s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Total:"}),s.jsxs("span",{children:["$",h.toFixed(2)]})]})})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-slate-800",children:"Payments & Deposits"}),m&&s.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:[s.jsx(Je,{className:"h-4 w-4"}),"Add Payment"]})]}),s.jsxs("div",{className:"space-y-3",children:[i.map(_=>s.jsx("div",{className:"p-3 border border-slate-200 rounded-lg",children:m?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",value:_.date,onChange:V=>K(_.id,"date",V.target.value),className:"flex-1 p-2 border border-slate-300 rounded text-sm"}),s.jsx("button",{onClick:()=>v(_.id),className:"p-2 text-red-600 hover:text-red-800 transition-colors",children:s.jsx(Ir,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"number",value:_.amount,onChange:V=>K(_.id,"amount",parseFloat(V.target.value)||0),className:"w-24 p-2 border border-slate-300 rounded text-sm",placeholder:"Amount",min:"0",step:"0.01"}),s.jsxs("select",{value:_.method,onChange:V=>K(_.id,"method",V.target.value),className:"flex-1 p-2 border border-slate-300 rounded text-sm",children:[s.jsx("option",{value:"cash",children:"Cash"}),s.jsx("option",{value:"credit_card",children:"Credit Card"}),s.jsx("option",{value:"check",children:"Check"})]})]}),s.jsx("input",{type:"text",value:_.notes||"",onChange:V=>K(_.id,"notes",V.target.value),className:"w-full p-2 border border-slate-300 rounded text-sm",placeholder:"Notes (optional)"})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium",children:["$",_.amount.toFixed(2)]}),s.jsx("p",{className:"text-sm text-slate-600 capitalize",children:_.method.replace("_"," ")})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-sm",children:me(new Date(_.date),"MMM dd, yyyy")})})]}),_.notes&&s.jsx("p",{className:"text-sm text-slate-600 mt-2",children:_.notes})]})},_.id)),s.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium text-green-800",children:"Amount Paid:"}),s.jsxs("span",{className:"font-semibold text-green-800",children:["$",C.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsx("span",{className:`font-medium ${z>0?"text-red-800":"text-green-800"}`,children:"Remaining Balance:"}),s.jsxs("span",{className:`font-semibold ${z>0?"text-red-800":"text-green-800"}`,children:["$",z.toFixed(2)]})]})]})]})]})]}),s.jsx("div",{className:"border-t border-slate-200 pt-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email Address for Invoice"}),s.jsx("input",{type:"email",value:y,onChange:_=>b(_.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Enter email address"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:ie,disabled:E,className:"flex items-center gap-2 px-6 py-3 bg-slate-600 hover:bg-slate-700 disabled:bg-slate-400 text-white rounded-lg font-medium transition-colors",children:[E?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(Lt,{className:"h-4 w-4"}),E?"Generating...":"Download PDF"]}),s.jsxs("button",{onClick:ee,disabled:O||!y,className:"flex items-center gap-2 px-6 py-3 bg-amber-600 hover:bg-amber-700 disabled:bg-amber-400 text-white rounded-lg font-medium transition-colors",children:[O?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(ea,{className:"h-4 w-4"}),O?"Generating...":"Send Email"]})]})]})}),m&&s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ka,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-blue-800",children:"Editing Mode Active"})]}),s.jsx("button",{onClick:J,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Save Changes"})]}),s.jsx("p",{className:"text-sm text-blue-700 mt-2",children:'Make changes to line items, payments, and pricing. Click "Save Changes" to update the event record.'})]})]})]})})},Vf=({isOpen:e,onClose:t})=>{const{events:a}=Ae(),[r,n]=T.useState("monthly"),[o,l]=T.useState({start:me(Na(new Date),"yyyy-MM-dd"),end:me(_a(new Date),"yyyy-MM-dd")}),c=T.useMemo(()=>{let x=a;const f=new Date;let g;switch(r){case"daily":g={start:me(sl(f),"yyyy-MM-dd"),end:me(tl(f),"yyyy-MM-dd")};break;case"monthly":g={start:me(Na(f),"yyyy-MM-dd"),end:me(_a(f),"yyyy-MM-dd")};break;case"yearly":g={start:me(el(f),"yyyy-MM-dd"),end:me(Xi(f),"yyyy-MM-dd")};break;case"custom":g=o;break}x=a.filter(B=>{const re=Pt(B.date);return al(re,{start:Pt(g.start),end:Pt(g.end)})});let y=0,b=0,E=0;const N={cash:0,credit_card:0,check:0},O={},I={},Y={};x.forEach(B=>{var ae,h,C,z;const re=((ae=B.pricing)==null?void 0:ae.total)||0,F=((h=B.pricing)==null?void 0:h.amountPaid)||0,M=((C=B.pricing)==null?void 0:C.deposits)||[],K=((z=B.pricing)==null?void 0:z.remainingBalance)||0,v=M.reduce((_,V)=>_+V.amount,0);E+=v,B.paymentStatus==="paid"?y+=re:(y+=F,b+=K),M.forEach(_=>{N[_.method]!==void 0?N[_.method]+=_.amount:N[_.method]=_.amount});const P=B.date,J=P,ie=P.substring(0,7),ee=P.substring(0,4),le=B.paymentStatus==="paid"?re:F;O[J]=(O[J]||0)+le,I[ie]=(I[ie]||0)+le,Y[ee]=(Y[ee]||0)+le});const L=x.length>0?(y+b)/x.length:0;return{totalPaid:y,totalUnpaid:b,totalDeposits:E,averageEventValue:L,paymentMethodBreakdown:N,dailyRevenue:O,monthlyRevenue:I,yearlyRevenue:Y}},[a,r,o]),i=(()=>{switch(r){case"daily":return Object.entries(c.dailyRevenue).map(([x,f])=>({period:me(Pt(x),"MMM dd"),revenue:f}));case"monthly":return Object.entries(c.monthlyRevenue).map(([x,f])=>({period:me(Pt(`${x}-01`),"MMM yyyy"),revenue:f}));case"yearly":return Object.entries(c.yearlyRevenue).map(([x,f])=>({period:x,revenue:f}));case"custom":return Object.entries(c.dailyRevenue).map(([x,f])=>({period:me(Pt(x),"MMM dd"),revenue:f}));default:return[]}})(),u=Math.max(...i.map(x=>x.revenue),1),m=()=>{const x=[["Period","Revenue"],...i.map(b=>[b.period,b.revenue.toFixed(2)])].map(b=>b.join(",")).join(`
`),f=new Blob([x],{type:"text/csv"}),g=URL.createObjectURL(f),y=document.createElement("a");y.href=g,y.download=`payment_analytics_${r}_${me(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(g)},w=()=>{const x=me(new Date,"MMMM dd, yyyy"),f=`Payment Analytics Report - ${r.charAt(0).toUpperCase()+r.slice(1)}`,g=`
<!DOCTYPE html>
<html>
<head>
  <title>${f}</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }
    .metrics { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px; }
    .metric-card { border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
    .metric-value { font-size: 2em; font-weight: bold; color: #333; }
    .metric-label { color: #666; font-size: 0.9em; }
    .table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
    .table th { background-color: #f5f5f5; font-weight: bold; }
    .summary { background-color: #f8f9fa; padding: 20px; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="header">
    <h1>${f}</h1>
    <p>Generated on ${x}</p>
  </div>
  
  <div class="metrics">
    <div class="metric-card">
      <div class="metric-value">$${c.totalPaid.toFixed(2)}</div>
      <div class="metric-label">Total Paid</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">$${c.totalUnpaid.toFixed(2)}</div>
      <div class="metric-label">Total Unpaid</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">$${c.totalDeposits.toFixed(2)}</div>
      <div class="metric-label">Total Deposits</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">$${c.averageEventValue.toFixed(2)}</div>
      <div class="metric-label">Average Event Value</div>
    </div>
  </div>

  <h2>Revenue by Period</h2>
  <table class="table">
    <thead>
      <tr><th>Period</th><th>Revenue</th></tr>
    </thead>
    <tbody>
      ${i.map(N=>`<tr><td>${N.period}</td><td>$${N.revenue.toFixed(2)}</td></tr>`).join("")}
    </tbody>
  </table>

  <h2>Payment Methods Breakdown</h2>
  <table class="table">
    <thead>
      <tr><th>Method</th><th>Amount</th><th>Percentage</th></tr>
    </thead>
    <tbody>
      ${Object.entries(c.paymentMethodBreakdown).map(([N,O])=>{const I=c.totalDeposits>0?(O/c.totalDeposits*100).toFixed(1):"0.0";return`<tr><td>${N.replace("_"," ").toUpperCase()}</td><td>$${O.toFixed(2)}</td><td>${I}%</td></tr>`}).join("")}
    </tbody>
  </table>

  <div class="summary">
    <h3>Summary Statistics</h3>
    <p><strong>Collection Rate:</strong> ${c.totalPaid>0&&c.totalUnpaid>0?(c.totalPaid/(c.totalPaid+c.totalUnpaid)*100).toFixed(1):"0.0"}%</p>
    <p><strong>Total Revenue:</strong> $${(c.totalPaid+c.totalUnpaid).toFixed(2)}</p>
    <p><strong>Events in Period:</strong> ${i.length}</p>
  </div>
</body>
</html>
    `,y=new Blob([g],{type:"text/html"}),b=URL.createObjectURL(y),E=document.createElement("a");E.href=b,E.download=`payment_analytics_${r}_${me(new Date,"yyyy-MM-dd")}.html`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(b)},j=()=>{const x=window.open("","_blank");if(!x)return;const f=me(new Date,"MMMM dd, yyyy"),g=`Payment Analytics Report - ${r.charAt(0).toUpperCase()+r.slice(1)}`;x.document.write(`
<!DOCTYPE html>
<html>
<head>
  <title>${g}</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }
    .metrics { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px; }
    .metric-card { border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
    .metric-value { font-size: 2em; font-weight: bold; color: #333; }
    .metric-label { color: #666; font-size: 0.9em; }
    .table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
    .table th { background-color: #f5f5f5; font-weight: bold; }
    .summary { background-color: #f8f9fa; padding: 20px; border-radius: 8px; }
    @media print { body { margin: 0; } }
  </style>
</head>
<body>
  <div class="header">
    <h1>${g}</h1>
    <p>Generated on ${f}</p>
  </div>
  
  <div class="metrics">
    <div class="metric-card">
      <div class="metric-value">$${c.totalPaid.toFixed(2)}</div>
      <div class="metric-label">Total Paid</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">$${c.totalUnpaid.toFixed(2)}</div>
      <div class="metric-label">Total Unpaid</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">$${c.totalDeposits.toFixed(2)}</div>
      <div class="metric-label">Total Deposits</div>
    </div>
    <div class="metric-card">
      <div class="metric-value">$${c.averageEventValue.toFixed(2)}</div>
      <div class="metric-label">Average Event Value</div>
    </div>
  </div>

  <h2>Revenue by Period</h2>
  <table class="table">
    <thead>
      <tr><th>Period</th><th>Revenue</th></tr>
    </thead>
    <tbody>
      ${i.map(y=>`<tr><td>${y.period}</td><td>$${y.revenue.toFixed(2)}</td></tr>`).join("")}
    </tbody>
  </table>

  <h2>Payment Methods Breakdown</h2>
  <table class="table">
    <thead>
      <tr><th>Method</th><th>Amount</th><th>Percentage</th></tr>
    </thead>
    <tbody>
      ${Object.entries(c.paymentMethodBreakdown).map(([y,b])=>{const E=c.totalDeposits>0?(b/c.totalDeposits*100).toFixed(1):"0.0";return`<tr><td>${y.replace("_"," ").toUpperCase()}</td><td>$${b.toFixed(2)}</td><td>${E}%</td></tr>`}).join("")}
    </tbody>
  </table>

  <div class="summary">
    <h3>Summary Statistics</h3>
    <p><strong>Collection Rate:</strong> ${c.totalPaid>0&&c.totalUnpaid>0?(c.totalPaid/(c.totalPaid+c.totalUnpaid)*100).toFixed(1):"0.0"}%</p>
    <p><strong>Total Revenue:</strong> $${(c.totalPaid+c.totalUnpaid).toFixed(2)}</p>
    <p><strong>Events in Period:</strong> ${i.length}</p>
  </div>
</body>
</html>
    `),x.document.close(),x.print()};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Sa,{className:"h-6 w-6 text-amber-600"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Payment Analytics"}),s.jsx("p",{className:"text-slate-600",children:"Revenue and payment insights"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:[s.jsx(Lt,{className:"h-4 w-4"}),"Export CSV"]}),s.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:[s.jsx(Ft,{className:"h-4 w-4"}),"Export PDF"]}),s.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:[s.jsx(Cn,{className:"h-4 w-4"}),"Print"]})]}),s.jsx("button",{onClick:t,className:"p-2 text-slate-600 hover:text-slate-800 transition-colors",children:"×"})]})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx(Is,{className:"h-5 w-5 text-slate-500"}),s.jsx("div",{className:"flex gap-2",children:["daily","monthly","yearly","custom"].map(x=>s.jsx("button",{onClick:()=>n(x),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r===x?"bg-amber-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:x.charAt(0).toUpperCase()+x.slice(1)},x))})]}),r==="custom"&&s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Start Date"}),s.jsx("input",{type:"date",value:o.start,onChange:x=>l(f=>({...f,start:x.target.value})),className:"p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"End Date"}),s.jsx("input",{type:"date",value:o.end,onChange:x=>l(f=>({...f,end:x.target.value})),className:"p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:"Total Paid"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["$",c.totalPaid.toFixed(2)]})]}),s.jsx(xc,{className:"h-8 w-8 text-green-600"})]})}),s.jsx("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-red-800",children:"Total Unpaid"}),s.jsxs("p",{className:"text-2xl font-bold text-red-900",children:["$",c.totalUnpaid.toFixed(2)]})]}),s.jsx(fc,{className:"h-8 w-8 text-red-600"})]})}),s.jsx("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Total Deposits"}),s.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:["$",c.totalDeposits.toFixed(2)]})]}),s.jsx(Ja,{className:"h-8 w-8 text-blue-600"})]})}),s.jsx("div",{className:"bg-amber-50 p-6 rounded-lg border border-amber-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Avg Event Value"}),s.jsxs("p",{className:"text-2xl font-bold text-amber-900",children:["$",c.averageEventValue.toFixed(2)]})]}),s.jsx(Sa,{className:"h-8 w-8 text-amber-600"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Revenue Trend"}),s.jsx("div",{className:"space-y-3",children:i.length===0?s.jsxs("div",{className:"text-center py-8 text-slate-500",children:[s.jsx(gt,{className:"h-12 w-12 mx-auto mb-3 text-slate-400"}),s.jsx("p",{children:"No revenue data for selected period"})]}):i.map((x,f)=>s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-sm font-medium text-slate-700",children:x.period}),s.jsxs("span",{className:"text-sm font-semibold text-slate-900",children:["$",x.revenue.toFixed(2)]})]}),s.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:s.jsx("div",{className:"bg-amber-600 h-2 rounded-full transition-all duration-300",style:{width:`${x.revenue/u*100}%`}})})]})},f))})]}),s.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Payment Methods"}),s.jsxs("div",{className:"space-y-4",children:[Object.entries(c.paymentMethodBreakdown).map(([x,f])=>{const g=c.totalDeposits>0?f/c.totalDeposits*100:0,y={cash:"bg-green-500",credit_card:"bg-blue-500",check:"bg-purple-500"};return s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-4 h-4 rounded ${y[x]}`}),s.jsx("span",{className:"text-sm font-medium text-slate-700 capitalize",children:x.replace("_"," ")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:["$",f.toFixed(2)]}),s.jsxs("p",{className:"text-xs text-slate-500",children:[g.toFixed(1),"%"]})]})]},x)}),c.totalDeposits===0&&s.jsxs("div",{className:"text-center py-4 text-slate-500",children:[s.jsx(jl,{className:"h-8 w-8 mx-auto mb-2 text-slate-400"}),s.jsx("p",{className:"text-sm",children:"No payment data available"})]})]})]})]}),s.jsxs("div",{className:"mt-8 p-6 bg-slate-50 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Summary"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[c.totalPaid>0&&c.totalUnpaid>0?(c.totalPaid/(c.totalPaid+c.totalUnpaid)*100).toFixed(1):"0.0","%"]}),s.jsx("p",{className:"text-sm text-slate-600",children:"Collection Rate"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:["$",(c.totalPaid+c.totalUnpaid).toFixed(2)]}),s.jsx("p",{className:"text-sm text-slate-600",children:"Total Revenue"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-slate-900",children:i.length}),s.jsx("p",{className:"text-sm text-slate-600",children:"Events in Period"})]})]})]})]})]})}):null},Bf=({onEditEvent:e,onNavigateToDate:t,statusFilter:a,paymentFilter:r,currentUser:n})=>{const o=n??{role:"guest"},{events:l,deleteEvent:c,clearAllEvents:d}=Ae(),i=o.role==="admin"||o.role==="manager",[u,m]=T.useState(new Set),[w,j]=T.useState("all"),[x,f]=T.useState("all"),[g,y]=T.useState(null),[b,E]=T.useState(!1),[N,O]=T.useState(!1);kr.useEffect(()=>{a?j(a):a===void 0&&w!=="all"&&j("all")},[a]),kr.useEffect(()=>{r?f(r):r===void 0&&x!=="all"&&f("all")},[r]);const I=l.filter(v=>!(w!=="all"&&v.status!==w||x!=="all"&&v.paymentStatus!==x)),Y=v=>{const P=new Set(u);P.has(v)?P.delete(v):P.add(v),m(P)},L=()=>{u.size===I.length?m(new Set):m(new Set(I.map(v=>v.id)))},B=()=>{if(!i){window.alert("Only administrators and managers can delete events.");return}if(I.length===0){window.alert("There are no events to clear.");return}window.confirm(`Are you sure you want to clear ALL filtered events? This will permanently delete ${I.length} event(s) and cannot be undone.`)&&(d().catch(v=>{console.error("Failed to clear events:",v),window.alert("Failed to clear events. Please try again.")}),m(new Set))},re=v=>{if(console.log("🕐 formatTime called with:",v,"type:",typeof v),!v||typeof v!="string")return console.log("❌ Invalid time value:",v),"N/A";const P=v.split(":");if(P.length<2)return console.log("❌ Invalid time format:",v),v;const[J,ie]=P.map(Number);if(isNaN(J)||isNaN(ie))return console.log("❌ Invalid time parts:",{hours:J,minutes:ie,original:v}),v;const ee=J>=12?"PM":"AM";return`${J===0?12:J>12?J-12:J}:${ie.toString().padStart(2,"0")} ${ee}`},F=v=>{switch(v){case"restaurant":return"bg-emerald-500";case"bar":return"bg-amber-500";case"banquet":return"bg-indigo-500";default:return"bg-gray-500"}},M=v=>{switch(v){case"restaurant":return"🍽️";case"bar":return"🍺";case"banquet":return"🎉";default:return"📅"}},K=v=>{t&&t(v)};return I.length===0?s.jsxs("div",{className:"flex-1 flex flex-col",children:[s.jsx("div",{className:"bg-white border-b border-slate-200 p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Is,{className:"h-5 w-5 text-slate-500"}),s.jsxs("select",{value:w,onChange:v=>{const P=v.target.value;j(P)},className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"confirmed",children:"Confirmed"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"cancelled",children:"Cancelled"}),s.jsx("option",{value:"closed",children:"Closed"})]}),s.jsxs("select",{value:x,onChange:v=>{const P=v.target.value;f(P)},className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Payments"}),s.jsx("option",{value:"paid",children:"Paid"}),s.jsx("option",{value:"unpaid",children:"Unpaid"})]})]})}),s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ha,{className:"h-16 w-16 text-slate-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold text-slate-600 mb-2",children:"No Events Found"}),s.jsx("p",{className:"text-slate-500",children:"No events match your current filter criteria."})]})})]}):s.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[s.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-5",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[s.jsxs("div",{className:"flex flex-col gap-1 mr-auto min-w-[220px]",children:[s.jsx("h2",{className:"text-[20px] font-semibold text-slate-900",children:"Event History"}),s.jsxs("span",{className:"text-[13px] text-slate-500",children:[I.length," event",I.length!==1?"s":""," found"]})]}),s.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-lg px-3 py-2",children:[s.jsx(Is,{className:"h-4 w-4 text-slate-500"}),s.jsxs("select",{value:w,onChange:v=>{const P=v.target.value;j(P)},className:"text-sm px-3 py-1.5 border border-slate-200 rounded-md bg-white text-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-400",children:[s.jsx("option",{value:"confirmed",children:"Confirmed"}),s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"cancelled",children:"Cancelled"}),s.jsx("option",{value:"closed",children:"Closed"})]}),s.jsxs("select",{value:x,onChange:v=>f(v.target.value),className:"text-sm px-3 py-1.5 border border-slate-200 rounded-md bg-white text-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-400",children:[s.jsx("option",{value:"all",children:"All Payments"}),s.jsx("option",{value:"paid",children:"Paid"}),s.jsx("option",{value:"unpaid",children:"Unpaid"})]}),(a||r)&&s.jsxs("span",{className:"text-xs text-slate-500 bg-white border border-slate-200 rounded-md px-2 py-1",children:[a&&`Status: ${a}`,a&&r&&" • ",r&&`Payment: ${r}`]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>O(!0),className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium shadow-sm transition-colors",children:[s.jsx(Sa,{className:"h-4 w-4"}),"Analytics"]}),i&&s.jsx("button",{onClick:B,className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-slate-700 hover:bg-slate-800 text-white text-sm font-medium shadow-sm transition-colors disabled:opacity-50",disabled:I.length===0,children:"Clear All Data"})]})]}),I.length>0&&s.jsxs("div",{className:"flex items-center gap-3 mt-4 text-sm text-slate-600",children:[s.jsxs("button",{onClick:L,className:"flex items-center gap-2 text-slate-600 hover:text-blue-600 transition-colors",children:[u.size===I.length?s.jsx(Pr,{className:"h-4 w-4"}):s.jsx(Dr,{className:"h-4 w-4"}),"Select All"]}),s.jsxs("span",{className:"text-xs text-slate-400",children:[u.size," of ",I.length," selected"]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsx("div",{className:"grid gap-4",children:I.map(v=>{var P;return s.jsx("div",{className:`
                bg-white rounded-lg shadow-lg border-2 p-6 transition-all duration-200
                ${u.has(v.id)?"border-amber-400 shadow-amber-100":"border-slate-200 hover:border-slate-300 hover:shadow-xl"}
              `,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("button",{onClick:()=>Y(v.id),className:"text-slate-400 hover:text-slate-600 transition-colors",children:u.has(v.id)?s.jsx(Pr,{className:"h-5 w-5 text-amber-600"}):s.jsx(Dr,{className:"h-5 w-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${F(v.venue)}`}),s.jsx("span",{className:"text-lg",children:M(v.venue)})]}),s.jsxs("h3",{className:`text-lg font-semibold text-slate-800 ${v.status==="closed"?"line-through":""}`,children:[v.title,v.status==="cancelled"&&s.jsx("span",{className:"text-red-600 text-sm font-normal ml-2",children:"(Cancelled)"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium border ${v.status==="confirmed"?"bg-blue-50 text-blue-700 border-blue-200":v.status==="pending"?"bg-amber-50 text-amber-700 border-amber-200":v.status==="cancelled"?"bg-red-50 text-red-700 border-red-200":"bg-slate-50 text-slate-700 border-slate-200"}`,children:v.status}),s.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium border ${v.paymentStatus==="paid"?"bg-green-50 text-green-700 border-green-200":"bg-orange-50 text-orange-700 border-orange-200"}`,children:v.paymentStatus})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[s.jsx(gt,{className:"h-4 w-4"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{onClick:()=>K(v.date),className:"font-medium text-left hover:text-blue-600 hover:underline transition-colors flex items-center gap-1 cursor-pointer",title:"Go to calendar date",children:[me(new Date(v.date+"T00:00:00"),"MMM dd, yyyy"),s.jsx(Ta,{className:"h-3 w-3"})]}),s.jsxs("div",{className:"text-slate-500",children:[v.startTime?re(v.startTime):"N/A"," ",v.startTime&&v.endTime&&"–"," ",v.endTime?re(v.endTime):"N/A"]})]})]}),s.jsxs("div",{className:"text-slate-600 space-y-1",children:[s.jsx("div",{className:"font-medium",children:v.contact.name}),s.jsx("div",{className:"text-slate-500",children:v.contact.phone}),s.jsx("div",{className:"text-slate-500",children:v.contact.email}),v.createdBy&&s.jsxs("div",{className:"text-xs text-slate-500",children:["Added by ",s.jsx("span",{className:"font-semibold text-slate-700",children:v.createdBy.displayName||v.createdBy.userId}),v.createdBy.role&&` (${v.createdBy.role})`]}),v.updatedBy&&v.updatedBy.userId!==((P=v.createdBy)==null?void 0:P.userId)&&s.jsxs("div",{className:"text-xs text-slate-500",children:["Last edit by ",s.jsx("span",{className:"font-semibold text-slate-700",children:v.updatedBy.displayName||v.updatedBy.userId}),v.updatedBy.role&&` (${v.updatedBy.role})`]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[s.jsx(Ja,{className:"h-4 w-4"}),s.jsxs("div",{children:[s.jsx("div",{className:`font-medium ${v.paymentStatus==="paid"?"text-green-700":"text-orange-700"}`,children:v.paymentStatus==="paid"?"Paid":"Unpaid"}),v.paymentMethod&&v.paymentStatus==="paid"&&s.jsx("div",{className:"text-slate-500 capitalize",children:v.paymentMethod.replace("_"," ")})]})]})]}),v.notes&&s.jsx("div",{className:"mt-3 p-3 bg-slate-50 rounded-md",children:s.jsxs("div",{className:"text-sm text-slate-600",children:[s.jsx("span",{className:"font-medium",children:"Notes: "}),v.notes]})}),s.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500",children:[s.jsxs("div",{className:"capitalize",children:[v.venue," venue"]}),s.jsxs("div",{children:["Updated: ",(()=>{try{if(!v.updatedAt)return"Unknown";const J=new Date(v.updatedAt);return isNaN(J.getTime())?"Invalid date":me(J,"MMM dd, yyyy HH:mm")}catch(J){return console.error("Date formatting error for event:",v.id,"updatedAt:",v.updatedAt,J),"Invalid date"}})()]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[s.jsx("button",{onClick:()=>{y(v),E(!0)},className:"p-2 text-slate-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"View Invoice",children:s.jsx(Ft,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>e(v),className:"p-2 text-slate-600 hover:text-amber-600 hover:bg-amber-50 rounded-lg transition-colors",title:"Edit Event",children:s.jsx(ts,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete "${v.title}"? This action cannot be undone.`)&&c(v.id)},className:"p-2 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Event",children:s.jsx(jt,{className:"h-4 w-4"})})]})]})},v.id)})})}),g&&s.jsx(Uf,{event:g,isOpen:b,onClose:()=>{E(!1),y(null)}}),s.jsx(Vf,{isOpen:N,onClose:()=>O(!1)})]})},qf=Ga((e,t)=>({licenses:[],isLoading:!1,error:null,checkResult:null,autoSerialAvailable:!0,clearError:()=>e({error:null}),clearCheckResult:()=>e({checkResult:null}),async fetchLicenses(){e({isLoading:!0,error:null});try{const a=await ke(je.licenses);if(!a.ok){const n=await a.json().catch(()=>({error:"Failed to load licenses"}));throw new Error(n.error||"Failed to load licenses")}const r=await a.json();e({licenses:r.licenses??[],isLoading:!1})}catch(a){e({isLoading:!1,error:a instanceof Error?a.message:"Failed to load licenses"})}},async createLicense(a){e({error:null});try{const r=await ke(je.licenses,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,autoGenerate:a.autoGenerate??!a.serialNumber})}),n=await r.json().catch(()=>({error:"Failed to create license"}));if(!r.ok)throw r.status===404&&(a.autoGenerate??!a.serialNumber)&&e({autoSerialAvailable:!1,error:"Auto serial generation is not supported by this backend. Enter a serial number manually."}),new Error(n.error||"Failed to create license");if(n.license)return e(o=>({licenses:[n.license,...o.licenses]})),n.license;throw new Error("License creation response missing license data")}catch(r){throw e({error:r instanceof Error?r.message:"Failed to create license"}),r}},async updateLicense(a,r){e({error:null});try{const n=await ke(je.licensesById(a),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),o=await n.json();if(!n.ok)throw new Error(o.error||"Failed to update license");o.license&&e(l=>({licenses:l.licenses.map(c=>c.id===a?o.license:c)}))}catch(n){throw e({error:n instanceof Error?n.message:"Failed to update license"}),n}},async deleteLicense(a){e({error:null});try{const r=await ke(je.licensesById(a),{method:"DELETE"});if(!r.ok){const n=await r.json().catch(()=>({error:"Failed to delete license"}));throw new Error(n.error||"Failed to delete license")}e(n=>({licenses:n.licenses.filter(o=>o.id!==a)}))}catch(r){throw e({error:r instanceof Error?r.message:"Failed to delete license"}),r}},async verifyLicense(a,r){e({error:null,checkResult:null});try{const n=await ke(je.licensesCheck,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serial:a,projectKey:r})}),o=await n.json(),l={valid:!!o.valid,reason:o.reason,user:o.user,expiry:o.expiry,plan:o.plan,status:o.status};return n.ok?(e({checkResult:l}),l):(e({checkResult:l}),l)}catch(n){const o={valid:!1,reason:n instanceof Error?n.message:"License verification failed"};return e({checkResult:o,error:o.reason??"License verification failed"}),o}},async generateLicense(a){e({error:null});try{const r=await ke(je.licensesGenerate,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planType:a.planType,userName:a.userName,startDate:a.startDate,expiryDate:a.expiryDate,prefix:a.prefix,randomLength:a.randomLength,notes:a.notes})}),n=await r.json().catch(()=>({error:"Failed to generate license"}));if(!r.ok)throw r.status===404&&e({autoSerialAvailable:!1,error:"Auto serial generation is not supported by this backend. Enter a serial number manually."}),new Error(n.error||"Failed to generate license");if(n.license)return e(o=>({licenses:[n.license,...o.licenses]})),n.license;throw new Error("License generation response missing license data")}catch(r){throw e({error:r instanceof Error?r.message:"Failed to generate license"}),r}},async previewSerial(a){e({error:null});const{autoSerialAvailable:r}=t();if(!r)throw new Error("Auto serial generation is not supported by this backend.");try{const n=new URL(je.licensesPreviewSerial,window.location.origin);n.searchParams.set("planType",a.planType),a.userName&&n.searchParams.set("userName",a.userName),a.startDate&&n.searchParams.set("startDate",a.startDate),a.expiryDate&&n.searchParams.set("expiryDate",a.expiryDate),a.prefix&&n.searchParams.set("prefix",a.prefix),typeof a.randomLength=="number"&&n.searchParams.set("randomLength",String(a.randomLength)),a.issuedAt&&n.searchParams.set("issuedAt",a.issuedAt);const o=await ke(n.toString(),{method:"GET"}),l=await o.json().catch(()=>({}));if(o.status===404)throw e({autoSerialAvailable:!1,error:"Auto serial generation is not supported by this backend. Enter a serial number manually."}),new Error("Auto serial generation is not supported by this backend.");if(!o.ok)throw new Error(l.error||"Failed to preview serial");return{serialNumber:l.serialNumber,planType:l.planType,startDate:l.startDate,expiryDate:l.expiryDate}}catch(n){const o=n instanceof Error?n.message:"Failed to preview serial";throw e({error:o}),n}}})),Zf=({isOpen:e,onClose:t})=>{const{settings:a,venues:r,colorPresets:n,updateSettings:o,uploadLogo:l,addVenue:c,updateVenue:d,deleteVenue:i,resetToDefaults:u}=Ae(),{user:m}=We(),[w,j]=T.useState("general"),[x,f]=T.useState([]),[g,y]=T.useState(!1),[b,E]=T.useState(null),{licenses:N,isLoading:O,error:I,fetchLicenses:Y,createLicense:L,updateLicense:B,deleteLicense:re,verifyLicense:F,generateLicense:M,previewSerial:K,autoSerialAvailable:v,clearError:P,checkResult:J,clearCheckResult:ie}=qf(),[ee,le]=T.useState(!1),[ae,h]=T.useState(""),[C,z]=T.useState(null),[_,V]=T.useState(null),[q,$]=T.useState({serialNumber:"",userName:"",planType:"monthly",startDate:new Date().toISOString().slice(0,10),expiryDate:new Date().toISOString().slice(0,10),status:"active",notes:"",prefix:"",autoGenerate:!0,randomLength:4}),[oe,G]=T.useState(null),[xe,ye]=T.useState(!1),[fe,Te]=T.useState(null),[ge,Oe]=T.useState(!1),[mt,Fe]=T.useState(!1),[Ee,Ie]=T.useState({username:"",password:"",role:"operator",firstName:"",lastName:"",phone:"",email:""}),[Ct,Tt]=T.useState(a.storeName),[at,ws]=T.useState(a.storeEmail||""),[Ns,Ue]=T.useState(a.storePhone||""),[Ht,yt]=T.useState(a.storeAddress||""),[Et,rt]=T.useState(a.applicationTitle),[It,Jt]=T.useState(a.applicationSubtitle),[pt,Wt]=T.useState(a.selectedVenue||""),[Se,ht]=T.useState(a.themeColor),[Ye,$t]=T.useState(a.backgroundColor),[Ke,At]=T.useState(a.textColor),[nt,$e]=T.useState(a.highlightTextColor),[Ve,xr]=T.useState(a.dbHost||""),[Yt,yr]=T.useState(a.dbUser||""),[ia,br]=T.useState(a.dbPassword||""),[Kt,vr]=T.useState(a.dbName||""),[Pe,Qt]=T.useState({name:"",type:"",color:"#6b7280",icon:"📅"}),[Ii,la]=T.useState(null),jr=T.useRef(null),wr=T.useRef(null),Xt=(m==null?void 0:m.role)==="admin"||(m==null?void 0:m.role)==="manager",_s=async()=>{if(Xt){y(!0),E(null);try{console.log("Fetching users from:",je.users);const p=await ke(je.users);if(console.log("Response status:",p.status,p.ok),!p.ok){const Ze=await p.json().catch(()=>({error:"Failed to fetch users"}));throw console.error("Error response:",Ze),new Error(Ze.error||"Failed to fetch users")}const R=await p.json();console.log("Raw response data:",R);const be=R.users||R||[];console.log("Users array:",be),f(be)}catch(p){console.error("Fetch users error:",p),E(p instanceof Error?p.message:"Failed to fetch users")}finally{y(!1)}}},$i=async()=>{G(null),P();try{const p=await K({planType:"monthly",randomLength:4});$({serialNumber:p.serialNumber,userName:"",planType:p.planType,startDate:p.startDate,expiryDate:p.expiryDate,status:"active",notes:"",prefix:"",autoGenerate:!0,randomLength:4})}catch(p){console.error("Failed to preview serial",p),$({serialNumber:"",userName:"",planType:"monthly",startDate:new Date().toISOString().slice(0,10),expiryDate:new Date().toISOString().slice(0,10),status:"active",notes:"",prefix:"",autoGenerate:!0,randomLength:4})}ye(!0)},Ai=p=>{G(p),$({serialNumber:p.serialNumber,userName:p.userName,planType:p.planType,startDate:p.startDate,expiryDate:p.expiryDate,status:p.status,notes:p.notes??"",prefix:"",autoGenerate:!1,randomLength:4}),P(),ye(!0)},Pi=async p=>{p.preventDefault(),P();try{if(oe)await B(oe.id,{...q,autoGenerate:!1});else{const R=await L({...q,autoGenerate:q.autoGenerate});$(be=>({...be,serialNumber:R.serialNumber}))}await Y(),ye(!1),G(null)}catch(R){console.error("License save failed",R)}},Di=async p=>{if(window.confirm(`Delete license ${p.serialNumber}?`))try{await re(p.id),await Y()}catch(R){console.error("Failed to delete license",R)}},ca=async()=>{if(!ae.trim()){V("error"),z("Enter a serial number to validate.");return}le(!0),z(null),V(null),ie();try{const p=await F(ae.trim());p.valid?(V("success"),z(`✅ License valid for ${p.user??"unknown user"} until ${p.expiry??"N/A"} (${p.plan??"N/A"})`)):(V("error"),z(p.reason??"License invalid"))}catch{V("error"),z("License verification failed.")}finally{le(!1)}},Nr=async()=>{if(!Ve||!Yt||!Kt)return alert("Please provide DB_HOST, DB_USER, and DB_NAME before connecting."),!1;try{const p=await fetch(`${as.base}/api/database/connect`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:Ve,user:Yt,password:ia,database:Kt})});if(!p.ok){const R=await p.json().catch(()=>({}));throw new Error(R.details||R.error||"Failed to connect to database")}return alert("Database connected successfully."),!0}catch(p){return console.error("Database connection error:",p),alert(`Database connection failed: ${p instanceof Error?p.message:"Unknown error"}`),!1}},Ri=async p=>{if(p)try{const R=await p.text();if(!R.trim()){alert("Selected file is empty.");return}const be=await fetch(`${as.base}/api/database/import`,{method:"POST",headers:{"Content-Type":"text/plain"},body:R});if(!be.ok){const Ze=await be.json().catch(()=>({}));throw new Error(Ze.details||Ze.error||"Failed to import SQL file")}alert("SQL file imported successfully.")}catch(R){console.error("SQL import error:",R),alert(`Import failed: ${R instanceof Error?R.message:"Unknown error"}`)}},Mi=async()=>{try{const p=await fetch(`${as.base}/api/database/export`);if(!p.ok){const _r=await p.json().catch(()=>({}));throw new Error(_r.details||_r.error||"Failed to export database")}const R=await p.blob(),be=window.URL.createObjectURL(R),Ze=document.createElement("a");Ze.href=be,Ze.download="event_manager.sql",document.body.appendChild(Ze),Ze.click(),document.body.removeChild(Ze),window.URL.revokeObjectURL(be),alert("Database export started. Check your downloads.")}catch(p){console.error("Database export error:",p),alert(`Export failed: ${p instanceof Error?p.message:"Unknown error"}`)}},Oi=async()=>{o({storeName:Ct,storeEmail:at,storePhone:Ns,storeAddress:Ht,applicationTitle:Et,applicationSubtitle:It,selectedVenue:pt||void 0,themeColor:Se,backgroundColor:Ye,textColor:Ke,highlightTextColor:nt,dbHost:Ve,dbUser:Yt,dbPassword:ia,dbName:Kt}),Ve&&Yt&&Kt&&await Nr(),t()};T.useEffect(()=>{Xt&&w==="users"&&_s(),w==="licenses"&&Y()},[w,Xt,Y]);const Li=()=>{window.confirm("Are you sure you want to reset all settings to default values?")&&(u(),Tt("My Restaurant"),ws(""),Ue(""),yt(""),rt("Event Manager"),Jt("Professional Hospitality Event Management"),Wt(""),ht("#f59e0b"),$t("#0f172a"),At("#ffffff"),$e("#f59e0b"),xr(""),yr(""),br(""),vr(""))},Fi=p=>{var be;const R=(be=p.target.files)==null?void 0:be[0];R&&l(R)},Ui=()=>{o({logo:"/assets/default-logo.png"}),alert("Logo reset to default successfully!")},Vi=()=>{Pe.name&&Pe.type&&Pe.color&&(c({name:Pe.name,type:Pe.type,color:Pe.color,icon:Pe.icon||"📅"}),Qt({name:"",type:"",color:"#6b7280",icon:"📅"}))},ks=(p,R)=>{d(p,R),la(null)},Bi=p=>{window.confirm("Are you sure you want to delete this venue?")&&i(p)},Ss=()=>{Ie({username:"",password:"",role:"operator",firstName:"",lastName:"",phone:"",email:""}),Te(null),Oe(!1),Fe(!1),E(null)},qi=p=>{console.log("USER DATAA",p),Te(p),Oe(!0),Fe(!1),Ie({username:p.username,password:"",role:p.role,firstName:p.first_name,lastName:p.last_name,phone:p.phone,email:p.email})},Zi=async p=>{p.preventDefault(),E(null);try{if(ge&&fe){const R=await ke(je.userById(fe.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...Ee,password:Ee.password?Ee.password:void 0})});if(!R.ok){const be=await R.json().catch(()=>({error:"Failed to update user"}));throw new Error(be.error||"Failed to update user")}}else{const R=await ke(je.users,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!R.ok){const be=await R.json().catch(()=>({error:"Failed to create user"}));throw new Error(be.error||"Failed to create user")}}await _s(),Ss()}catch(R){E(R instanceof Error?R.message:"User action failed")}},zi=async p=>{if(window.confirm("Are you sure you want to delete this user?")){E(null);try{const R=await ke(je.usersById(p),{method:"DELETE"});if(!R.ok){const be=await R.json().catch(()=>({error:"Failed to delete user"}));throw new Error(be.error||"Failed to delete user")}await _s()}catch(R){E(R instanceof Error?R.message:"Failed to delete user")}}};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b bg-gradient-to-r from-slate-50 to-slate-100 border-slate-200",children:[s.jsx("div",{children:s.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Settings"})}),s.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600 transition-colors",children:s.jsx(Ut,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"flex h-[calc(90vh-140px)]",children:[s.jsx("div",{className:"w-48 bg-slate-50 border-r border-slate-200 flex-shrink-0",children:s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("button",{onClick:()=>j("general"),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center gap-2 ${w==="general"?"bg-amber-100 text-amber-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[s.jsx(Tr,{className:"h-4 w-4"}),"General"]}),s.jsxs("button",{onClick:()=>j("venues"),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center gap-2 ${w==="venues"?"bg-amber-100 text-amber-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[s.jsx(ts,{className:"h-4 w-4"}),"Venues"]}),s.jsxs("button",{onClick:()=>j("colors"),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center gap-2 ${w==="colors"?"bg-amber-100 text-amber-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[s.jsx(Sn,{className:"h-4 w-4"}),"Theme"]}),Xt&&s.jsxs("button",{onClick:()=>j("users"),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center gap-2 ${w==="users"?"bg-amber-100 text-amber-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[s.jsx(ns,{className:"h-4 w-4"}),"Users"]}),s.jsxs("button",{onClick:()=>j("licenses"),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center gap-2 ${w==="licenses"?"bg-amber-100 text-amber-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[s.jsx(Er,{className:"h-4 w-4"}),"Licenses"]}),s.jsxs("button",{onClick:()=>j("database"),className:`w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center gap-2 ${w==="database"?"bg-amber-100 text-amber-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[s.jsx(Tr,{className:"h-4 w-4"}),"Database"]})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto",children:[w==="general"&&s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Store Name"}),s.jsx("input",{type:"text",value:Ct,onChange:p=>Tt(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"My Restaurant"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Store Email"}),s.jsx("input",{type:"email",value:at,onChange:p=>ws(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"info@myrestaurant.com"}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"This email will appear on invoices"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Store Phone"}),s.jsx("input",{type:"tel",value:Ns,onChange:p=>Ue(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"(555) 123-4567"}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"This phone number will appear on invoices"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Store Address"}),s.jsx("textarea",{value:Ht,onChange:p=>yt(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"123 Main Street, City, State 12345",rows:3}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"This address will appear on invoices"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Application Title"}),s.jsx("input",{type:"text",value:Et,onChange:p=>rt(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Event Manager"}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"This appears as the main title in the header"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Application Subtitle"}),s.jsx("input",{type:"text",value:It,onChange:p=>Jt(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Professional Hospitality Event Management"}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"This appears as the subtitle in the header"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Logo"}),s.jsxs("div",{className:"flex items-center gap-4",children:[a.logo&&s.jsx("img",{src:a.logo,alt:"Logo",className:"w-16 h-16 object-contain rounded-md border border-slate-200"}),s.jsxs("button",{onClick:()=>{var p;return(p=jr.current)==null?void 0:p.click()},className:"px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md font-medium transition-colors flex items-center gap-2",children:[s.jsx(Wa,{className:"h-4 w-4"}),"Upload Logo"]}),a.logo&&s.jsxs("button",{onClick:Ui,className:"px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-md font-medium transition-colors flex items-center gap-2",children:[s.jsx(ec,{className:"h-4 w-4"}),"Reset to Default"]}),s.jsx("input",{ref:jr,type:"file",accept:"image/*",onChange:Fi,className:"hidden"})]}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Recommended size: 200x200px, PNG or JPG"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Default Active Venue"}),s.jsxs("select",{value:pt,onChange:p=>Wt(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"All Venues"}),r.map(p=>s.jsxs("option",{value:p.id,children:[p.icon," ",p.name]},p.id))]}),s.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"When selected, this venue will be highlighted in the header"})]})]}),w==="venues"&&s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[s.jsx("h3",{className:"font-medium text-slate-800 mb-3",children:"Add New Venue"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[s.jsx("input",{type:"text",placeholder:"Venue Name",value:Pe.name||"",onChange:p=>Qt({...Pe,name:p.target.value}),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),s.jsx("input",{type:"text",placeholder:"Type (e.g., private_dining)",value:Pe.type||"",onChange:p=>Qt({...Pe,type:p.target.value}),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"color",value:Pe.color||"#6b7280",onChange:p=>Qt({...Pe,color:p.target.value}),className:"w-12 h-10 rounded border border-slate-300"}),s.jsx("input",{type:"text",placeholder:"🍕",value:Pe.icon||"",onChange:p=>Qt({...Pe,icon:p.target.value}),className:"flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent text-center"})]}),s.jsxs("button",{onClick:Vi,className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-md font-medium transition-colors flex items-center justify-center gap-2",children:[s.jsx(Je,{className:"h-4 w-4"}),"Add"]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"font-medium text-slate-800",children:"Manage Venues"}),r.map(p=>s.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-4",children:Ii===p.id?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-center",children:[s.jsx("input",{type:"text",defaultValue:p.name,onBlur:R=>ks(p.id,{name:R.target.value}),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),s.jsx("input",{type:"text",defaultValue:p.type,onBlur:R=>ks(p.id,{type:R.target.value}),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),s.jsx("input",{type:"color",defaultValue:p.color,onChange:R=>ks(p.id,{color:R.target.value}),className:"w-full h-10 rounded border border-slate-300"}),s.jsx("input",{type:"text",defaultValue:p.icon,onBlur:R=>ks(p.id,{icon:R.target.value}),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent text-center"}),s.jsx("button",{onClick:()=>la(null),className:"px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded-md text-sm",children:"Done"})]}):s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:p.color}}),s.jsx("span",{className:"text-lg",children:p.icon}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-slate-800",children:p.name}),s.jsx("div",{className:"text-sm text-slate-500",children:p.type})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>la(p.id),className:"p-2 text-slate-600 hover:text-amber-600 hover:bg-amber-50 rounded-lg transition-colors",children:s.jsx(ts,{className:"h-4 w-4"})}),!["restaurant","bar","banquet"].includes(p.id)&&s.jsx("button",{onClick:()=>Bi(p.id),className:"p-2 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:s.jsx(jt,{className:"h-4 w-4"})})]})]})},p.id))]})]}),w==="licenses"&&s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 shadow-sm text-sm text-amber-800",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2 font-semibold text-amber-900",children:[s.jsx(Er,{className:"h-4 w-4 text-amber-500"}),"License Management"]}),s.jsxs("ul",{className:"space-y-1 leading-relaxed",children:[s.jsx("li",{children:"• Generate and manage activation serials for Python/CUDA apps"}),s.jsx("li",{children:"• Verify license validity before running GPU workloads"}),s.jsx("li",{children:"• Support monthly or yearly billing with remote deactivation"})]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"flex-1 bg-white border border-slate-200 rounded-lg p-4 space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Serial Health Check"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Confirm entitlement before your Python launcher boots GPU workloads."})]}),s.jsx("p",{className:"text-xs text-slate-500 max-w-sm",children:"The Worker endpoint answers in real time so remote disable or plan downgrades take effect instantly—even on headless rigs."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsx("input",{type:"text",value:ae,onChange:p=>h(p.target.value),placeholder:"e.g. ABC123-XYZ789",className:"flex-1 px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent font-mono"}),s.jsx("button",{onClick:ca,disabled:ee,className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-md font-medium transition-colors flex items-center gap-2",children:ee?s.jsxs(s.Fragment,{children:[s.jsx(da,{className:"h-4 w-4 animate-spin"}),"Checking…"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ar,{className:"h-4 w-4"}),"Verify Serial"]})})]}),C&&s.jsxs("div",{className:`mt-3 px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-2 ${_==="success"?"bg-emerald-50 border border-emerald-200 text-emerald-700":"bg-red-50 border border-red-200 text-red-700"}`,children:[_==="success"?s.jsx(Al,{className:"h-4 w-4"}):s.jsx(kn,{className:"h-4 w-4"}),C]})]}),s.jsxs("div",{className:"w-full md:w-64 bg-white border border-slate-200 rounded-lg p-4 space-y-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wide",children:"Developer Shortcuts"}),s.jsxs("button",{onClick:()=>{h("ABC123-XYZ789"),ca()},className:"w-full px-3 py-2 border border-slate-300 rounded-md hover:bg-slate-50 text-sm flex items-center justify-between",children:["Sample Yearly Serial",s.jsx(Ca,{className:"h-4 w-4 text-slate-400"})]}),s.jsxs("button",{onClick:()=>{h("DEF456-UVW000"),ca()},className:"w-full px-3 py-2 border border-slate-300 rounded-md hover:bg-slate-50 text-sm flex items-center justify-between",children:["Sample Monthly Serial",s.jsx(Ca,{className:"h-4 w-4 text-slate-400"})]}),s.jsxs("div",{className:"text-xs text-slate-500",children:["Python launcher snippet:",s.jsx("pre",{className:"mt-2 bg-slate-900 text-slate-100 rounded-md p-2 text-[11px] overflow-x-auto",children:`if not verify_license("SERIAL-HERE"):
    raise SystemExit("license check failed")`})]})]})]}),I&&s.jsx("div",{className:"px-3 py-2 bg-red-50 border border-red-200 text-sm text-red-700 rounded-lg",children:I}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Issued Licenses"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Track active, expired, or disabled keys mapped to each customer contract."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:$i,className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-md font-medium transition-colors flex items-center gap-2",children:[s.jsx(Je,{className:"h-4 w-4"}),"New License"]}),s.jsx("button",{onClick:Y,className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-100 transition-colors",children:"Refresh"})]})]}),xe&&s.jsxs("form",{onSubmit:Pi,className:"bg-white border border-slate-200 rounded-lg p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-semibold text-slate-700",children:oe?`Edit ${oe.serialNumber}`:"Create License"}),s.jsx("button",{type:"button",onClick:()=>{ye(!1),G(null)},className:"text-sm text-slate-500 hover:text-slate-700",children:"Cancel"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Serial Number"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:q.serialNumber,onChange:p=>$(R=>({...R,serialNumber:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",placeholder:"ABC123-YR-20251002-ABCD",disabled:q.autoGenerate,required:!q.autoGenerate}),s.jsxs("button",{type:"button",onClick:async()=>{try{const p=await K({planType:q.planType,userName:q.userName,prefix:q.prefix||void 0,randomLength:q.randomLength,startDate:q.startDate,expiryDate:q.expiryDate});$(R=>({...R,serialNumber:p.serialNumber,startDate:p.startDate,expiryDate:p.expiryDate}))}catch(p){console.error("Failed to refresh serial preview",p)}},className:"px-3 py-2 border border-slate-300 rounded-md hover:bg-slate-100 transition-colors text-sm flex items-center gap-2",disabled:!v,children:[s.jsx(da,{className:"h-4 w-4"}),"Preview"]})]}),s.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[s.jsx("input",{type:"checkbox",checked:q.autoGenerate,onChange:p=>$(R=>({...R,autoGenerate:p.target.checked})),disabled:!v}),v?"Auto-generate serial on save":"Manual serial entry required"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Customer"}),s.jsx("input",{type:"text",value:q.userName,onChange:p=>$(R=>({...R,userName:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",placeholder:"john@example.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Plan Type"}),s.jsxs("select",{value:q.planType,onChange:p=>$(R=>({...R,planType:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",children:[s.jsx("option",{value:"monthly",children:"Monthly"}),s.jsx("option",{value:"yearly",children:"Yearly"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status"}),s.jsxs("select",{value:q.status,onChange:p=>$(R=>({...R,status:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",children:[s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"expired",children:"Expired"}),s.jsx("option",{value:"disabled",children:"Disabled"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Start Date"}),s.jsx("input",{type:"date",value:q.startDate,onChange:p=>$(R=>({...R,startDate:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Expiry Date"}),s.jsx("input",{type:"date",value:q.expiryDate,onChange:p=>$(R=>({...R,expiryDate:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),s.jsx("textarea",{value:q.notes,onChange:p=>$(R=>({...R,notes:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",rows:3,placeholder:"Custom GPU build, allow remote disable, etc."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Serial Prefix (Optional)"}),s.jsx("input",{type:"text",value:q.prefix,onChange:p=>$(R=>({...R,prefix:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",placeholder:"CLIENT",disabled:!v}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Will be uppercased and sanitized automatically."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Random Segment Length"}),s.jsx("input",{type:"number",min:2,max:8,value:q.randomLength,onChange:p=>$(R=>({...R,randomLength:Number.parseInt(p.target.value,10)||4})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",disabled:!v}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Between 2 and 8 characters."})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("button",{type:"button",onClick:()=>{$({serialNumber:"",userName:"",planType:"monthly",startDate:new Date().toISOString().slice(0,10),expiryDate:new Date().toISOString().slice(0,10),status:"active",notes:"",prefix:"",autoGenerate:v,randomLength:4}),G(null)},className:"w-full px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-100 transition-colors text-sm",children:"Reset Form"})})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:()=>{ye(!1),G(null)},className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-100 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-md font-medium transition-colors",children:oe?"Save Changes":"Create License"})]})]}),s.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-slate-700",children:"License Inventory"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Track active, expired, and disabled serials."})]}),s.jsxs("div",{className:"text-xs text-slate-500",children:["Total: ",N.length]})]}),s.jsx("div",{className:"max-h-80 overflow-y-auto",children:O?s.jsxs("div",{className:"p-4 text-center text-sm text-slate-500 flex items-center justify-center gap-2",children:[s.jsx(da,{className:"h-4 w-4 animate-spin"}),"Loading licenses…"]}):N.length===0?s.jsx("div",{className:"p-4 text-center text-sm text-slate-500",children:"No licenses issued yet."}):s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-slate-50 text-slate-500 uppercase text-xs",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left",children:"Serial"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"User"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Plan"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Start"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Expiry"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Notes"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100",children:N.map(p=>s.jsxs("tr",{className:"hover:bg-slate-50",children:[s.jsx("td",{className:"px-4 py-3 font-mono text-xs text-slate-600",children:p.serialNumber}),s.jsx("td",{className:"px-4 py-3 text-slate-700",children:p.userName}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700 capitalize",children:p.planType})}),s.jsx("td",{className:"px-4 py-3 text-slate-500",children:p.startDate}),s.jsx("td",{className:"px-4 py-3 text-slate-500",children:p.expiryDate}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold capitalize ${p.status==="active"?"bg-emerald-100 text-emerald-700":p.status==="expired"?"bg-red-100 text-red-700":"bg-slate-200 text-slate-700"}`,children:p.status})}),s.jsx("td",{className:"px-4 py-3 text-slate-500 max-w-xs truncate",title:p.notes??"",children:p.notes??"—"}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>Ai(p),className:"p-2 rounded-md text-slate-500 hover:text-amber-600 hover:bg-amber-50 transition-colors",children:s.jsx(ts,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>Di(p),className:"p-2 rounded-md text-slate-500 hover:text-red-600 hover:bg-red-50 transition-colors",children:s.jsx(jt,{className:"h-4 w-4"})})]})})]},p.id))})]})})]})]}),w==="colors"&&s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Application Theme Color"}),s.jsx("div",{className:"grid grid-cols-6 gap-3",children:n.map(p=>s.jsxs("button",{onClick:()=>ht(p.color),className:`relative p-3 rounded-lg border-2 transition-all ${Se===p.color?"border-slate-400 ring-2 ring-slate-200":"border-slate-200 hover:border-slate-300"}`,children:[s.jsx("div",{className:"w-full h-8 rounded",style:{backgroundColor:p.color}}),s.jsx("div",{className:"text-xs text-slate-600 mt-1 text-center",children:p.name}),Se===p.color&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-slate-600 rounded-full border-2 border-white"})]},p.id))}),s.jsxs("div",{className:"mt-3",children:[s.jsx("input",{type:"color",value:Se,onChange:p=>ht(p.target.value),className:"w-20 h-10 rounded border border-slate-300"}),s.jsxs("span",{className:"ml-3 text-sm text-slate-600",children:["Custom Color: ",Se]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Application Background Color"}),s.jsx("div",{className:"grid grid-cols-6 gap-3",children:n.map(p=>s.jsxs("button",{onClick:()=>$t(p.color),className:`relative p-3 rounded-lg border-2 transition-all ${Ye===p.color?"border-slate-400 ring-2 ring-slate-200":"border-slate-200 hover:border-slate-300"}`,children:[s.jsx("div",{className:"w-full h-8 rounded",style:{backgroundColor:p.color}}),s.jsx("div",{className:"text-xs text-slate-600 mt-1 text-center",children:p.name}),Ye===p.color&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-slate-600 rounded-full border-2 border-white"})]},`bg-${p.id}`))}),s.jsxs("div",{className:"mt-3",children:[s.jsx("input",{type:"color",value:Ye,onChange:p=>$t(p.target.value),className:"w-20 h-10 rounded border border-slate-300"}),s.jsxs("span",{className:"ml-3 text-sm text-slate-600",children:["Custom Background: ",Ye]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Text Color"}),s.jsx("div",{className:"grid grid-cols-6 gap-3",children:n.map(p=>s.jsxs("button",{onClick:()=>At(p.color),className:`relative p-3 rounded-lg border-2 transition-all ${Ke===p.color?"border-slate-400 ring-2 ring-slate-200":"border-slate-200 hover:border-slate-300"}`,children:[s.jsx("div",{className:"w-full h-8 rounded",style:{backgroundColor:p.color}}),s.jsx("div",{className:"text-xs text-slate-600 mt-1 text-center",children:p.name}),Ke===p.color&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-slate-600 rounded-full border-2 border-white"})]},`text-${p.id}`))}),s.jsxs("div",{className:"mt-3",children:[s.jsx("input",{type:"color",value:Ke,onChange:p=>At(p.target.value),className:"w-20 h-10 rounded border border-slate-300"}),s.jsxs("span",{className:"ml-3 text-sm text-slate-600",children:["Custom Text Color: ",Ke]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Highlight Text Color"}),s.jsx("div",{className:"grid grid-cols-6 gap-3",children:n.map(p=>s.jsxs("button",{onClick:()=>$e(p.color),className:`relative p-3 rounded-lg border-2 transition-all ${nt===p.color?"border-slate-400 ring-2 ring-slate-200":"border-slate-200 hover:border-slate-300"}`,children:[s.jsx("div",{className:"w-full h-8 rounded",style:{backgroundColor:p.color}}),s.jsx("div",{className:"text-xs text-slate-600 mt-1 text-center",children:p.name}),nt===p.color&&s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-slate-600 rounded-full border-2 border-white"})]},`highlight-${p.id}`))}),s.jsxs("div",{className:"mt-3",children:[s.jsx("input",{type:"color",value:nt,onChange:p=>$e(p.target.value),className:"w-20 h-10 rounded border border-slate-300"}),s.jsxs("span",{className:"ml-3 text-sm text-slate-600",children:["Custom Highlight: ",nt]})]})]}),s.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[s.jsx("h3",{className:"font-medium text-slate-800 mb-3",children:"Theme Preview"}),s.jsxs("div",{className:"w-full h-32 rounded-lg flex items-center justify-center font-medium relative overflow-hidden",style:{backgroundColor:Ye},children:[s.jsx("div",{className:"absolute top-2 right-2 px-3 py-1 rounded text-sm",style:{backgroundColor:Se,color:Ye},children:"Theme Color"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl font-semibold",style:{color:Ke},children:Et||"Event Manager"}),s.jsx("div",{className:"text-sm opacity-80 mt-1",style:{color:Ke},children:It||"Professional Hospitality Event Management"}),s.jsx("div",{className:"text-sm mt-2 font-medium",style:{color:nt},children:"Highlight Color Sample"})]})]})]})]}),w==="users"&&Xt&&s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-orange-50 border border-orange-300 rounded-xl p-4 shadow-sm text-sm text-orange-800",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2 font-semibold text-orange-900",children:[s.jsx(Ar,{className:"h-4 w-4 text-orange-500"}),"Role Permissions"]}),s.jsxs("ul",{className:"space-y-1 leading-relaxed",children:[s.jsx("li",{children:"• Admin & Manager can delete events"}),s.jsx("li",{children:"• Managers manage host & operator accounts"}),s.jsx("li",{children:"• Each user badge follows EVN### numbering"})]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Users"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Manage team members and their roles."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>{Ss(),Fe(!0)},className:"px-4 py-2 rounded-md font-medium transition-colors flex items-center gap-2 bg-amber-500 hover:bg-amber-600 text-white",children:[s.jsx(Je,{className:"h-4 w-4"}),"New User"]}),s.jsx("button",{onClick:_s,className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-100 transition-colors",children:"Refresh"})]})]}),b&&s.jsx("div",{className:"px-3 py-2 rounded-lg bg-red-50 border border-red-200 text-sm text-red-700",children:b}),(mt||ge)&&s.jsxs("form",{onSubmit:Zi,className:"bg-white border border-slate-200 rounded-lg p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-semibold text-slate-700",children:ge?`Edit ${fe==null?void 0:fe.username}`:"Create User"}),s.jsx("button",{type:"button",onClick:Ss,className:"text-sm text-slate-500 hover:text-slate-700",children:"Cancel"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Username"}),s.jsx("input",{type:"text",value:Ee.username,onChange:p=>Ie(R=>({...R,username:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",required:!0,disabled:ge})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Password"}),s.jsx("input",{type:"password",value:Ee.password,onChange:p=>Ie(R=>({...R,password:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",placeholder:ge?"Leave blank to keep current password":void 0,required:!ge})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"First Name"}),s.jsx("input",{type:"text",value:Ee.firstName,onChange:p=>Ie(R=>({...R,firstName:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Last Name"}),s.jsx("input",{type:"text",value:Ee.lastName,onChange:p=>Ie(R=>({...R,lastName:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Phone"}),s.jsx("input",{type:"tel",value:Ee.phone,onChange:p=>Ie(R=>({...R,phone:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",value:Ee.email,onChange:p=>Ie(R=>({...R,email:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Role"}),s.jsxs("select",{value:Ee.role,onChange:p=>Ie(R=>({...R,role:p.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500",children:[s.jsx("option",{value:"admin",children:"Admin"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"host",children:"Host"}),s.jsx("option",{value:"operator",children:"Operator"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:Ss,className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-100 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-md font-medium transition-colors",children:ge?"Save Changes":"Create User"})]})]}),s.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg",children:[s.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-slate-700",children:"Team Members"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Admins and managers can manage all users."})]}),s.jsxs("div",{className:"text-xs text-slate-500",children:["Total: ",x.length]})]}),s.jsx("div",{className:"max-h-80 overflow-y-auto",children:g?s.jsx("div",{className:"p-4 text-center text-sm text-slate-500",children:"Loading users…"}):x.length===0?s.jsx("div",{className:"p-4 text-center text-sm text-slate-500",children:"No users found."}):s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-slate-50 text-slate-500 uppercase text-xs",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left",children:"ID"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Name"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Username"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Role"}),s.jsx("th",{className:"px-4 py-3 text-left",children:"Contact"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100",children:x.map(p=>s.jsxs("tr",{className:"hover:bg-slate-50",children:[s.jsxs("td",{className:"px-4 py-3 font-mono text-xs text-slate-500",children:[p.id,p.isDefaultAdmin&&s.jsx("span",{className:"ml-2 text-[10px] text-amber-600 uppercase tracking-wide",children:"Default"})]}),s.jsxs("td",{className:"px-4 py-3 text-slate-700",children:[p.firstName," ",p.lastName]}),s.jsx("td",{className:"px-4 py-3 text-slate-600",children:p.username}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700 capitalize",children:p.role})}),s.jsxs("td",{className:"px-4 py-3 text-slate-500",children:[s.jsx("div",{children:p.phone}),s.jsx("div",{className:"text-xs",children:p.email})]}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>qi(p),className:"p-2 rounded-md text-slate-500 hover:text-amber-600 hover:bg-amber-50 transition-colors",disabled:p.isDefaultAdmin&&(m==null?void 0:m.role)!=="admin",children:s.jsx(ts,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>zi(p.id),className:"p-2 rounded-md text-slate-500 hover:text-red-600 hover:bg-red-50 transition-colors",disabled:p.isDefaultAdmin||p.id===(m==null?void 0:m.id),children:s.jsx(jt,{className:"h-4 w-4"})})]})})]},p.id))})]})})]})]}),w==="database"&&s.jsx("div",{className:"p-6 space-y-6",children:s.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"SQL Database Connection"}),s.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Enter your SQL database credentials and link them to the application."}),s.jsxs("div",{className:"grid gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"DB_HOST"}),s.jsx("input",{type:"text",value:Ve,onChange:p=>xr(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"localhost"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"DB_USER"}),s.jsx("input",{type:"text",value:Yt,onChange:p=>yr(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"root"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"DB_PASSWORD"}),s.jsx("input",{type:"password",value:ia,onChange:p=>br(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"••••••••"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"DB_NAME"}),s.jsx("input",{type:"text",value:Kt,onChange:p=>vr(p.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"event_manager"})]})]}),s.jsxs("div",{className:"mt-4 flex flex-wrap gap-3",children:[s.jsx("button",{onClick:Nr,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md font-medium transition-colors",children:"Connect / Install"}),s.jsx("button",{onClick:()=>{var p;return(p=wr.current)==null?void 0:p.click()},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors",children:"Import SQL File"}),s.jsx("button",{onClick:Mi,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-md font-medium transition-colors",children:"Export Database"}),s.jsx("input",{ref:wr,type:"file",accept:".sql",onChange:p=>{var be;const R=(be=p.target.files)==null?void 0:be[0];R&&(Ri(R),p.target.value="")},className:"hidden"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-3",children:"Note: These actions require backend implementation to interact with your SQL database."})]})})]})]}),s.jsxs("div",{className:"flex justify-between items-center gap-3 p-6 border-t border-slate-200 bg-slate-50 flex-shrink-0",children:[s.jsx("button",{onClick:Li,className:"px-4 py-2 text-red-600 border border-red-300 rounded-md hover:bg-red-50 transition-colors font-medium",children:"Reset to Defaults"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-slate-700 border border-slate-300 rounded-md hover:bg-slate-50 transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:Oi,className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-md font-medium transition-colors flex items-center gap-2",children:[s.jsx(Tn,{className:"h-4 w-4"}),"Save Changes"]})]})]})]})}):null},zf=({isOpen:e,onClose:t})=>{const{events:a,settings:r}=Ae(),[n,o]=T.useState([]),[l,c]=T.useState(""),[d,i]=T.useState(""),[u,m]=T.useState("view"),[w,j]=T.useState(!1),[x,f]=T.useState(!1),[g,y]=T.useState(""),[b,E]=T.useState(""),[N,O]=T.useState(!1),I=()=>{const M=new Date;M.setHours(0,0,0,0);const K=a.filter(P=>{const J=new Date(P.date);return J.setHours(0,0,0,0),J>=M}).slice(0,50);console.log("📅 Calendar Generation Debug:",{today:M.toISOString(),totalEvents:a.length,futureEventsCount:K.length,includedDates:K.map(P=>P.date),todayEvents:a.filter(P=>P.date===M.toISOString().split("T")[0])});let v=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//${r.storeName}//Event Management//EN
NAME:${r.storeName} Events
X-WR-CALNAME:${r.storeName} Events
DESCRIPTION:Event calendar for ${r.storeName}
X-WR-CALDESC:Event calendar for ${r.storeName}
TIMEZONE-ID:America/New_York
X-WR-TIMEZONE:America/New_York
`;return K.forEach(P=>{const J=P.date.replace(/-/g,""),ie=P.startTime.replace(":","")+"00",ee=P.endTime.replace(":","")+"00",le=`${J}T${ie}`,ae=`${J}T${ee}`,h=`${P.id}@${r.storeName.toLowerCase().replace(/\s+/g,"-")}.com`;console.log("📝 Processing event:",{title:P.title,date:P.date,startDateTime:le,endDateTime:ae}),v+=`
BEGIN:VEVENT
UID:${h}
DTSTART:${le}
DTEND:${ae}
SUMMARY:${P.title}
DESCRIPTION:${P.title}\\n\\nVenue: ${P.venue}\\n\\nContact: ${P.contact.name}\\nPhone: ${P.contact.phone}\\nEmail: ${P.contact.email}${P.notes?`\\n\\nNotes: ${P.notes}`:""}\\n\\nStatus: ${P.status}\\nPayment: ${P.paymentStatus}
LOCATION:${P.venue} - ${r.storeAddress||r.storeName}
STATUS:${P.status==="confirmed"?"CONFIRMED":P.status==="cancelled"?"CANCELLED":"TENTATIVE"}
ORGANIZER;CN=${r.storeName}:mailto:${r.storeEmail}
CREATED:${P.createdAt.replace(/[-:]/g,"").split(".")[0]}Z
LAST-MODIFIED:${P.updatedAt.replace(/[-:]/g,"").split(".")[0]}Z
END:VEVENT`}),v+=`
END:VCALENDAR`,v},Y=async()=>{O(!0);try{const M=I(),v=`data:text/calendar;charset=utf-8;base64,${btoa(unescape(encodeURIComponent(M)))}`,P=`${r.storeName.replace(/\s+/g,"_")}_Events`,J={outlook:`https://outlook.live.com/calendar/0/addfromweb?name=${encodeURIComponent(P)}&url=${encodeURIComponent(v)}`,google:`https://calendar.google.com/calendar/render?cid=${encodeURIComponent(v)}`,icalendar:v,webcal:`webcal://calendar.stuntec.org/${P}.ics`};E(v);const ie=`🗓️ LIVE CALENDAR LINKS - ${r.storeName}

📧 EMAIL THESE LINKS TO YOUR TEAM:

🔵 OUTLOOK WEB:
${J.outlook}

🔴 GOOGLE CALENDAR:
${J.google}

📱 UNIVERSAL .ICS LINK:
${J.icalendar}

📋 SHARING INSTRUCTIONS:

1️⃣ OUTLOOK USERS: Click the Outlook link above
2️⃣ GMAIL USERS: Click the Google Calendar link above  
3️⃣ OTHER USERS: Right-click the Universal link → Save As → Import to calendar

💡 TEAM ACCESS TIPS:
• Forward these links to managers and staff
• Create shared calendar folders in email clients
• Set up team notifications for new events
• Bookmark links for easy re-access

📊 CALENDAR INCLUDES:
✅ ${a.filter(ee=>new Date(ee.date)>=new Date).length} upcoming events
✅ Venue locations and contact info
✅ Payment status and notes
✅ Automatic timezone handling

🔄 UPDATES: Calendar reflects current data. Re-import periodically for latest changes.

📞 Support: ${r.storeEmail} | ${r.storePhone}`;await navigator.clipboard.writeText(ie),y("📧 Calendar links & instructions copied! Ready to email to your team."),setTimeout(()=>y(""),5e3)}catch(M){console.error("Failed to generate calendar URL:",M),alert("Failed to generate calendar URL. Please try the download option instead.")}finally{O(!1)}},L=async()=>{j(!0);try{const M=I(),K=new Blob([M],{type:"text/calendar;charset=utf-8"}),v=URL.createObjectURL(K),P=new Date;P.setHours(0,0,0,0);const J=a.filter(le=>{const ae=new Date(le.date);return ae.setHours(0,0,0,0),ae>=P}).length,ie=`🗓️ ${r.storeName} Event Calendar - ${new Date().toLocaleDateString()}

🚨 IMPORTANT: This is a SNAPSHOT calendar file (not live-updating)

📥 TO ADD TO YOUR CALENDAR:

▶️ OUTLOOK (Desktop & Web):
1. Download the .ics file below
2. Outlook Desktop: File → Import → Calendar from File
3. Outlook Web: Settings → Calendar → Import calendar

▶️ GMAIL/GOOGLE CALENDAR:
1. Download the .ics file below  
2. Gmail: Settings ⚙️ → Import & Export → Import
3. Google Calendar: + Create → Import

▶️ APPLE CALENDAR (iPhone/Mac):
1. Download and open the .ics file
2. Mac: File → Import → Import
3. iPhone: Email the file to yourself and tap to add

▶️ YAHOO MAIL:
1. Download the .ics file below
2. Yahoo Calendar → Import → Choose file

▶️ ICLOUD CALENDAR:
1. Go to Calendar.icloud.com
2. Import → Select the downloaded file

📊 CALENDAR CONTENTS:
• ${J} upcoming events (including today: ${P.toLocaleDateString()})
• Event dates, times & venues
• Contact information
• Payment status tracking
• Special notes & requirements

⚠️ LIVE UPDATES NOTICE:
This calendar does NOT auto-update! When new events are added or changed:
1. Re-download this calendar file
2. Re-import to your email calendar
3. Or ask for a new share link

📞 Contact: ${r.storeEmail} | Phone: ${r.storePhone}

💡 TIP: Bookmark this page to easily get updated calendar files!`;await navigator.clipboard.writeText(ie),y("📋 Calendar instructions copied! Share via email or text."),setTimeout(()=>y(""),4e3);const ee=document.createElement("a");ee.href=v,ee.download=`${r.storeName.replace(/\s+/g,"_")}_Events_Calendar.ics`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(v)}catch(M){console.error("Failed to generate calendar link:",M),alert("Failed to generate calendar link. Please try again.")}finally{j(!1)}},B=async()=>{var K,v;if(!l){alert("Please enter an email address");return}f(!0);const M=Date.now();console.log("📧 Starting calendar invite email generation:",{recipient:l,name:d,permission:u});try{const P=(v=(K=globalThis.ywConfig)==null?void 0:K.ai_config)==null?void 0:v.email_generator;if(!P)throw new Error("Email generator configuration not found");const J=Qs({baseURL:"https://api.youware.com/public/v1/ai",apiKey:"sk-YOUWARE"}),ie=`${r.storeName} - Event Management & Calendar Sharing`,ee=a.filter(oe=>new Date(oe.date)>=new Date).slice(0,5),{text:le}=await qa({model:J(P.model),messages:[{role:"system",content:P.system_prompt({emailType:"calendar_invitation",businessContext:ie})},{role:"user",content:`Generate a professional calendar sharing invitation email for:

Business: ${r.storeName}
Manager Name: ${d||"Team Manager"}
Email: ${l}
Permission Level: ${u} access
Contact: ${r.storeEmail} | ${r.storePhone}

Recent Events (sample):
${ee.map(oe=>`- ${oe.title} (${me(new Date(oe.date),"MMM dd, yyyy")} at ${oe.venue})`).join(`
`)}

Include:
- Warm, professional greeting
- Calendar sharing purpose and benefits
- Instructions for different email providers (Outlook, Gmail, iCloud, Yahoo)
- What events/information they'll see
- Live update explanation
- Contact information for questions
- Professional closing

Tone: Professional but friendly, suitable for hospitality business.`}],temperature:P.temperature||.7,maxTokens:P.maxTokens||4e3});console.log("✅ Calendar invite email generated successfully:",{contentLength:le.length,processingTime:`${Date.now()-M}ms`});const ae={id:Date.now().toString(),name:d||"Team Manager",email:l,permissions:u,createdAt:new Date().toISOString(),active:!0};o([...n,ae]);const h=I(),C=new Blob([h],{type:"text/calendar;charset=utf-8"}),z=URL.createObjectURL(C),_=document.createElement("a");_.href=z,_.download=`${r.storeName.replace(/\s+/g,"_")}_Calendar.ics`;const V=`Calendar Access - ${r.storeName} Events`,q=encodeURIComponent(le+`

[Please attach the downloaded calendar file to this email before sending]`),$=`mailto:${l}?subject=${encodeURIComponent(V)}&body=${q}`;_.click(),setTimeout(()=>{window.open($)},1e3),URL.revokeObjectURL(z),c(""),i(""),alert("Calendar file downloaded and email client opened! Please attach the calendar file before sending.")}catch(P){console.error("❌ Calendar invite email generation failed:",{error:P.message,processingTime:`${Date.now()-M}ms`}),alert(`Email generation failed: ${P.message}`)}finally{f(!1)}},re=M=>{o(n.filter(K=>K.id!==M))},F=M=>{o(n.map(K=>K.id===M?{...K,active:!K.active}:K))};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gt,{className:"h-6 w-6 text-amber-600"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Calendar Sharing"}),s.jsx("p",{className:"text-slate-600",children:"Share event calendar with managers and team"})]})]}),s.jsx("button",{onClick:t,className:"p-2 text-slate-600 hover:text-slate-800 transition-colors",children:s.jsx(Ut,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-r from-blue-50 to-amber-50 rounded-lg border border-blue-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:"🗓️ Universal Calendar Export"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[s.jsxs("button",{onClick:L,disabled:w,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg font-medium transition-colors",children:[w?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(gt,{className:"h-4 w-4"}),w?"Generating...":"Download .ICS File"]}),s.jsxs("button",{onClick:Y,disabled:N,className:"flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-400 text-white rounded-lg font-medium transition-colors",children:[N?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx($r,{className:"h-4 w-4"}),N?"Generating...":"Generate Share Links"]}),s.jsxs("button",{onClick:()=>{window.open("https://outlook.live.com/calendar/0/addfromweb","_blank")},className:"flex items-center gap-2 px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors",children:[s.jsx(Ta,{className:"h-4 w-4"}),"Outlook Import"]}),s.jsxs("button",{onClick:()=>{window.open("https://calendar.google.com/calendar/u/0/r/settings/addbyurl","_blank")},className:"flex items-center gap-2 px-6 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:[s.jsx(Ta,{className:"h-4 w-4"}),"Google Import"]})]}),g&&s.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-green-100 text-green-800 rounded-lg mb-4",children:[s.jsx(Nl,{className:"h-4 w-4"}),g]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[s.jsx("h4",{className:"font-medium text-slate-800 mb-2",children:"📱 Universal Compatibility:"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm text-slate-600",children:[s.jsx("div",{children:"✅ Outlook (Desktop/Web/Mobile)"}),s.jsx("div",{children:"✅ Gmail/Google Calendar"}),s.jsx("div",{children:"✅ Apple Calendar (iPhone/Mac)"}),s.jsx("div",{children:"✅ Yahoo Mail Calendar"}),s.jsx("div",{children:"✅ iCloud Calendar"}),s.jsx("div",{children:"✅ Mozilla Thunderbird"}),s.jsx("div",{children:"✅ Samsung Calendar"}),s.jsx("div",{children:"✅ Office 365 Business"})]}),s.jsxs("div",{className:"mt-3 p-3 bg-gradient-to-r from-emerald-50 to-blue-50 rounded border",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx($r,{className:"h-4 w-4 text-emerald-600"}),s.jsx("span",{className:"font-medium text-slate-700",children:'📧 Share Links: Click "Generate Share Links" to get direct URLs for team distribution'})]}),s.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Links work instantly - no file downloads needed! Perfect for emailing to managers."})]}),s.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["💡 Contains ",a.filter(M=>new Date(M.date)>=new Date).length," upcoming events with venue info, contacts, and payment status."]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Invite Manager"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Manager Name"}),s.jsx("input",{type:"text",value:d,onChange:M=>i(M.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Manager name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email Address"}),s.jsx("input",{type:"email",value:l,onChange:M=>c(M.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"manager@email.com"})]})]}),s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Permission Level:"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",value:"view",checked:u==="view",onChange:M=>m(M.target.value),className:"mr-2"}),"View Only"]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",value:"edit",checked:u==="edit",onChange:M=>m(M.target.value),className:"mr-2"}),"Edit Access"]})]})]}),s.jsxs("button",{onClick:B,disabled:x||!l,className:"flex items-center gap-2 px-6 py-3 bg-amber-600 hover:bg-amber-700 disabled:bg-amber-400 text-white rounded-lg font-medium transition-colors",children:[x?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(vc,{className:"h-4 w-4"}),x?"Generating...":"Send Calendar Invitation"]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Shared With"}),n.length===0?s.jsxs("div",{className:"text-center py-8 bg-slate-50 rounded-lg",children:[s.jsx(ns,{className:"h-12 w-12 mx-auto mb-3 text-slate-400"}),s.jsx("p",{className:"text-slate-600",children:"No calendar shares yet"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Add managers above to start sharing"})]}):s.jsx("div",{className:"space-y-3",children:n.map(M=>s.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${M.active?"bg-green-500":"bg-slate-400"}`}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-800",children:M.name}),s.jsx("p",{className:"text-sm text-slate-600",children:M.email}),s.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${M.permissions==="edit"?"bg-amber-100 text-amber-800":"bg-blue-100 text-blue-800"}`,children:M.permissions==="edit"?"Edit Access":"View Only"}),s.jsxs("span",{className:"text-xs text-slate-500",children:["Added ",me(new Date(M.createdAt),"MMM dd, yyyy")]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>F(M.id),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${M.active?"bg-red-100 text-red-800 hover:bg-red-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,children:M.active?"Disable":"Enable"}),s.jsx("button",{onClick:()=>re(M.id),className:"p-2 text-slate-600 hover:text-red-600 transition-colors",children:s.jsx(Ut,{className:"h-4 w-4"})})]})]},M.id))})]}),s.jsxs("div",{className:"bg-slate-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"📋 Step-by-Step Integration Guide"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[s.jsxs("h4",{className:"font-medium text-blue-600 mb-3 flex items-center gap-2",children:[s.jsx(ea,{className:"h-4 w-4"}),"Microsoft Outlook"]}),s.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[s.jsx("div",{children:s.jsx("strong",{children:"Desktop (2016+):"})}),s.jsx("div",{children:"1. Download the .ICS file above"}),s.jsx("div",{children:"2. File → Open & Export → Import/Export"}),s.jsx("div",{children:'3. "Import an iCalendar (.ics) file"'}),s.jsx("div",{children:"4. Browse to downloaded file"}),s.jsx("div",{className:"pt-2",children:s.jsx("strong",{children:"Outlook Web:"})}),s.jsx("div",{children:"1. Settings ⚙️ → Calendar"}),s.jsx("div",{children:'2. "Import calendar" → Upload .ICS'})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[s.jsxs("h4",{className:"font-medium text-red-600 mb-3 flex items-center gap-2",children:[s.jsx(zl,{className:"h-4 w-4"}),"Gmail/Google Calendar"]}),s.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[s.jsx("div",{children:s.jsx("strong",{children:"Method 1 (Gmail):"})}),s.jsx("div",{children:"1. Gmail Settings → Import & Export"}),s.jsx("div",{children:'2. "Import" → Select .ICS file'}),s.jsx("div",{className:"pt-2",children:s.jsx("strong",{children:"Method 2 (Google Calendar):"})}),s.jsx("div",{children:"1. Google Calendar → Settings ⚙️"}),s.jsx("div",{children:'2. "Import & export" → Import'}),s.jsx("div",{children:"3. Choose calendar & upload .ICS"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[s.jsx("h4",{className:"font-medium text-gray-600 mb-3 flex items-center gap-2",children:"📱 Apple Calendar"}),s.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[s.jsx("div",{children:s.jsx("strong",{children:"Mac:"})}),s.jsx("div",{children:"1. Double-click the .ICS file"}),s.jsx("div",{children:"2. Choose target calendar"}),s.jsx("div",{children:'3. Click "Import"'}),s.jsx("div",{className:"pt-2",children:s.jsx("strong",{children:"iPhone:"})}),s.jsx("div",{children:"1. Email .ICS file to yourself"}),s.jsx("div",{children:"2. Tap the attachment"}),s.jsx("div",{children:'3. "Add to Calendar"'})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[s.jsx("h4",{className:"font-medium text-purple-600 mb-3",children:"🌐 Other Platforms"}),s.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Yahoo Mail:"})," Calendar → Import"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"iCloud:"})," Calendar.icloud.com → Import"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Thunderbird:"})," Events & Tasks → Import"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Samsung Calendar:"})," Settings → Import"]}),s.jsx("div",{className:"pt-2 text-xs text-slate-500",children:"Most calendar apps support .ICS import"})]})]})]}),b&&s.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[s.jsx("h4",{className:"font-medium text-slate-800 mb-3 flex items-center gap-2",children:"🔗 Direct Calendar Links Generated"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-white rounded p-3 border",children:[s.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Universal Calendar URL:"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:b,readOnly:!0,className:"flex-1 text-xs p-2 bg-slate-50 border rounded font-mono"}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(b),y("Calendar URL copied!"),setTimeout(()=>y(""),2e3)},className:"px-3 py-1 bg-slate-600 text-white rounded text-xs hover:bg-slate-700",children:s.jsx(Ca,{className:"h-3 w-3"})})]})]}),s.jsxs("div",{className:"text-sm text-slate-600",children:["📧 ",s.jsx("strong",{children:"Email this URL"})," to team members for instant calendar access!"]})]})]}),s.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border border-green-200",children:[s.jsx("h4",{className:"font-medium text-slate-800 mb-2",children:"💡 Pro Team Management Tips:"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-slate-700",children:[s.jsx("div",{children:"📧 Email calendar links to all managers"}),s.jsx("div",{children:"📁 Create shared calendar folders"}),s.jsx("div",{children:"🔔 Enable event notifications"}),s.jsx("div",{children:"🔄 Re-import monthly for updates"}),s.jsx("div",{children:"🎨 Use calendar colors for venues"}),s.jsx("div",{children:"📱 Sync across all team devices"}),s.jsx("div",{children:"👥 Set appropriate access permissions"}),s.jsx("div",{children:"📅 Schedule regular calendar reviews"})]})]}),s.jsxs("div",{className:"mt-4 space-y-3",children:[s.jsxs("div",{className:"p-4 bg-red-50 rounded-lg border-2 border-red-200",children:[s.jsx("h4",{className:"font-bold text-red-800 mb-2",children:"🚨 LIVE UPDATES LIMITATION"}),s.jsxs("div",{className:"text-sm text-red-700 space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Problem:"})," .ICS calendar files are static snapshots, NOT live feeds!"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Solution:"})," When you add/change events in your system:"]}),s.jsxs("ul",{className:"list-disc ml-4 space-y-1",children:[s.jsx("li",{children:"Re-download the updated calendar file"}),s.jsx("li",{children:"Re-import it to your email calendar"}),s.jsx("li",{children:"Or generate new share links for your team"})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Recommendation:"})," Update shared calendars weekly or after major changes."]})]})]}),s.jsx("div",{className:"p-3 bg-amber-50 rounded border border-amber-200",children:s.jsxs("p",{className:"text-sm text-amber-800",children:[s.jsx("strong",{children:"🔄 Updates:"})," Calendar data reflects current events at time of generation. Re-generate links monthly or after major scheduling changes."]})}),s.jsx("div",{className:"p-3 bg-blue-50 rounded border border-blue-200",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"🛡️ Privacy:"})," Calendar links contain event data but no sensitive payment details. Share only with authorized team members."]})})]})]})]})]})}):null},Gf=()=>{const[e,t]=T.useState(!1),[a,r]=T.useState(!1),[n,o]=T.useState(null),{addEvent:l}=Ae(),c=()=>{const j=["Title,Venue,Date,Start Time,End Time,Status,Payment Status,Contact Name,Contact Phone,Contact Email,Notes","Sample Birthday Party,restaurant,2025-10-01,18:00,22:00,pending,unpaid,John Doe,313-555-0123,john@example.com,Birthday celebration","Corporate Meeting,banquet,2025-10-05,12:00,15:00,confirmed,paid,Jane Smith,313-555-0124,jane@company.com,Quarterly meeting"].join(`
`),x=new Blob([j],{type:"text/csv"}),f=URL.createObjectURL(x),g=document.createElement("a");g.href=f,g.download="events_template.csv",g.click(),URL.revokeObjectURL(f)},d=async()=>{t(!0);const j=API_ENDPOINTS.eventsExport;if(window.location.hostname.includes("paintress")||window.location.hostname.includes("preview")||navigator.userAgent.includes("HeadlessChrome")){console.log("🖼️ Screenshot environment detected - export not available"),alert(`Export functionality is not available in preview mode.
Please use this feature in the live application.`),t(!1);return}try{console.log("📦 Starting CSV export..."),console.log("📍 Target URL:",j);const f=await fetch(j,{method:"GET",headers:{Accept:"text/csv,application/json,*/*"},signal:AbortSignal.timeout(15e3)});if(console.log("📡 Export response:",{status:f.status,statusText:f.statusText,url:f.url,ok:f.ok}),!f.ok){const E=await f.text().catch(()=>"Could not read error response");throw console.error("❌ Export failed:",{status:f.status,statusText:f.statusText,errorBody:E}),new Error(`Export failed: ${f.status} ${f.statusText}`)}const g=await f.blob(),y=URL.createObjectURL(g),b=document.createElement("a");b.href=y,b.download=`events_export_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(y),console.log("✅ Export completed successfully")}catch(f){const g=f instanceof Error?f.message:"Unknown error",y=g.includes("Failed to fetch")||g.includes("NetworkError");console.error("❌ Export error:",{targetUrl:j,error:g,isNetworkError:y,timestamp:new Date().toISOString()}),y?alert("Export failed: Network issue while contacting the server. Please try again later."):g.includes("timeout")?alert("Export failed: Request timed out. Please try again."):alert(`Export failed: ${g}`)}finally{t(!1)}},i=j=>{if(!j||typeof j!="string")return null;const x=j.trim();if(![/^\d{4}-\d{2}-\d{2}$/,/^\d{2}\/\d{2}\/\d{4}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/,/^\d{4}\/\d{2}\/\d{2}$/].some(b=>b.test(x)))return null;let y;try{if(x.includes("/")){const[O,I,Y]=x.split("/").map(L=>parseInt(L,10));if(y=new Date(Y,O-1,I),y.getFullYear()!==Y||y.getMonth()!==O-1||y.getDate()!==I)return null}else if(y=new Date(x+"T00:00:00"),isNaN(y.getTime()))return null;const b=y.getFullYear(),E=String(y.getMonth()+1).padStart(2,"0"),N=String(y.getDate()).padStart(2,"0");return`${b}-${E}-${N}`}catch(b){return console.warn("Date parsing error:",b,"for date:",x),null}},u=j=>{if(!j||typeof j!="string")return null;const x=j.trim(),f=/^(\d{1,2}):(\d{2})\s*(AM|PM|am|pm)?$/,g=x.match(f);if(!g)return null;let[,y,b,E]=g,N=parseInt(y,10);const O=parseInt(b,10);if(O<0||O>59)return null;if(E){const I=E.toUpperCase()==="PM";N===12?N=I?12:0:I&&(N+=12)}return N<0||N>23?null:`${String(N).padStart(2,"0")}:${String(O).padStart(2,"0")}`},m=(j,x)=>{var f,g,y,b,E,N,O,I;try{const Y=(f=j.Title)==null?void 0:f.toString().trim(),L=(g=j.Venue)==null?void 0:g.toString().trim().toLowerCase(),B=(y=j["Contact Name"])==null?void 0:y.toString().trim();if(!Y||!L||!B)return console.warn(`Row ${x}: Missing required fields`),null;const re=i(j.Date);if(!re)return console.warn(`Row ${x}: Invalid date format:`,j.Date),null;const F=u(j["Start Time"]),M=u(j["End Time"]);if(!F||!M)return console.warn(`Row ${x}: Invalid time format:`,{startTime:j["Start Time"],endTime:j["End Time"]}),null;if(!["restaurant","bar","banquet"].includes(L))return console.warn(`Row ${x}: Invalid venue type:`,L),null;const v=((b=j.Status)==null?void 0:b.toString().trim().toLowerCase())||"pending",J=["pending","confirmed","cancelled","closed"].includes(v)?v:"pending",ie=((E=j["Payment Status"])==null?void 0:E.toString().trim().toLowerCase())||"unpaid",le=["paid","unpaid"].includes(ie)?ie:"unpaid",ae=((N=j["Contact Phone"])==null?void 0:N.toString().trim())||"",h=((O=j["Contact Email"])==null?void 0:O.toString().trim())||"";return{title:Y,venue:L,venueId:L,date:re,startTime:F,endTime:M,status:J,paymentStatus:le,paymentMethod:le==="paid"?"cash":void 0,contact:{name:B,phone:ae,email:h},notes:((I=j.Notes)==null?void 0:I.toString().trim())||""}}catch(Y){return console.error(`Row ${x} validation error:`,Y),null}},w=j=>{var g;const x=(g=j.target.files)==null?void 0:g[0];if(!x)return;r(!0),o(null);const f=new FileReader;f.onload=y=>{var b;try{console.log("📥 Starting CSV import...");const N=((b=y.target)==null?void 0:b.result).split(`
`).filter(F=>F.trim());if(N.length<2){o("CSV file appears to be empty or only contains headers."),r(!1);return}const O=N[0].split(",").map(F=>F.trim().replace(/^"|"$/g,""));console.log("📋 Headers found:",O);const Y=["Title","Venue","Date","Start Time","End Time","Status","Payment Status","Contact Name","Contact Phone","Contact Email"].filter(F=>!O.includes(F));if(Y.length>0){o(`Missing required columns: ${Y.join(", ")}`),r(!1);return}let L=0,B=0;const re=[];for(let F=1;F<N.length;F++){const M=N[F].trim();if(M)try{console.log(`🔍 Processing row ${F+1}:`,M);const K=M.split(",").map(J=>J.trim().replace(/^"|"$/g,"")),v={};O.forEach((J,ie)=>{v[J]=K[ie]||""});const P=m(v,F+1);if(!P){B++,re.push(`Row ${F+1}: Invalid data format`);continue}console.log(`✅ Row ${F+1} validated:`,P),l(P),L++}catch(K){B++;const v=K instanceof Error?K.message:"Unknown error";re.push(`Row ${F+1}: ${v}`),console.error(`❌ Error processing row ${F+1}:`,K)}}if(L>0){let F=`Successfully imported ${L} events`;B>0&&(F+=` (${B} rows had errors)`,console.warn("Import errors:",re)),alert(F),console.log(`🎉 Import completed: ${L} success, ${B} errors`)}else o("No valid events found in the file. Please check the data format."),re.length>0&&console.error("All import errors:",re)}catch(E){console.error("💥 Import error:",E);const N=E instanceof Error?E.message:"Unknown error";o(`Failed to parse CSV file: ${N}. Please check the file format.`)}finally{r(!1),j.target.value=""}},f.readAsText(x)};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(Vl,{className:"w-5 h-5 text-gray-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Import/Export"})]}),n&&s.jsxs("div",{className:"flex items-start space-x-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx(Nn,{className:"w-5 h-5 text-red-500 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-red-800",children:"Import Error"}),s.jsx("p",{className:"text-sm text-red-600",children:n})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("button",{onClick:c,className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 transition-colors",children:[s.jsx(Lt,{className:"w-5 h-5 text-gray-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Download Template"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Get CSV template with sample data"})]})]}),s.jsxs("label",{className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-blue-300 rounded-lg hover:border-blue-400 transition-colors cursor-pointer",children:[s.jsx(Wa,{className:"w-5 h-5 text-blue-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:a?"Importing...":"Import Events"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Upload CSV file with events"})]}),s.jsx("input",{type:"file",accept:".csv",onChange:w,disabled:a,className:"hidden"})]}),s.jsxs("button",{onClick:d,disabled:e,className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-green-300 rounded-lg hover:border-green-400 transition-colors disabled:opacity-50",children:[s.jsx(Lt,{className:"w-5 h-5 text-green-500"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e?"Exporting...":"Export Events"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Download all events as CSV"})]})]})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Instructions:"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsx("li",{children:"• Download the template to see the correct format"}),s.jsx("li",{children:"• Required columns: Title, Venue, Date, Start Time, End Time, Status, Payment Status, Contact Name, Contact Phone, Contact Email"}),s.jsx("li",{children:"• Date format: YYYY-MM-DD (e.g., 2025-10-01)"}),s.jsx("li",{children:"• Time format: HH:MM (e.g., 18:00)"}),s.jsx("li",{children:"• Venue options: restaurant, bar, banquet"}),s.jsx("li",{children:"• Status options: pending, confirmed, cancelled, closed"}),s.jsx("li",{children:"• Payment Status: paid, unpaid"})]})]})]})};function Hf(e){const t=e.trim().split(`
`),a=t[0].split(",").map(n=>n.trim()),r=[];for(let n=1;n<t.length;n++){const o=t[n];if(!o.trim())continue;const l=o.split(",").map(d=>d.trim()),c={};a.forEach((d,i)=>{c[d]=l[i]||""}),r.push(c)}return r}function Jf(e){const[t,a,r]=e.split("/"),n=t.padStart(2,"0"),o=a.padStart(2,"0");return`${r}-${n}-${o}`}function gn(e){const[t,a]=e.split(":");return`${t.padStart(2,"0")}:${a}`}function Wf(e){return{Bar:"bar",bar:"bar",Restaurant:"restaurant",restaurant:"restaurant",Banquet:"banquet",banquet:"banquet"}[e]||"restaurant"}function Yf(e){return{confirmed:"confirmed",pending:"pending",cancelled:"cancelled",closed:"closed"}[e.toLowerCase()]||"pending"}function Kf(e){return{paid:"paid",unpaid:"unpaid"}[e.toLowerCase()]||"unpaid"}function Qf(e){return{title:e.Title.trim(),venue:Wf(e.Venue.trim()),date:Jf(e.Date.trim()),startTime:gn(e["Start Time"].trim()),endTime:gn(e["End Time"].trim()),status:Yf(e.Status.trim()),paymentStatus:Kf(e["Payment Status"].trim()),contact:{name:e["Contact Name"].trim(),phone:e["Contact Phone"].trim(),email:e["Contact Email"].trim()},notes:e.Notes.trim()||void 0}}function Xf(e){try{return Hf(e).filter(r=>r.Title&&r.Date).map(r=>Qf(r))}catch(t){throw console.error("Error importing events from CSV:",t),new Error("Failed to parse CSV file. Please check the file format.")}}const eg=({isOpen:e,onClose:t})=>{const{addMultipleEvents:a}=Ae(),[r,n]=T.useState(!1),[o,l]=T.useState("idle"),[c,d]=T.useState(""),[i,u]=T.useState([]),m=async x=>{var g;const f=(g=x.target.files)==null?void 0:g[0];if(f){if(!f.name.toLowerCase().endsWith(".csv")){l("error"),d("Please select a CSV file.");return}n(!0),l("idle");try{const y=await f.text(),b=Xf(y);if(b.length===0){l("error"),d("No valid events found in the CSV file."),n(!1);return}u(b),d(`Found ${b.length} events to import.`),n(!1)}catch(y){l("error"),d(y instanceof Error?y.message:"Failed to parse CSV file."),n(!1)}}},w=async()=>{if(i.length!==0){n(!0);try{await a(i),l("success"),d(`Successfully imported ${i.length} events!`),setTimeout(()=>{t(),u([]),l("idle"),d("")},2e3)}catch{l("error"),d("Failed to import events. Please try again.")}n(!1)}},j=()=>{u([]),l("idle"),d(""),t()};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wa,{className:"h-6 w-6 text-amber-600"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Import Events from CSV"})]}),s.jsx("button",{onClick:j,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:s.jsx(Ut,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV File"}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-amber-400 transition-colors",children:[s.jsx(Ft,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Choose a CSV file with event data"}),s.jsx("input",{type:"file",accept:".csv",onChange:m,className:"hidden",id:"csv-file-input",disabled:r}),s.jsx("label",{htmlFor:"csv-file-input",className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white transition-colors cursor-pointer ${r?"bg-gray-400 cursor-not-allowed":"bg-amber-600 hover:bg-amber-700"}`,children:r?"Processing...":"Choose File"})]})]}),c&&s.jsxs("div",{className:`p-4 rounded-md mb-4 flex items-center gap-3 ${o==="success"?"bg-green-50 text-green-700 border border-green-200":o==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:[o==="success"&&s.jsx(_n,{className:"h-5 w-5"}),o==="error"&&s.jsx(Nn,{className:"h-5 w-5"}),o==="idle"&&s.jsx(Ft,{className:"h-5 w-5"}),s.jsx("span",{children:c})]}),i.length>0&&o!=="success"&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Preview Events"}),s.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:s.jsxs("div",{className:"divide-y divide-gray-200",children:[i.slice(0,5).map((x,f)=>s.jsx("div",{className:"p-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:x.title}),s.jsxs("p",{className:"text-sm text-gray-600",children:[x.date," • ",x.startTime," - ",x.endTime," • ",x.venue]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[x.contact.name," - ",x.contact.phone]})]}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-md ${x.status==="confirmed"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:x.status})]})},f)),i.length>5&&s.jsxs("div",{className:"p-3 text-center text-sm text-gray-500",children:["... and ",i.length-5," more events"]})]})})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Expected CSV Format:"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Your CSV file should include these columns:"}),s.jsx("div",{className:"text-xs text-gray-500 font-mono bg-white p-2 rounded border",children:"Title, Venue, Date, Start Time, End Time, Status, Payment Status, Contact Name, Contact Phone, Contact Email, Notes"}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["• Date format: M/D/YYYY (e.g., 9/24/2025)",s.jsx("br",{}),"• Time format: H:MM (24-hour, e.g., 20:00)",s.jsx("br",{}),"• Venue: restaurant, bar, or banquet",s.jsx("br",{}),"• Status: confirmed, pending, cancelled, or closed"]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{onClick:j,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",disabled:r,children:"Cancel"}),i.length>0&&o!=="success"&&s.jsx("button",{onClick:w,disabled:r,className:`px-4 py-2 text-white rounded-md transition-colors ${r?"bg-gray-400 cursor-not-allowed":"bg-amber-600 hover:bg-amber-700"}`,children:r?"Importing...":`Import ${i.length} Events`})]})]})}):null},tg=()=>{var re;const{login:e,forceLogin:t,isLoading:a,error:r,clearError:n}=We(),{loadEventsFromDatabase:o}=Ae(),l=typeof window<"u"&&!!((re=window==null?void 0:window.ywConfig)!=null&&re.authBypass),[c,d]=T.useState("login"),[i,u]=T.useState(""),[m,w]=T.useState(""),[j,x]=T.useState(""),[f,g]=T.useState(""),[y,b]=T.useState(""),[E,N]=T.useState(null),[O,I]=T.useState(null),Y=async F=>{F.preventDefault(),N(null),I(null),n();try{c==="login"?(await e({username:i,password:m}),console.log("🔄 Login successful, loading events..."),o().catch(M=>{console.error("Failed to load events after login:",M)})):c==="signup"?await L():c==="reset"&&await B()}catch(M){N(M instanceof Error?M.message:"Operation failed")}},L=async()=>{if(!i||!m||!j)throw new Error("Username, password, and email are required");const F=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:m,email:j,first_name:f,last_name:y})});if(!F.ok){const M=await F.json().catch(()=>({error:"Signup failed"}));throw new Error(M.error||"Signup failed")}I("Account created successfully! You can now sign in."),d("login"),w("")},B=async()=>{if(!j)throw new Error("Email is required for password reset");const F=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j})});if(!F.ok){const M=await F.json().catch(()=>({error:"Password reset failed"}));throw new Error(M.error||"Password reset failed")}I("Password reset instructions sent to your email."),d("login")};return s.jsx("div",{className:"fixed inset-0 bg-slate-950 flex items-center justify-center p-6",children:s.jsxs("div",{className:"bg-white/95 shadow-2xl rounded-3xl w-full max-w-md p-8 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-100/30 via-white to-slate-100/60 pointer-events-none"}),s.jsxs("div",{className:"relative space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsxs("h1",{className:"text-2xl font-bold text-slate-900",children:[c==="login"&&"Event Manager Login",c==="signup"&&"Create Account",c==="reset"&&"Reset Password"]}),s.jsx("p",{className:"text-sm text-slate-600",children:c==="login"?"Use your organization credentials to access the dashboard.":c==="signup"?"Create a new account to access the event management system.":"Enter your email to receive password reset instructions."}),c==="login"&&s.jsx("p",{className:"text-xs text-slate-500 select-none cursor-pointer",onClick:F=>{F.detail===3&&l&&(N(null),n(),t({username:"admin"}),I("Bypass mode enabled. You are logged in as admin."),console.log("🔄 Bypass login activated, loading events..."),o().catch(M=>{console.error("Failed to load events after bypass:",M)}))},children:"© All Copyright is reserved for Stuntec by Mike Akanan 313.938.6666"})]}),s.jsxs("form",{onSubmit:Y,className:"space-y-5",children:[c==="reset"?s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-700",htmlFor:"reset-email",children:"Email"}),s.jsx("input",{id:"reset-email",type:"email",value:j,onChange:F=>x(F.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent bg-white text-slate-800",placeholder:"your@email.com",autoComplete:"email",required:!0})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-700",htmlFor:"username",children:"Username"}),s.jsx("input",{id:"username",type:"text",value:i,onChange:F=>u(F.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent bg-white text-slate-800",placeholder:"Enter your username",autoComplete:"username",required:!0})]}),c==="signup"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-700",htmlFor:"email",children:"Email"}),s.jsx("input",{id:"email",type:"email",value:j,onChange:F=>x(F.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent bg-white text-slate-800",placeholder:"your@email.com",autoComplete:"email",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-700",htmlFor:"firstName",children:"First Name"}),s.jsx("input",{id:"firstName",type:"text",value:f,onChange:F=>g(F.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent bg-white text-slate-800",placeholder:"First",autoComplete:"given-name"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-700",htmlFor:"lastName",children:"Last Name"}),s.jsx("input",{id:"lastName",type:"text",value:y,onChange:F=>b(F.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent bg-white text-slate-800",placeholder:"Last",autoComplete:"family-name"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-700",htmlFor:"password",children:"Password"}),s.jsx("input",{id:"password",type:"password",value:m,onChange:F=>w(F.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent bg-white text-slate-800",placeholder:"••••••••",autoComplete:c==="signup"?"new-password":"current-password",required:!0})]})]}),(E||r)&&s.jsx("div",{className:"px-3 py-2 rounded-lg bg-red-50 border border-red-200 text-sm text-red-700",children:E||r}),O&&s.jsx("div",{className:"px-3 py-2 rounded-lg bg-green-50 border border-green-200 text-sm text-green-700",children:O}),s.jsx("button",{type:"submit",disabled:a,className:"w-full px-4 py-3 rounded-xl bg-amber-500 hover:bg-amber-600 text-white font-semibold transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:a?c==="signup"?"Creating account…":c==="reset"?"Sending reset link…":"Signing in…":c==="signup"?"Create Account":c==="reset"?"Send Reset Link":"Sign in"})]}),s.jsxs("div",{className:"pt-4 border-t border-slate-200 space-y-3",children:[c==="login"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{d("signup"),N(null),I(null)},className:"w-full text-sm text-slate-600 hover:text-amber-600 font-medium transition-colors",children:"Don't have an account? Sign up"}),s.jsxs("button",{onClick:()=>{d("reset"),N(null),I(null)},className:"w-full text-sm text-slate-600 hover:text-amber-600 font-medium transition-colors flex items-center justify-center gap-2",children:[s.jsx(ea,{className:"h-4 w-4"}),"Forgot your password?"]}),l&&s.jsx("button",{onClick:()=>{N(null),n(),t({username:i||"admin"}),I("Bypass mode enabled. You are logged in as admin."),console.log("🔄 Manual bypass activated, loading events..."),o().catch(F=>{console.error("Failed to load events after manual bypass:",F)})},className:"w-full text-sm text-amber-600 hover:text-amber-700 font-semibold transition-colors",children:"Enter without server (bypass)"})]}),(c==="signup"||c==="reset")&&s.jsx("button",{onClick:()=>{d("login"),N(null),I(null)},className:"w-full text-sm text-slate-600 hover:text-amber-600 font-medium transition-colors",children:"Back to sign in"})]})]})]})})};let Ot=null;function sg(){Ot&&clearInterval(Ot),Ot=setInterval(()=>{const e=We.getState();e.token&&e.token!=="offline-bypass-token"&&e.checkTokenExpiration()},3e4)}function xn(){Ot&&(clearInterval(Ot),Ot=null)}function ag(){const{token:e}=We();T.useEffect(()=>(e&&e!=="offline-bypass-token"?sg():xn(),()=>{xn()}),[e])}function rg(){var q;const[e,t]=T.useState(new Date),[a,r]=T.useState(),[n,o]=T.useState("calendar"),[l,c]=T.useState(""),[d,i]=T.useState(!1),[u,m]=T.useState(!1),[w,j]=T.useState(),[x,f]=T.useState(),[g,y]=T.useState(!1),[b,E]=T.useState(!1),{user:N,token:O,refreshProfile:I,logout:Y}=We();ag();const L=N??{id:"GUEST",username:"guest",role:"guest",firstName:"Guest",lastName:"User",phone:"",email:"",createdAt:"",updatedAt:""};L.id;const{selectedEvent:B,isEventDialogOpen:re,setSelectedEvent:F,setEventDialogOpen:M,events:K,settings:v,getVenueById:P,loadEventsFromDatabase:J}=Ae();T.useEffect(()=>{O&&!N&&I().catch(()=>{})},[O,N,I]),T.useEffect(()=>{N&&N.id!=="GUEST"&&!N.id.startsWith("offline-")?(console.log("👤 User authenticated, loading events..."),J().catch($=>{console.error("Failed to load events from database:",$)})):N&&N.id.startsWith("offline-")&&console.log("👤 Offline user detected, skipping API call for events")},[N,J]);const ie=$=>{r($),F(null),M(!0)},ee=$=>{c($),o("daily")},le=()=>{o("calendar"),c("")},ae=$=>{c($)},h=$=>{const oe=K.find(G=>G.id===$);oe&&(F(oe),r(void 0),M(!0))},C=$=>{F($),r(void 0),M(!0)},z=($,oe)=>{j($||void 0),f(oe||void 0),o("history")},_=$=>{const oe=new Date($);t(oe),o("calendar"),c(""),j(void 0),f(void 0)},V=()=>{M(!1),F(null),r(void 0)};return N?s.jsxs("div",{className:"h-screen transition-colors duration-300 flex flex-col",style:{backgroundColor:v.backgroundColor},children:[s.jsxs("div",{className:"flex flex-1 min-h-0",children:[s.jsx(zc,{onNewEvent:()=>ie(),currentDate:e,onDateChange:t,onNavigateToHistory:z,currentUser:L,onLogout:Y}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 shadow-lg border-b border-slate-600",children:s.jsx("div",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[v.logo&&s.jsx("img",{src:v.logo,alt:"Logo",className:"w-12 h-12 object-contain rounded-lg bg-white/10 p-1"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",style:{color:v.textColor},children:v.selectedVenue?`${((q=P(v.selectedVenue))==null?void 0:q.name)||"Venue"} - ${v.storeName}`:v.storeName?`${v.storeName} ${v.applicationTitle}`:v.applicationTitle}),s.jsx("div",{className:"text-sm mt-1 opacity-80",style:{color:v.textColor},children:v.applicationSubtitle})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex bg-slate-700/50 rounded-lg p-1",children:[s.jsxs("button",{onClick:()=>{o("calendar"),c("")},className:`
                        px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2
                        ${n==="calendar"||n==="daily"?"text-slate-900 shadow-md":"text-slate-300 hover:text-slate-100 hover:bg-slate-600"}
                      `,style:{backgroundColor:n==="calendar"||n==="daily"?v.themeColor:void 0},children:[s.jsx(gt,{className:"h-4 w-4"}),"Calendar"]}),s.jsxs("button",{onClick:()=>o("history"),className:`
                        px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2
                        ${n==="history"?"text-slate-900 shadow-md":"text-slate-300 hover:text-slate-100 hover:bg-slate-600"}
                      `,style:{backgroundColor:n==="history"?v.themeColor:void 0},children:[s.jsx(Ha,{className:"h-4 w-4"}),"History"]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:()=>m(!0),className:"p-2 text-slate-300 hover:text-slate-100 hover:bg-slate-600 rounded-lg transition-colors",title:"Share Calendar",children:s.jsx(lc,{className:"h-5 w-5"})}),s.jsx("button",{onClick:()=>i(!0),className:"p-2 text-slate-300 hover:text-slate-100 hover:bg-slate-600 rounded-lg transition-colors",title:"Settings",children:s.jsx(oc,{className:"h-5 w-5"})}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:"text-slate-300 text-sm",children:e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})]})]})]})})}),s.jsx("div",{className:"flex-1 overflow-auto p-6",children:s.jsxs("div",{className:"h-full flex flex-col space-y-6",children:[n==="calendar"&&s.jsx(Gc,{}),n==="history"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[s.jsxs("button",{onClick:()=>E($=>!$),className:"w-full flex items-center justify-between px-6 py-4 text-left border-b border-slate-200 hover:bg-slate-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[b?s.jsx(kl,{className:"h-5 w-5 text-slate-500"}):s.jsx(wn,{className:"h-5 w-5 text-slate-500"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Data Management"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Importa o exporta tus eventos con seguridad"})]})]}),s.jsx("button",{onClick:$=>{$.stopPropagation(),y(!0)},className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors flex items-center gap-2",children:"Import CSV"})]}),b&&s.jsx("div",{className:"p-6 border-t border-slate-200",children:s.jsx(Gf,{})})]}),s.jsx("div",{className:"flex-1 overflow-auto",children:n==="calendar"?s.jsx(qc,{currentDate:e,onDateClick:ee,onEventClick:h}):n==="daily"?s.jsx(Zc,{selectedDate:l,onDateChange:ae,onBackToMonth:le,onNewEvent:ie,onEventClick:h}):s.jsx(Bf,{onEditEvent:C,onNavigateToDate:_,statusFilter:w,paymentFilter:x,currentUser:L})})]})})]})]}),s.jsx(Hc,{isOpen:re,onClose:V,event:B,defaultDate:a}),s.jsx(Zf,{isOpen:d,onClose:()=>i(!1)}),s.jsx(zf,{isOpen:u,onClose:()=>m(!1)}),s.jsx(eg,{isOpen:g,onClose:()=>y(!1)})]}):s.jsx(tg,{})}vn(document.getElementById("root")).render(s.jsx(T.StrictMode,{children:s.jsx(rg,{})}));
//# sourceMappingURL=index-DRJQw9W2.js.map
